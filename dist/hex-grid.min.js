;/*! showdown v 1.9.1 - 02-11-2019 */
(function(){
/**
 * Created by Tivie on 13-07-2015.
 */

function getDefaultOpts (simple) {
  'use strict';

  var defaultOptions = {
    omitExtraWLInCodeBlocks: {
      defaultValue: false,
      describe: 'Omit the default extra whiteline added to code blocks',
      type: 'boolean'
    },
    noHeaderId: {
      defaultValue: false,
      describe: 'Turn on/off generated header id',
      type: 'boolean'
    },
    prefixHeaderId: {
      defaultValue: false,
      describe: 'Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic \'section-\' prefix',
      type: 'string'
    },
    rawPrefixHeaderId: {
      defaultValue: false,
      describe: 'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',
      type: 'boolean'
    },
    ghCompatibleHeaderId: {
      defaultValue: false,
      describe: 'Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)',
      type: 'boolean'
    },
    rawHeaderId: {
      defaultValue: false,
      describe: 'Remove only spaces, \' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids',
      type: 'boolean'
    },
    headerLevelStart: {
      defaultValue: false,
      describe: 'The header blocks level start',
      type: 'integer'
    },
    parseImgDimensions: {
      defaultValue: false,
      describe: 'Turn on/off image dimension parsing',
      type: 'boolean'
    },
    simplifiedAutoLink: {
      defaultValue: false,
      describe: 'Turn on/off GFM autolink style',
      type: 'boolean'
    },
    excludeTrailingPunctuationFromURLs: {
      defaultValue: false,
      describe: 'Excludes trailing punctuation from links generated with autoLinking',
      type: 'boolean'
    },
    literalMidWordUnderscores: {
      defaultValue: false,
      describe: 'Parse midword underscores as literal underscores',
      type: 'boolean'
    },
    literalMidWordAsterisks: {
      defaultValue: false,
      describe: 'Parse midword asterisks as literal asterisks',
      type: 'boolean'
    },
    strikethrough: {
      defaultValue: false,
      describe: 'Turn on/off strikethrough support',
      type: 'boolean'
    },
    tables: {
      defaultValue: false,
      describe: 'Turn on/off tables support',
      type: 'boolean'
    },
    tablesHeaderId: {
      defaultValue: false,
      describe: 'Add an id to table headers',
      type: 'boolean'
    },
    ghCodeBlocks: {
      defaultValue: true,
      describe: 'Turn on/off GFM fenced code blocks support',
      type: 'boolean'
    },
    tasklists: {
      defaultValue: false,
      describe: 'Turn on/off GFM tasklist support',
      type: 'boolean'
    },
    smoothLivePreview: {
      defaultValue: false,
      describe: 'Prevents weird effects in live previews due to incomplete input',
      type: 'boolean'
    },
    smartIndentationFix: {
      defaultValue: false,
      description: 'Tries to smartly fix indentation in es6 strings',
      type: 'boolean'
    },
    disableForced4SpacesIndentedSublists: {
      defaultValue: false,
      description: 'Disables the requirement of indenting nested sublists by 4 spaces',
      type: 'boolean'
    },
    simpleLineBreaks: {
      defaultValue: false,
      description: 'Parses simple line breaks as <br> (GFM Style)',
      type: 'boolean'
    },
    requireSpaceBeforeHeadingText: {
      defaultValue: false,
      description: 'Makes adding a space between `#` and the header text mandatory (GFM Style)',
      type: 'boolean'
    },
    ghMentions: {
      defaultValue: false,
      description: 'Enables github @mentions',
      type: 'boolean'
    },
    ghMentionsLink: {
      defaultValue: 'https://github.com/{u}',
      description: 'Changes the link generated by @mentions. Only applies if ghMentions option is enabled.',
      type: 'string'
    },
    encodeEmails: {
      defaultValue: true,
      description: 'Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities',
      type: 'boolean'
    },
    openLinksInNewWindow: {
      defaultValue: false,
      description: 'Open all links in new windows',
      type: 'boolean'
    },
    backslashEscapesHTMLTags: {
      defaultValue: false,
      description: 'Support for HTML Tag escaping. ex: \<div>foo\</div>',
      type: 'boolean'
    },
    emoji: {
      defaultValue: false,
      description: 'Enable emoji support. Ex: `this is a :smile: emoji`',
      type: 'boolean'
    },
    underline: {
      defaultValue: false,
      description: 'Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`',
      type: 'boolean'
    },
    completeHTMLDocument: {
      defaultValue: false,
      description: 'Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags',
      type: 'boolean'
    },
    metadata: {
      defaultValue: false,
      description: 'Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).',
      type: 'boolean'
    },
    splitAdjacentBlockquotes: {
      defaultValue: false,
      description: 'Split adjacent blockquote blocks',
      type: 'boolean'
    }
  };
  if (simple === false) {
    return JSON.parse(JSON.stringify(defaultOptions));
  }
  var ret = {};
  for (var opt in defaultOptions) {
    if (defaultOptions.hasOwnProperty(opt)) {
      ret[opt] = defaultOptions[opt].defaultValue;
    }
  }
  return ret;
}

function allOptionsOn () {
  'use strict';
  var options = getDefaultOpts(true),
      ret = {};
  for (var opt in options) {
    if (options.hasOwnProperty(opt)) {
      ret[opt] = true;
    }
  }
  return ret;
}

/**
 * Created by Tivie on 06-01-2015.
 */

// Private properties
var showdown = {},
    parsers = {},
    extensions = {},
    globalOptions = getDefaultOpts(true),
    setFlavor = 'vanilla',
    flavor = {
      github: {
        omitExtraWLInCodeBlocks:              true,
        simplifiedAutoLink:                   true,
        excludeTrailingPunctuationFromURLs:   true,
        literalMidWordUnderscores:            true,
        strikethrough:                        true,
        tables:                               true,
        tablesHeaderId:                       true,
        ghCodeBlocks:                         true,
        tasklists:                            true,
        disableForced4SpacesIndentedSublists: true,
        simpleLineBreaks:                     true,
        requireSpaceBeforeHeadingText:        true,
        ghCompatibleHeaderId:                 true,
        ghMentions:                           true,
        backslashEscapesHTMLTags:             true,
        emoji:                                true,
        splitAdjacentBlockquotes:             true
      },
      original: {
        noHeaderId:                           true,
        ghCodeBlocks:                         false
      },
      ghost: {
        omitExtraWLInCodeBlocks:              true,
        parseImgDimensions:                   true,
        simplifiedAutoLink:                   true,
        excludeTrailingPunctuationFromURLs:   true,
        literalMidWordUnderscores:            true,
        strikethrough:                        true,
        tables:                               true,
        tablesHeaderId:                       true,
        ghCodeBlocks:                         true,
        tasklists:                            true,
        smoothLivePreview:                    true,
        simpleLineBreaks:                     true,
        requireSpaceBeforeHeadingText:        true,
        ghMentions:                           false,
        encodeEmails:                         true
      },
      vanilla: getDefaultOpts(true),
      allOn: allOptionsOn()
    };

/**
 * helper namespace
 * @type {{}}
 */
showdown.helper = {};

/**
 * TODO LEGACY SUPPORT CODE
 * @type {{}}
 */
showdown.extensions = {};

/**
 * Set a global option
 * @static
 * @param {string} key
 * @param {*} value
 * @returns {showdown}
 */
showdown.setOption = function (key, value) {
  'use strict';
  globalOptions[key] = value;
  return this;
};

/**
 * Get a global option
 * @static
 * @param {string} key
 * @returns {*}
 */
showdown.getOption = function (key) {
  'use strict';
  return globalOptions[key];
};

/**
 * Get the global options
 * @static
 * @returns {{}}
 */
showdown.getOptions = function () {
  'use strict';
  return globalOptions;
};

/**
 * Reset global options to the default values
 * @static
 */
showdown.resetOptions = function () {
  'use strict';
  globalOptions = getDefaultOpts(true);
};

/**
 * Set the flavor showdown should use as default
 * @param {string} name
 */
showdown.setFlavor = function (name) {
  'use strict';
  if (!flavor.hasOwnProperty(name)) {
    throw Error(name + ' flavor was not found');
  }
  showdown.resetOptions();
  var preset = flavor[name];
  setFlavor = name;
  for (var option in preset) {
    if (preset.hasOwnProperty(option)) {
      globalOptions[option] = preset[option];
    }
  }
};

/**
 * Get the currently set flavor
 * @returns {string}
 */
showdown.getFlavor = function () {
  'use strict';
  return setFlavor;
};

/**
 * Get the options of a specified flavor. Returns undefined if the flavor was not found
 * @param {string} name Name of the flavor
 * @returns {{}|undefined}
 */
showdown.getFlavorOptions = function (name) {
  'use strict';
  if (flavor.hasOwnProperty(name)) {
    return flavor[name];
  }
};

/**
 * Get the default options
 * @static
 * @param {boolean} [simple=true]
 * @returns {{}}
 */
showdown.getDefaultOptions = function (simple) {
  'use strict';
  return getDefaultOpts(simple);
};

/**
 * Get or set a subParser
 *
 * subParser(name)       - Get a registered subParser
 * subParser(name, func) - Register a subParser
 * @static
 * @param {string} name
 * @param {function} [func]
 * @returns {*}
 */
showdown.subParser = function (name, func) {
  'use strict';
  if (showdown.helper.isString(name)) {
    if (typeof func !== 'undefined') {
      parsers[name] = func;
    } else {
      if (parsers.hasOwnProperty(name)) {
        return parsers[name];
      } else {
        throw Error('SubParser named ' + name + ' not registered!');
      }
    }
  }
};

/**
 * Gets or registers an extension
 * @static
 * @param {string} name
 * @param {object|function=} ext
 * @returns {*}
 */
showdown.extension = function (name, ext) {
  'use strict';

  if (!showdown.helper.isString(name)) {
    throw Error('Extension \'name\' must be a string');
  }

  name = showdown.helper.stdExtName(name);

  // Getter
  if (showdown.helper.isUndefined(ext)) {
    if (!extensions.hasOwnProperty(name)) {
      throw Error('Extension named ' + name + ' is not registered!');
    }
    return extensions[name];

    // Setter
  } else {
    // Expand extension if it's wrapped in a function
    if (typeof ext === 'function') {
      ext = ext();
    }

    // Ensure extension is an array
    if (!showdown.helper.isArray(ext)) {
      ext = [ext];
    }

    var validExtension = validate(ext, name);

    if (validExtension.valid) {
      extensions[name] = ext;
    } else {
      throw Error(validExtension.error);
    }
  }
};

/**
 * Gets all extensions registered
 * @returns {{}}
 */
showdown.getAllExtensions = function () {
  'use strict';
  return extensions;
};

/**
 * Remove an extension
 * @param {string} name
 */
showdown.removeExtension = function (name) {
  'use strict';
  delete extensions[name];
};

/**
 * Removes all extensions
 */
showdown.resetExtensions = function () {
  'use strict';
  extensions = {};
};

/**
 * Validate extension
 * @param {array} extension
 * @param {string} name
 * @returns {{valid: boolean, error: string}}
 */
function validate (extension, name) {
  'use strict';

  var errMsg = (name) ? 'Error in ' + name + ' extension->' : 'Error in unnamed extension',
      ret = {
        valid: true,
        error: ''
      };

  if (!showdown.helper.isArray(extension)) {
    extension = [extension];
  }

  for (var i = 0; i < extension.length; ++i) {
    var baseMsg = errMsg + ' sub-extension ' + i + ': ',
        ext = extension[i];
    if (typeof ext !== 'object') {
      ret.valid = false;
      ret.error = baseMsg + 'must be an object, but ' + typeof ext + ' given';
      return ret;
    }

    if (!showdown.helper.isString(ext.type)) {
      ret.valid = false;
      ret.error = baseMsg + 'property "type" must be a string, but ' + typeof ext.type + ' given';
      return ret;
    }

    var type = ext.type = ext.type.toLowerCase();

    // normalize extension type
    if (type === 'language') {
      type = ext.type = 'lang';
    }

    if (type === 'html') {
      type = ext.type = 'output';
    }

    if (type !== 'lang' && type !== 'output' && type !== 'listener') {
      ret.valid = false;
      ret.error = baseMsg + 'type ' + type + ' is not recognized. Valid values: "lang/language", "output/html" or "listener"';
      return ret;
    }

    if (type === 'listener') {
      if (showdown.helper.isUndefined(ext.listeners)) {
        ret.valid = false;
        ret.error = baseMsg + '. Extensions of type "listener" must have a property called "listeners"';
        return ret;
      }
    } else {
      if (showdown.helper.isUndefined(ext.filter) && showdown.helper.isUndefined(ext.regex)) {
        ret.valid = false;
        ret.error = baseMsg + type + ' extensions must define either a "regex" property or a "filter" method';
        return ret;
      }
    }

    if (ext.listeners) {
      if (typeof ext.listeners !== 'object') {
        ret.valid = false;
        ret.error = baseMsg + '"listeners" property must be an object but ' + typeof ext.listeners + ' given';
        return ret;
      }
      for (var ln in ext.listeners) {
        if (ext.listeners.hasOwnProperty(ln)) {
          if (typeof ext.listeners[ln] !== 'function') {
            ret.valid = false;
            ret.error = baseMsg + '"listeners" property must be an hash of [event name]: [callback]. listeners.' + ln +
              ' must be a function but ' + typeof ext.listeners[ln] + ' given';
            return ret;
          }
        }
      }
    }

    if (ext.filter) {
      if (typeof ext.filter !== 'function') {
        ret.valid = false;
        ret.error = baseMsg + '"filter" must be a function, but ' + typeof ext.filter + ' given';
        return ret;
      }
    } else if (ext.regex) {
      if (showdown.helper.isString(ext.regex)) {
        ext.regex = new RegExp(ext.regex, 'g');
      }
      if (!(ext.regex instanceof RegExp)) {
        ret.valid = false;
        ret.error = baseMsg + '"regex" property must either be a string or a RegExp object, but ' + typeof ext.regex + ' given';
        return ret;
      }
      if (showdown.helper.isUndefined(ext.replace)) {
        ret.valid = false;
        ret.error = baseMsg + '"regex" extensions must implement a replace string or function';
        return ret;
      }
    }
  }
  return ret;
}

/**
 * Validate extension
 * @param {object} ext
 * @returns {boolean}
 */
showdown.validateExtension = function (ext) {
  'use strict';

  var validateExtension = validate(ext, null);
  if (!validateExtension.valid) {
    console.warn(validateExtension.error);
    return false;
  }
  return true;
};

/**
 * showdownjs helper functions
 */

if (!showdown.hasOwnProperty('helper')) {
  showdown.helper = {};
}

/**
 * Check if var is string
 * @static
 * @param {string} a
 * @returns {boolean}
 */
showdown.helper.isString = function (a) {
  'use strict';
  return (typeof a === 'string' || a instanceof String);
};

/**
 * Check if var is a function
 * @static
 * @param {*} a
 * @returns {boolean}
 */
showdown.helper.isFunction = function (a) {
  'use strict';
  var getType = {};
  return a && getType.toString.call(a) === '[object Function]';
};

/**
 * isArray helper function
 * @static
 * @param {*} a
 * @returns {boolean}
 */
showdown.helper.isArray = function (a) {
  'use strict';
  return Array.isArray(a);
};

/**
 * Check if value is undefined
 * @static
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.
 */
showdown.helper.isUndefined = function (value) {
  'use strict';
  return typeof value === 'undefined';
};

/**
 * ForEach helper function
 * Iterates over Arrays and Objects (own properties only)
 * @static
 * @param {*} obj
 * @param {function} callback Accepts 3 params: 1. value, 2. key, 3. the original array/object
 */
showdown.helper.forEach = function (obj, callback) {
  'use strict';
  // check if obj is defined
  if (showdown.helper.isUndefined(obj)) {
    throw new Error('obj param is required');
  }

  if (showdown.helper.isUndefined(callback)) {
    throw new Error('callback param is required');
  }

  if (!showdown.helper.isFunction(callback)) {
    throw new Error('callback param must be a function/closure');
  }

  if (typeof obj.forEach === 'function') {
    obj.forEach(callback);
  } else if (showdown.helper.isArray(obj)) {
    for (var i = 0; i < obj.length; i++) {
      callback(obj[i], i, obj);
    }
  } else if (typeof (obj) === 'object') {
    for (var prop in obj) {
      if (obj.hasOwnProperty(prop)) {
        callback(obj[prop], prop, obj);
      }
    }
  } else {
    throw new Error('obj does not seem to be an array or an iterable object');
  }
};

/**
 * Standardidize extension name
 * @static
 * @param {string} s extension name
 * @returns {string}
 */
showdown.helper.stdExtName = function (s) {
  'use strict';
  return s.replace(/[_?*+\/\\.^-]/g, '').replace(/\s/g, '').toLowerCase();
};

function escapeCharactersCallback (wholeMatch, m1) {
  'use strict';
  var charCodeToEscape = m1.charCodeAt(0);
  return '¨E' + charCodeToEscape + 'E';
}

/**
 * Callback used to escape characters when passing through String.replace
 * @static
 * @param {string} wholeMatch
 * @param {string} m1
 * @returns {string}
 */
showdown.helper.escapeCharactersCallback = escapeCharactersCallback;

/**
 * Escape characters in a string
 * @static
 * @param {string} text
 * @param {string} charsToEscape
 * @param {boolean} afterBackslash
 * @returns {XML|string|void|*}
 */
showdown.helper.escapeCharacters = function (text, charsToEscape, afterBackslash) {
  'use strict';
  // First we have to escape the escape characters so that
  // we can build a character class out of them
  var regexString = '([' + charsToEscape.replace(/([\[\]\\])/g, '\\$1') + '])';

  if (afterBackslash) {
    regexString = '\\\\' + regexString;
  }

  var regex = new RegExp(regexString, 'g');
  text = text.replace(regex, escapeCharactersCallback);

  return text;
};

/**
 * Unescape HTML entities
 * @param txt
 * @returns {string}
 */
showdown.helper.unescapeHTMLEntities = function (txt) {
  'use strict';

  return txt
    .replace(/&quot;/g, '"')
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&amp;/g, '&');
};

var rgxFindMatchPos = function (str, left, right, flags) {
  'use strict';
  var f = flags || '',
      g = f.indexOf('g') > -1,
      x = new RegExp(left + '|' + right, 'g' + f.replace(/g/g, '')),
      l = new RegExp(left, f.replace(/g/g, '')),
      pos = [],
      t, s, m, start, end;

  do {
    t = 0;
    while ((m = x.exec(str))) {
      if (l.test(m[0])) {
        if (!(t++)) {
          s = x.lastIndex;
          start = s - m[0].length;
        }
      } else if (t) {
        if (!--t) {
          end = m.index + m[0].length;
          var obj = {
            left: {start: start, end: s},
            match: {start: s, end: m.index},
            right: {start: m.index, end: end},
            wholeMatch: {start: start, end: end}
          };
          pos.push(obj);
          if (!g) {
            return pos;
          }
        }
      }
    }
  } while (t && (x.lastIndex = s));

  return pos;
};

/**
 * matchRecursiveRegExp
 *
 * (c) 2007 Steven Levithan <stevenlevithan.com>
 * MIT License
 *
 * Accepts a string to search, a left and right format delimiter
 * as regex patterns, and optional regex flags. Returns an array
 * of matches, allowing nested instances of left/right delimiters.
 * Use the "g" flag to return all matches, otherwise only the
 * first is returned. Be careful to ensure that the left and
 * right format delimiters produce mutually exclusive matches.
 * Backreferences are not supported within the right delimiter
 * due to how it is internally combined with the left delimiter.
 * When matching strings whose format delimiters are unbalanced
 * to the left or right, the output is intentionally as a
 * conventional regex library with recursion support would
 * produce, e.g. "<<x>" and "<x>>" both produce ["x"] when using
 * "<" and ">" as the delimiters (both strings contain a single,
 * balanced instance of "<x>").
 *
 * examples:
 * matchRecursiveRegExp("test", "\\(", "\\)")
 * returns: []
 * matchRecursiveRegExp("<t<<e>><s>>t<>", "<", ">", "g")
 * returns: ["t<<e>><s>", ""]
 * matchRecursiveRegExp("<div id=\"x\">test</div>", "<div\\b[^>]*>", "</div>", "gi")
 * returns: ["test"]
 */
showdown.helper.matchRecursiveRegExp = function (str, left, right, flags) {
  'use strict';

  var matchPos = rgxFindMatchPos (str, left, right, flags),
      results = [];

  for (var i = 0; i < matchPos.length; ++i) {
    results.push([
      str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),
      str.slice(matchPos[i].match.start, matchPos[i].match.end),
      str.slice(matchPos[i].left.start, matchPos[i].left.end),
      str.slice(matchPos[i].right.start, matchPos[i].right.end)
    ]);
  }
  return results;
};

/**
 *
 * @param {string} str
 * @param {string|function} replacement
 * @param {string} left
 * @param {string} right
 * @param {string} flags
 * @returns {string}
 */
showdown.helper.replaceRecursiveRegExp = function (str, replacement, left, right, flags) {
  'use strict';

  if (!showdown.helper.isFunction(replacement)) {
    var repStr = replacement;
    replacement = function () {
      return repStr;
    };
  }

  var matchPos = rgxFindMatchPos(str, left, right, flags),
      finalStr = str,
      lng = matchPos.length;

  if (lng > 0) {
    var bits = [];
    if (matchPos[0].wholeMatch.start !== 0) {
      bits.push(str.slice(0, matchPos[0].wholeMatch.start));
    }
    for (var i = 0; i < lng; ++i) {
      bits.push(
        replacement(
          str.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),
          str.slice(matchPos[i].match.start, matchPos[i].match.end),
          str.slice(matchPos[i].left.start, matchPos[i].left.end),
          str.slice(matchPos[i].right.start, matchPos[i].right.end)
        )
      );
      if (i < lng - 1) {
        bits.push(str.slice(matchPos[i].wholeMatch.end, matchPos[i + 1].wholeMatch.start));
      }
    }
    if (matchPos[lng - 1].wholeMatch.end < str.length) {
      bits.push(str.slice(matchPos[lng - 1].wholeMatch.end));
    }
    finalStr = bits.join('');
  }
  return finalStr;
};

/**
 * Returns the index within the passed String object of the first occurrence of the specified regex,
 * starting the search at fromIndex. Returns -1 if the value is not found.
 *
 * @param {string} str string to search
 * @param {RegExp} regex Regular expression to search
 * @param {int} [fromIndex = 0] Index to start the search
 * @returns {Number}
 * @throws InvalidArgumentError
 */
showdown.helper.regexIndexOf = function (str, regex, fromIndex) {
  'use strict';
  if (!showdown.helper.isString(str)) {
    throw 'InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string';
  }
  if (regex instanceof RegExp === false) {
    throw 'InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp';
  }
  var indexOf = str.substring(fromIndex || 0).search(regex);
  return (indexOf >= 0) ? (indexOf + (fromIndex || 0)) : indexOf;
};

/**
 * Splits the passed string object at the defined index, and returns an array composed of the two substrings
 * @param {string} str string to split
 * @param {int} index index to split string at
 * @returns {[string,string]}
 * @throws InvalidArgumentError
 */
showdown.helper.splitAtIndex = function (str, index) {
  'use strict';
  if (!showdown.helper.isString(str)) {
    throw 'InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string';
  }
  return [str.substring(0, index), str.substring(index)];
};

/**
 * Obfuscate an e-mail address through the use of Character Entities,
 * transforming ASCII characters into their equivalent decimal or hex entities.
 *
 * Since it has a random component, subsequent calls to this function produce different results
 *
 * @param {string} mail
 * @returns {string}
 */
showdown.helper.encodeEmailAddress = function (mail) {
  'use strict';
  var encode = [
    function (ch) {
      return '&#' + ch.charCodeAt(0) + ';';
    },
    function (ch) {
      return '&#x' + ch.charCodeAt(0).toString(16) + ';';
    },
    function (ch) {
      return ch;
    }
  ];

  mail = mail.replace(/./g, function (ch) {
    if (ch === '@') {
      // this *must* be encoded. I insist.
      ch = encode[Math.floor(Math.random() * 2)](ch);
    } else {
      var r = Math.random();
      // roughly 10% raw, 45% hex, 45% dec
      ch = (
        r > 0.9 ? encode[2](ch) : r > 0.45 ? encode[1](ch) : encode[0](ch)
      );
    }
    return ch;
  });

  return mail;
};

/**
 *
 * @param str
 * @param targetLength
 * @param padString
 * @returns {string}
 */
showdown.helper.padEnd = function padEnd (str, targetLength, padString) {
  'use strict';
  /*jshint bitwise: false*/
  // eslint-disable-next-line space-infix-ops
  targetLength = targetLength>>0; //floor if number or convert non-number to 0;
  /*jshint bitwise: true*/
  padString = String(padString || ' ');
  if (str.length > targetLength) {
    return String(str);
  } else {
    targetLength = targetLength - str.length;
    if (targetLength > padString.length) {
      padString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed
    }
    return String(str) + padString.slice(0,targetLength);
  }
};

/**
 * POLYFILLS
 */
// use this instead of builtin is undefined for IE8 compatibility
if (typeof console === 'undefined') {
  console = {
    warn: function (msg) {
      'use strict';
      alert(msg);
    },
    log: function (msg) {
      'use strict';
      alert(msg);
    },
    error: function (msg) {
      'use strict';
      throw msg;
    }
  };
}

/**
 * Common regexes.
 * We declare some common regexes to improve performance
 */
showdown.helper.regexes = {
  asteriskDashAndColon: /([*_:~])/g
};

/**
 * EMOJIS LIST
 */
showdown.helper.emojis = {
  '+1':'\ud83d\udc4d',
  '-1':'\ud83d\udc4e',
  '100':'\ud83d\udcaf',
  '1234':'\ud83d\udd22',
  '1st_place_medal':'\ud83e\udd47',
  '2nd_place_medal':'\ud83e\udd48',
  '3rd_place_medal':'\ud83e\udd49',
  '8ball':'\ud83c\udfb1',
  'a':'\ud83c\udd70\ufe0f',
  'ab':'\ud83c\udd8e',
  'abc':'\ud83d\udd24',
  'abcd':'\ud83d\udd21',
  'accept':'\ud83c\ude51',
  'aerial_tramway':'\ud83d\udea1',
  'airplane':'\u2708\ufe0f',
  'alarm_clock':'\u23f0',
  'alembic':'\u2697\ufe0f',
  'alien':'\ud83d\udc7d',
  'ambulance':'\ud83d\ude91',
  'amphora':'\ud83c\udffa',
  'anchor':'\u2693\ufe0f',
  'angel':'\ud83d\udc7c',
  'anger':'\ud83d\udca2',
  'angry':'\ud83d\ude20',
  'anguished':'\ud83d\ude27',
  'ant':'\ud83d\udc1c',
  'apple':'\ud83c\udf4e',
  'aquarius':'\u2652\ufe0f',
  'aries':'\u2648\ufe0f',
  'arrow_backward':'\u25c0\ufe0f',
  'arrow_double_down':'\u23ec',
  'arrow_double_up':'\u23eb',
  'arrow_down':'\u2b07\ufe0f',
  'arrow_down_small':'\ud83d\udd3d',
  'arrow_forward':'\u25b6\ufe0f',
  'arrow_heading_down':'\u2935\ufe0f',
  'arrow_heading_up':'\u2934\ufe0f',
  'arrow_left':'\u2b05\ufe0f',
  'arrow_lower_left':'\u2199\ufe0f',
  'arrow_lower_right':'\u2198\ufe0f',
  'arrow_right':'\u27a1\ufe0f',
  'arrow_right_hook':'\u21aa\ufe0f',
  'arrow_up':'\u2b06\ufe0f',
  'arrow_up_down':'\u2195\ufe0f',
  'arrow_up_small':'\ud83d\udd3c',
  'arrow_upper_left':'\u2196\ufe0f',
  'arrow_upper_right':'\u2197\ufe0f',
  'arrows_clockwise':'\ud83d\udd03',
  'arrows_counterclockwise':'\ud83d\udd04',
  'art':'\ud83c\udfa8',
  'articulated_lorry':'\ud83d\ude9b',
  'artificial_satellite':'\ud83d\udef0',
  'astonished':'\ud83d\ude32',
  'athletic_shoe':'\ud83d\udc5f',
  'atm':'\ud83c\udfe7',
  'atom_symbol':'\u269b\ufe0f',
  'avocado':'\ud83e\udd51',
  'b':'\ud83c\udd71\ufe0f',
  'baby':'\ud83d\udc76',
  'baby_bottle':'\ud83c\udf7c',
  'baby_chick':'\ud83d\udc24',
  'baby_symbol':'\ud83d\udebc',
  'back':'\ud83d\udd19',
  'bacon':'\ud83e\udd53',
  'badminton':'\ud83c\udff8',
  'baggage_claim':'\ud83d\udec4',
  'baguette_bread':'\ud83e\udd56',
  'balance_scale':'\u2696\ufe0f',
  'balloon':'\ud83c\udf88',
  'ballot_box':'\ud83d\uddf3',
  'ballot_box_with_check':'\u2611\ufe0f',
  'bamboo':'\ud83c\udf8d',
  'banana':'\ud83c\udf4c',
  'bangbang':'\u203c\ufe0f',
  'bank':'\ud83c\udfe6',
  'bar_chart':'\ud83d\udcca',
  'barber':'\ud83d\udc88',
  'baseball':'\u26be\ufe0f',
  'basketball':'\ud83c\udfc0',
  'basketball_man':'\u26f9\ufe0f',
  'basketball_woman':'\u26f9\ufe0f&zwj;\u2640\ufe0f',
  'bat':'\ud83e\udd87',
  'bath':'\ud83d\udec0',
  'bathtub':'\ud83d\udec1',
  'battery':'\ud83d\udd0b',
  'beach_umbrella':'\ud83c\udfd6',
  'bear':'\ud83d\udc3b',
  'bed':'\ud83d\udecf',
  'bee':'\ud83d\udc1d',
  'beer':'\ud83c\udf7a',
  'beers':'\ud83c\udf7b',
  'beetle':'\ud83d\udc1e',
  'beginner':'\ud83d\udd30',
  'bell':'\ud83d\udd14',
  'bellhop_bell':'\ud83d\udece',
  'bento':'\ud83c\udf71',
  'biking_man':'\ud83d\udeb4',
  'bike':'\ud83d\udeb2',
  'biking_woman':'\ud83d\udeb4&zwj;\u2640\ufe0f',
  'bikini':'\ud83d\udc59',
  'biohazard':'\u2623\ufe0f',
  'bird':'\ud83d\udc26',
  'birthday':'\ud83c\udf82',
  'black_circle':'\u26ab\ufe0f',
  'black_flag':'\ud83c\udff4',
  'black_heart':'\ud83d\udda4',
  'black_joker':'\ud83c\udccf',
  'black_large_square':'\u2b1b\ufe0f',
  'black_medium_small_square':'\u25fe\ufe0f',
  'black_medium_square':'\u25fc\ufe0f',
  'black_nib':'\u2712\ufe0f',
  'black_small_square':'\u25aa\ufe0f',
  'black_square_button':'\ud83d\udd32',
  'blonde_man':'\ud83d\udc71',
  'blonde_woman':'\ud83d\udc71&zwj;\u2640\ufe0f',
  'blossom':'\ud83c\udf3c',
  'blowfish':'\ud83d\udc21',
  'blue_book':'\ud83d\udcd8',
  'blue_car':'\ud83d\ude99',
  'blue_heart':'\ud83d\udc99',
  'blush':'\ud83d\ude0a',
  'boar':'\ud83d\udc17',
  'boat':'\u26f5\ufe0f',
  'bomb':'\ud83d\udca3',
  'book':'\ud83d\udcd6',
  'bookmark':'\ud83d\udd16',
  'bookmark_tabs':'\ud83d\udcd1',
  'books':'\ud83d\udcda',
  'boom':'\ud83d\udca5',
  'boot':'\ud83d\udc62',
  'bouquet':'\ud83d\udc90',
  'bowing_man':'\ud83d\ude47',
  'bow_and_arrow':'\ud83c\udff9',
  'bowing_woman':'\ud83d\ude47&zwj;\u2640\ufe0f',
  'bowling':'\ud83c\udfb3',
  'boxing_glove':'\ud83e\udd4a',
  'boy':'\ud83d\udc66',
  'bread':'\ud83c\udf5e',
  'bride_with_veil':'\ud83d\udc70',
  'bridge_at_night':'\ud83c\udf09',
  'briefcase':'\ud83d\udcbc',
  'broken_heart':'\ud83d\udc94',
  'bug':'\ud83d\udc1b',
  'building_construction':'\ud83c\udfd7',
  'bulb':'\ud83d\udca1',
  'bullettrain_front':'\ud83d\ude85',
  'bullettrain_side':'\ud83d\ude84',
  'burrito':'\ud83c\udf2f',
  'bus':'\ud83d\ude8c',
  'business_suit_levitating':'\ud83d\udd74',
  'busstop':'\ud83d\ude8f',
  'bust_in_silhouette':'\ud83d\udc64',
  'busts_in_silhouette':'\ud83d\udc65',
  'butterfly':'\ud83e\udd8b',
  'cactus':'\ud83c\udf35',
  'cake':'\ud83c\udf70',
  'calendar':'\ud83d\udcc6',
  'call_me_hand':'\ud83e\udd19',
  'calling':'\ud83d\udcf2',
  'camel':'\ud83d\udc2b',
  'camera':'\ud83d\udcf7',
  'camera_flash':'\ud83d\udcf8',
  'camping':'\ud83c\udfd5',
  'cancer':'\u264b\ufe0f',
  'candle':'\ud83d\udd6f',
  'candy':'\ud83c\udf6c',
  'canoe':'\ud83d\udef6',
  'capital_abcd':'\ud83d\udd20',
  'capricorn':'\u2651\ufe0f',
  'car':'\ud83d\ude97',
  'card_file_box':'\ud83d\uddc3',
  'card_index':'\ud83d\udcc7',
  'card_index_dividers':'\ud83d\uddc2',
  'carousel_horse':'\ud83c\udfa0',
  'carrot':'\ud83e\udd55',
  'cat':'\ud83d\udc31',
  'cat2':'\ud83d\udc08',
  'cd':'\ud83d\udcbf',
  'chains':'\u26d3',
  'champagne':'\ud83c\udf7e',
  'chart':'\ud83d\udcb9',
  'chart_with_downwards_trend':'\ud83d\udcc9',
  'chart_with_upwards_trend':'\ud83d\udcc8',
  'checkered_flag':'\ud83c\udfc1',
  'cheese':'\ud83e\uddc0',
  'cherries':'\ud83c\udf52',
  'cherry_blossom':'\ud83c\udf38',
  'chestnut':'\ud83c\udf30',
  'chicken':'\ud83d\udc14',
  'children_crossing':'\ud83d\udeb8',
  'chipmunk':'\ud83d\udc3f',
  'chocolate_bar':'\ud83c\udf6b',
  'christmas_tree':'\ud83c\udf84',
  'church':'\u26ea\ufe0f',
  'cinema':'\ud83c\udfa6',
  'circus_tent':'\ud83c\udfaa',
  'city_sunrise':'\ud83c\udf07',
  'city_sunset':'\ud83c\udf06',
  'cityscape':'\ud83c\udfd9',
  'cl':'\ud83c\udd91',
  'clamp':'\ud83d\udddc',
  'clap':'\ud83d\udc4f',
  'clapper':'\ud83c\udfac',
  'classical_building':'\ud83c\udfdb',
  'clinking_glasses':'\ud83e\udd42',
  'clipboard':'\ud83d\udccb',
  'clock1':'\ud83d\udd50',
  'clock10':'\ud83d\udd59',
  'clock1030':'\ud83d\udd65',
  'clock11':'\ud83d\udd5a',
  'clock1130':'\ud83d\udd66',
  'clock12':'\ud83d\udd5b',
  'clock1230':'\ud83d\udd67',
  'clock130':'\ud83d\udd5c',
  'clock2':'\ud83d\udd51',
  'clock230':'\ud83d\udd5d',
  'clock3':'\ud83d\udd52',
  'clock330':'\ud83d\udd5e',
  'clock4':'\ud83d\udd53',
  'clock430':'\ud83d\udd5f',
  'clock5':'\ud83d\udd54',
  'clock530':'\ud83d\udd60',
  'clock6':'\ud83d\udd55',
  'clock630':'\ud83d\udd61',
  'clock7':'\ud83d\udd56',
  'clock730':'\ud83d\udd62',
  'clock8':'\ud83d\udd57',
  'clock830':'\ud83d\udd63',
  'clock9':'\ud83d\udd58',
  'clock930':'\ud83d\udd64',
  'closed_book':'\ud83d\udcd5',
  'closed_lock_with_key':'\ud83d\udd10',
  'closed_umbrella':'\ud83c\udf02',
  'cloud':'\u2601\ufe0f',
  'cloud_with_lightning':'\ud83c\udf29',
  'cloud_with_lightning_and_rain':'\u26c8',
  'cloud_with_rain':'\ud83c\udf27',
  'cloud_with_snow':'\ud83c\udf28',
  'clown_face':'\ud83e\udd21',
  'clubs':'\u2663\ufe0f',
  'cocktail':'\ud83c\udf78',
  'coffee':'\u2615\ufe0f',
  'coffin':'\u26b0\ufe0f',
  'cold_sweat':'\ud83d\ude30',
  'comet':'\u2604\ufe0f',
  'computer':'\ud83d\udcbb',
  'computer_mouse':'\ud83d\uddb1',
  'confetti_ball':'\ud83c\udf8a',
  'confounded':'\ud83d\ude16',
  'confused':'\ud83d\ude15',
  'congratulations':'\u3297\ufe0f',
  'construction':'\ud83d\udea7',
  'construction_worker_man':'\ud83d\udc77',
  'construction_worker_woman':'\ud83d\udc77&zwj;\u2640\ufe0f',
  'control_knobs':'\ud83c\udf9b',
  'convenience_store':'\ud83c\udfea',
  'cookie':'\ud83c\udf6a',
  'cool':'\ud83c\udd92',
  'policeman':'\ud83d\udc6e',
  'copyright':'\u00a9\ufe0f',
  'corn':'\ud83c\udf3d',
  'couch_and_lamp':'\ud83d\udecb',
  'couple':'\ud83d\udc6b',
  'couple_with_heart_woman_man':'\ud83d\udc91',
  'couple_with_heart_man_man':'\ud83d\udc68&zwj;\u2764\ufe0f&zwj;\ud83d\udc68',
  'couple_with_heart_woman_woman':'\ud83d\udc69&zwj;\u2764\ufe0f&zwj;\ud83d\udc69',
  'couplekiss_man_man':'\ud83d\udc68&zwj;\u2764\ufe0f&zwj;\ud83d\udc8b&zwj;\ud83d\udc68',
  'couplekiss_man_woman':'\ud83d\udc8f',
  'couplekiss_woman_woman':'\ud83d\udc69&zwj;\u2764\ufe0f&zwj;\ud83d\udc8b&zwj;\ud83d\udc69',
  'cow':'\ud83d\udc2e',
  'cow2':'\ud83d\udc04',
  'cowboy_hat_face':'\ud83e\udd20',
  'crab':'\ud83e\udd80',
  'crayon':'\ud83d\udd8d',
  'credit_card':'\ud83d\udcb3',
  'crescent_moon':'\ud83c\udf19',
  'cricket':'\ud83c\udfcf',
  'crocodile':'\ud83d\udc0a',
  'croissant':'\ud83e\udd50',
  'crossed_fingers':'\ud83e\udd1e',
  'crossed_flags':'\ud83c\udf8c',
  'crossed_swords':'\u2694\ufe0f',
  'crown':'\ud83d\udc51',
  'cry':'\ud83d\ude22',
  'crying_cat_face':'\ud83d\ude3f',
  'crystal_ball':'\ud83d\udd2e',
  'cucumber':'\ud83e\udd52',
  'cupid':'\ud83d\udc98',
  'curly_loop':'\u27b0',
  'currency_exchange':'\ud83d\udcb1',
  'curry':'\ud83c\udf5b',
  'custard':'\ud83c\udf6e',
  'customs':'\ud83d\udec3',
  'cyclone':'\ud83c\udf00',
  'dagger':'\ud83d\udde1',
  'dancer':'\ud83d\udc83',
  'dancing_women':'\ud83d\udc6f',
  'dancing_men':'\ud83d\udc6f&zwj;\u2642\ufe0f',
  'dango':'\ud83c\udf61',
  'dark_sunglasses':'\ud83d\udd76',
  'dart':'\ud83c\udfaf',
  'dash':'\ud83d\udca8',
  'date':'\ud83d\udcc5',
  'deciduous_tree':'\ud83c\udf33',
  'deer':'\ud83e\udd8c',
  'department_store':'\ud83c\udfec',
  'derelict_house':'\ud83c\udfda',
  'desert':'\ud83c\udfdc',
  'desert_island':'\ud83c\udfdd',
  'desktop_computer':'\ud83d\udda5',
  'male_detective':'\ud83d\udd75\ufe0f',
  'diamond_shape_with_a_dot_inside':'\ud83d\udca0',
  'diamonds':'\u2666\ufe0f',
  'disappointed':'\ud83d\ude1e',
  'disappointed_relieved':'\ud83d\ude25',
  'dizzy':'\ud83d\udcab',
  'dizzy_face':'\ud83d\ude35',
  'do_not_litter':'\ud83d\udeaf',
  'dog':'\ud83d\udc36',
  'dog2':'\ud83d\udc15',
  'dollar':'\ud83d\udcb5',
  'dolls':'\ud83c\udf8e',
  'dolphin':'\ud83d\udc2c',
  'door':'\ud83d\udeaa',
  'doughnut':'\ud83c\udf69',
  'dove':'\ud83d\udd4a',
  'dragon':'\ud83d\udc09',
  'dragon_face':'\ud83d\udc32',
  'dress':'\ud83d\udc57',
  'dromedary_camel':'\ud83d\udc2a',
  'drooling_face':'\ud83e\udd24',
  'droplet':'\ud83d\udca7',
  'drum':'\ud83e\udd41',
  'duck':'\ud83e\udd86',
  'dvd':'\ud83d\udcc0',
  'e-mail':'\ud83d\udce7',
  'eagle':'\ud83e\udd85',
  'ear':'\ud83d\udc42',
  'ear_of_rice':'\ud83c\udf3e',
  'earth_africa':'\ud83c\udf0d',
  'earth_americas':'\ud83c\udf0e',
  'earth_asia':'\ud83c\udf0f',
  'egg':'\ud83e\udd5a',
  'eggplant':'\ud83c\udf46',
  'eight_pointed_black_star':'\u2734\ufe0f',
  'eight_spoked_asterisk':'\u2733\ufe0f',
  'electric_plug':'\ud83d\udd0c',
  'elephant':'\ud83d\udc18',
  'email':'\u2709\ufe0f',
  'end':'\ud83d\udd1a',
  'envelope_with_arrow':'\ud83d\udce9',
  'euro':'\ud83d\udcb6',
  'european_castle':'\ud83c\udff0',
  'european_post_office':'\ud83c\udfe4',
  'evergreen_tree':'\ud83c\udf32',
  'exclamation':'\u2757\ufe0f',
  'expressionless':'\ud83d\ude11',
  'eye':'\ud83d\udc41',
  'eye_speech_bubble':'\ud83d\udc41&zwj;\ud83d\udde8',
  'eyeglasses':'\ud83d\udc53',
  'eyes':'\ud83d\udc40',
  'face_with_head_bandage':'\ud83e\udd15',
  'face_with_thermometer':'\ud83e\udd12',
  'fist_oncoming':'\ud83d\udc4a',
  'factory':'\ud83c\udfed',
  'fallen_leaf':'\ud83c\udf42',
  'family_man_woman_boy':'\ud83d\udc6a',
  'family_man_boy':'\ud83d\udc68&zwj;\ud83d\udc66',
  'family_man_boy_boy':'\ud83d\udc68&zwj;\ud83d\udc66&zwj;\ud83d\udc66',
  'family_man_girl':'\ud83d\udc68&zwj;\ud83d\udc67',
  'family_man_girl_boy':'\ud83d\udc68&zwj;\ud83d\udc67&zwj;\ud83d\udc66',
  'family_man_girl_girl':'\ud83d\udc68&zwj;\ud83d\udc67&zwj;\ud83d\udc67',
  'family_man_man_boy':'\ud83d\udc68&zwj;\ud83d\udc68&zwj;\ud83d\udc66',
  'family_man_man_boy_boy':'\ud83d\udc68&zwj;\ud83d\udc68&zwj;\ud83d\udc66&zwj;\ud83d\udc66',
  'family_man_man_girl':'\ud83d\udc68&zwj;\ud83d\udc68&zwj;\ud83d\udc67',
  'family_man_man_girl_boy':'\ud83d\udc68&zwj;\ud83d\udc68&zwj;\ud83d\udc67&zwj;\ud83d\udc66',
  'family_man_man_girl_girl':'\ud83d\udc68&zwj;\ud83d\udc68&zwj;\ud83d\udc67&zwj;\ud83d\udc67',
  'family_man_woman_boy_boy':'\ud83d\udc68&zwj;\ud83d\udc69&zwj;\ud83d\udc66&zwj;\ud83d\udc66',
  'family_man_woman_girl':'\ud83d\udc68&zwj;\ud83d\udc69&zwj;\ud83d\udc67',
  'family_man_woman_girl_boy':'\ud83d\udc68&zwj;\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc66',
  'family_man_woman_girl_girl':'\ud83d\udc68&zwj;\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc67',
  'family_woman_boy':'\ud83d\udc69&zwj;\ud83d\udc66',
  'family_woman_boy_boy':'\ud83d\udc69&zwj;\ud83d\udc66&zwj;\ud83d\udc66',
  'family_woman_girl':'\ud83d\udc69&zwj;\ud83d\udc67',
  'family_woman_girl_boy':'\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc66',
  'family_woman_girl_girl':'\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc67',
  'family_woman_woman_boy':'\ud83d\udc69&zwj;\ud83d\udc69&zwj;\ud83d\udc66',
  'family_woman_woman_boy_boy':'\ud83d\udc69&zwj;\ud83d\udc69&zwj;\ud83d\udc66&zwj;\ud83d\udc66',
  'family_woman_woman_girl':'\ud83d\udc69&zwj;\ud83d\udc69&zwj;\ud83d\udc67',
  'family_woman_woman_girl_boy':'\ud83d\udc69&zwj;\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc66',
  'family_woman_woman_girl_girl':'\ud83d\udc69&zwj;\ud83d\udc69&zwj;\ud83d\udc67&zwj;\ud83d\udc67',
  'fast_forward':'\u23e9',
  'fax':'\ud83d\udce0',
  'fearful':'\ud83d\ude28',
  'feet':'\ud83d\udc3e',
  'female_detective':'\ud83d\udd75\ufe0f&zwj;\u2640\ufe0f',
  'ferris_wheel':'\ud83c\udfa1',
  'ferry':'\u26f4',
  'field_hockey':'\ud83c\udfd1',
  'file_cabinet':'\ud83d\uddc4',
  'file_folder':'\ud83d\udcc1',
  'film_projector':'\ud83d\udcfd',
  'film_strip':'\ud83c\udf9e',
  'fire':'\ud83d\udd25',
  'fire_engine':'\ud83d\ude92',
  'fireworks':'\ud83c\udf86',
  'first_quarter_moon':'\ud83c\udf13',
  'first_quarter_moon_with_face':'\ud83c\udf1b',
  'fish':'\ud83d\udc1f',
  'fish_cake':'\ud83c\udf65',
  'fishing_pole_and_fish':'\ud83c\udfa3',
  'fist_raised':'\u270a',
  'fist_left':'\ud83e\udd1b',
  'fist_right':'\ud83e\udd1c',
  'flags':'\ud83c\udf8f',
  'flashlight':'\ud83d\udd26',
  'fleur_de_lis':'\u269c\ufe0f',
  'flight_arrival':'\ud83d\udeec',
  'flight_departure':'\ud83d\udeeb',
  'floppy_disk':'\ud83d\udcbe',
  'flower_playing_cards':'\ud83c\udfb4',
  'flushed':'\ud83d\ude33',
  'fog':'\ud83c\udf2b',
  'foggy':'\ud83c\udf01',
  'football':'\ud83c\udfc8',
  'footprints':'\ud83d\udc63',
  'fork_and_knife':'\ud83c\udf74',
  'fountain':'\u26f2\ufe0f',
  'fountain_pen':'\ud83d\udd8b',
  'four_leaf_clover':'\ud83c\udf40',
  'fox_face':'\ud83e\udd8a',
  'framed_picture':'\ud83d\uddbc',
  'free':'\ud83c\udd93',
  'fried_egg':'\ud83c\udf73',
  'fried_shrimp':'\ud83c\udf64',
  'fries':'\ud83c\udf5f',
  'frog':'\ud83d\udc38',
  'frowning':'\ud83d\ude26',
  'frowning_face':'\u2639\ufe0f',
  'frowning_man':'\ud83d\ude4d&zwj;\u2642\ufe0f',
  'frowning_woman':'\ud83d\ude4d',
  'middle_finger':'\ud83d\udd95',
  'fuelpump':'\u26fd\ufe0f',
  'full_moon':'\ud83c\udf15',
  'full_moon_with_face':'\ud83c\udf1d',
  'funeral_urn':'\u26b1\ufe0f',
  'game_die':'\ud83c\udfb2',
  'gear':'\u2699\ufe0f',
  'gem':'\ud83d\udc8e',
  'gemini':'\u264a\ufe0f',
  'ghost':'\ud83d\udc7b',
  'gift':'\ud83c\udf81',
  'gift_heart':'\ud83d\udc9d',
  'girl':'\ud83d\udc67',
  'globe_with_meridians':'\ud83c\udf10',
  'goal_net':'\ud83e\udd45',
  'goat':'\ud83d\udc10',
  'golf':'\u26f3\ufe0f',
  'golfing_man':'\ud83c\udfcc\ufe0f',
  'golfing_woman':'\ud83c\udfcc\ufe0f&zwj;\u2640\ufe0f',
  'gorilla':'\ud83e\udd8d',
  'grapes':'\ud83c\udf47',
  'green_apple':'\ud83c\udf4f',
  'green_book':'\ud83d\udcd7',
  'green_heart':'\ud83d\udc9a',
  'green_salad':'\ud83e\udd57',
  'grey_exclamation':'\u2755',
  'grey_question':'\u2754',
  'grimacing':'\ud83d\ude2c',
  'grin':'\ud83d\ude01',
  'grinning':'\ud83d\ude00',
  'guardsman':'\ud83d\udc82',
  'guardswoman':'\ud83d\udc82&zwj;\u2640\ufe0f',
  'guitar':'\ud83c\udfb8',
  'gun':'\ud83d\udd2b',
  'haircut_woman':'\ud83d\udc87',
  'haircut_man':'\ud83d\udc87&zwj;\u2642\ufe0f',
  'hamburger':'\ud83c\udf54',
  'hammer':'\ud83d\udd28',
  'hammer_and_pick':'\u2692',
  'hammer_and_wrench':'\ud83d\udee0',
  'hamster':'\ud83d\udc39',
  'hand':'\u270b',
  'handbag':'\ud83d\udc5c',
  'handshake':'\ud83e\udd1d',
  'hankey':'\ud83d\udca9',
  'hatched_chick':'\ud83d\udc25',
  'hatching_chick':'\ud83d\udc23',
  'headphones':'\ud83c\udfa7',
  'hear_no_evil':'\ud83d\ude49',
  'heart':'\u2764\ufe0f',
  'heart_decoration':'\ud83d\udc9f',
  'heart_eyes':'\ud83d\ude0d',
  'heart_eyes_cat':'\ud83d\ude3b',
  'heartbeat':'\ud83d\udc93',
  'heartpulse':'\ud83d\udc97',
  'hearts':'\u2665\ufe0f',
  'heavy_check_mark':'\u2714\ufe0f',
  'heavy_division_sign':'\u2797',
  'heavy_dollar_sign':'\ud83d\udcb2',
  'heavy_heart_exclamation':'\u2763\ufe0f',
  'heavy_minus_sign':'\u2796',
  'heavy_multiplication_x':'\u2716\ufe0f',
  'heavy_plus_sign':'\u2795',
  'helicopter':'\ud83d\ude81',
  'herb':'\ud83c\udf3f',
  'hibiscus':'\ud83c\udf3a',
  'high_brightness':'\ud83d\udd06',
  'high_heel':'\ud83d\udc60',
  'hocho':'\ud83d\udd2a',
  'hole':'\ud83d\udd73',
  'honey_pot':'\ud83c\udf6f',
  'horse':'\ud83d\udc34',
  'horse_racing':'\ud83c\udfc7',
  'hospital':'\ud83c\udfe5',
  'hot_pepper':'\ud83c\udf36',
  'hotdog':'\ud83c\udf2d',
  'hotel':'\ud83c\udfe8',
  'hotsprings':'\u2668\ufe0f',
  'hourglass':'\u231b\ufe0f',
  'hourglass_flowing_sand':'\u23f3',
  'house':'\ud83c\udfe0',
  'house_with_garden':'\ud83c\udfe1',
  'houses':'\ud83c\udfd8',
  'hugs':'\ud83e\udd17',
  'hushed':'\ud83d\ude2f',
  'ice_cream':'\ud83c\udf68',
  'ice_hockey':'\ud83c\udfd2',
  'ice_skate':'\u26f8',
  'icecream':'\ud83c\udf66',
  'id':'\ud83c\udd94',
  'ideograph_advantage':'\ud83c\ude50',
  'imp':'\ud83d\udc7f',
  'inbox_tray':'\ud83d\udce5',
  'incoming_envelope':'\ud83d\udce8',
  'tipping_hand_woman':'\ud83d\udc81',
  'information_source':'\u2139\ufe0f',
  'innocent':'\ud83d\ude07',
  'interrobang':'\u2049\ufe0f',
  'iphone':'\ud83d\udcf1',
  'izakaya_lantern':'\ud83c\udfee',
  'jack_o_lantern':'\ud83c\udf83',
  'japan':'\ud83d\uddfe',
  'japanese_castle':'\ud83c\udfef',
  'japanese_goblin':'\ud83d\udc7a',
  'japanese_ogre':'\ud83d\udc79',
  'jeans':'\ud83d\udc56',
  'joy':'\ud83d\ude02',
  'joy_cat':'\ud83d\ude39',
  'joystick':'\ud83d\udd79',
  'kaaba':'\ud83d\udd4b',
  'key':'\ud83d\udd11',
  'keyboard':'\u2328\ufe0f',
  'keycap_ten':'\ud83d\udd1f',
  'kick_scooter':'\ud83d\udef4',
  'kimono':'\ud83d\udc58',
  'kiss':'\ud83d\udc8b',
  'kissing':'\ud83d\ude17',
  'kissing_cat':'\ud83d\ude3d',
  'kissing_closed_eyes':'\ud83d\ude1a',
  'kissing_heart':'\ud83d\ude18',
  'kissing_smiling_eyes':'\ud83d\ude19',
  'kiwi_fruit':'\ud83e\udd5d',
  'koala':'\ud83d\udc28',
  'koko':'\ud83c\ude01',
  'label':'\ud83c\udff7',
  'large_blue_circle':'\ud83d\udd35',
  'large_blue_diamond':'\ud83d\udd37',
  'large_orange_diamond':'\ud83d\udd36',
  'last_quarter_moon':'\ud83c\udf17',
  'last_quarter_moon_with_face':'\ud83c\udf1c',
  'latin_cross':'\u271d\ufe0f',
  'laughing':'\ud83d\ude06',
  'leaves':'\ud83c\udf43',
  'ledger':'\ud83d\udcd2',
  'left_luggage':'\ud83d\udec5',
  'left_right_arrow':'\u2194\ufe0f',
  'leftwards_arrow_with_hook':'\u21a9\ufe0f',
  'lemon':'\ud83c\udf4b',
  'leo':'\u264c\ufe0f',
  'leopard':'\ud83d\udc06',
  'level_slider':'\ud83c\udf9a',
  'libra':'\u264e\ufe0f',
  'light_rail':'\ud83d\ude88',
  'link':'\ud83d\udd17',
  'lion':'\ud83e\udd81',
  'lips':'\ud83d\udc44',
  'lipstick':'\ud83d\udc84',
  'lizard':'\ud83e\udd8e',
  'lock':'\ud83d\udd12',
  'lock_with_ink_pen':'\ud83d\udd0f',
  'lollipop':'\ud83c\udf6d',
  'loop':'\u27bf',
  'loud_sound':'\ud83d\udd0a',
  'loudspeaker':'\ud83d\udce2',
  'love_hotel':'\ud83c\udfe9',
  'love_letter':'\ud83d\udc8c',
  'low_brightness':'\ud83d\udd05',
  'lying_face':'\ud83e\udd25',
  'm':'\u24c2\ufe0f',
  'mag':'\ud83d\udd0d',
  'mag_right':'\ud83d\udd0e',
  'mahjong':'\ud83c\udc04\ufe0f',
  'mailbox':'\ud83d\udceb',
  'mailbox_closed':'\ud83d\udcea',
  'mailbox_with_mail':'\ud83d\udcec',
  'mailbox_with_no_mail':'\ud83d\udced',
  'man':'\ud83d\udc68',
  'man_artist':'\ud83d\udc68&zwj;\ud83c\udfa8',
  'man_astronaut':'\ud83d\udc68&zwj;\ud83d\ude80',
  'man_cartwheeling':'\ud83e\udd38&zwj;\u2642\ufe0f',
  'man_cook':'\ud83d\udc68&zwj;\ud83c\udf73',
  'man_dancing':'\ud83d\udd7a',
  'man_facepalming':'\ud83e\udd26&zwj;\u2642\ufe0f',
  'man_factory_worker':'\ud83d\udc68&zwj;\ud83c\udfed',
  'man_farmer':'\ud83d\udc68&zwj;\ud83c\udf3e',
  'man_firefighter':'\ud83d\udc68&zwj;\ud83d\ude92',
  'man_health_worker':'\ud83d\udc68&zwj;\u2695\ufe0f',
  'man_in_tuxedo':'\ud83e\udd35',
  'man_judge':'\ud83d\udc68&zwj;\u2696\ufe0f',
  'man_juggling':'\ud83e\udd39&zwj;\u2642\ufe0f',
  'man_mechanic':'\ud83d\udc68&zwj;\ud83d\udd27',
  'man_office_worker':'\ud83d\udc68&zwj;\ud83d\udcbc',
  'man_pilot':'\ud83d\udc68&zwj;\u2708\ufe0f',
  'man_playing_handball':'\ud83e\udd3e&zwj;\u2642\ufe0f',
  'man_playing_water_polo':'\ud83e\udd3d&zwj;\u2642\ufe0f',
  'man_scientist':'\ud83d\udc68&zwj;\ud83d\udd2c',
  'man_shrugging':'\ud83e\udd37&zwj;\u2642\ufe0f',
  'man_singer':'\ud83d\udc68&zwj;\ud83c\udfa4',
  'man_student':'\ud83d\udc68&zwj;\ud83c\udf93',
  'man_teacher':'\ud83d\udc68&zwj;\ud83c\udfeb',
  'man_technologist':'\ud83d\udc68&zwj;\ud83d\udcbb',
  'man_with_gua_pi_mao':'\ud83d\udc72',
  'man_with_turban':'\ud83d\udc73',
  'tangerine':'\ud83c\udf4a',
  'mans_shoe':'\ud83d\udc5e',
  'mantelpiece_clock':'\ud83d\udd70',
  'maple_leaf':'\ud83c\udf41',
  'martial_arts_uniform':'\ud83e\udd4b',
  'mask':'\ud83d\ude37',
  'massage_woman':'\ud83d\udc86',
  'massage_man':'\ud83d\udc86&zwj;\u2642\ufe0f',
  'meat_on_bone':'\ud83c\udf56',
  'medal_military':'\ud83c\udf96',
  'medal_sports':'\ud83c\udfc5',
  'mega':'\ud83d\udce3',
  'melon':'\ud83c\udf48',
  'memo':'\ud83d\udcdd',
  'men_wrestling':'\ud83e\udd3c&zwj;\u2642\ufe0f',
  'menorah':'\ud83d\udd4e',
  'mens':'\ud83d\udeb9',
  'metal':'\ud83e\udd18',
  'metro':'\ud83d\ude87',
  'microphone':'\ud83c\udfa4',
  'microscope':'\ud83d\udd2c',
  'milk_glass':'\ud83e\udd5b',
  'milky_way':'\ud83c\udf0c',
  'minibus':'\ud83d\ude90',
  'minidisc':'\ud83d\udcbd',
  'mobile_phone_off':'\ud83d\udcf4',
  'money_mouth_face':'\ud83e\udd11',
  'money_with_wings':'\ud83d\udcb8',
  'moneybag':'\ud83d\udcb0',
  'monkey':'\ud83d\udc12',
  'monkey_face':'\ud83d\udc35',
  'monorail':'\ud83d\ude9d',
  'moon':'\ud83c\udf14',
  'mortar_board':'\ud83c\udf93',
  'mosque':'\ud83d\udd4c',
  'motor_boat':'\ud83d\udee5',
  'motor_scooter':'\ud83d\udef5',
  'motorcycle':'\ud83c\udfcd',
  'motorway':'\ud83d\udee3',
  'mount_fuji':'\ud83d\uddfb',
  'mountain':'\u26f0',
  'mountain_biking_man':'\ud83d\udeb5',
  'mountain_biking_woman':'\ud83d\udeb5&zwj;\u2640\ufe0f',
  'mountain_cableway':'\ud83d\udea0',
  'mountain_railway':'\ud83d\ude9e',
  'mountain_snow':'\ud83c\udfd4',
  'mouse':'\ud83d\udc2d',
  'mouse2':'\ud83d\udc01',
  'movie_camera':'\ud83c\udfa5',
  'moyai':'\ud83d\uddff',
  'mrs_claus':'\ud83e\udd36',
  'muscle':'\ud83d\udcaa',
  'mushroom':'\ud83c\udf44',
  'musical_keyboard':'\ud83c\udfb9',
  'musical_note':'\ud83c\udfb5',
  'musical_score':'\ud83c\udfbc',
  'mute':'\ud83d\udd07',
  'nail_care':'\ud83d\udc85',
  'name_badge':'\ud83d\udcdb',
  'national_park':'\ud83c\udfde',
  'nauseated_face':'\ud83e\udd22',
  'necktie':'\ud83d\udc54',
  'negative_squared_cross_mark':'\u274e',
  'nerd_face':'\ud83e\udd13',
  'neutral_face':'\ud83d\ude10',
  'new':'\ud83c\udd95',
  'new_moon':'\ud83c\udf11',
  'new_moon_with_face':'\ud83c\udf1a',
  'newspaper':'\ud83d\udcf0',
  'newspaper_roll':'\ud83d\uddde',
  'next_track_button':'\u23ed',
  'ng':'\ud83c\udd96',
  'no_good_man':'\ud83d\ude45&zwj;\u2642\ufe0f',
  'no_good_woman':'\ud83d\ude45',
  'night_with_stars':'\ud83c\udf03',
  'no_bell':'\ud83d\udd15',
  'no_bicycles':'\ud83d\udeb3',
  'no_entry':'\u26d4\ufe0f',
  'no_entry_sign':'\ud83d\udeab',
  'no_mobile_phones':'\ud83d\udcf5',
  'no_mouth':'\ud83d\ude36',
  'no_pedestrians':'\ud83d\udeb7',
  'no_smoking':'\ud83d\udead',
  'non-potable_water':'\ud83d\udeb1',
  'nose':'\ud83d\udc43',
  'notebook':'\ud83d\udcd3',
  'notebook_with_decorative_cover':'\ud83d\udcd4',
  'notes':'\ud83c\udfb6',
  'nut_and_bolt':'\ud83d\udd29',
  'o':'\u2b55\ufe0f',
  'o2':'\ud83c\udd7e\ufe0f',
  'ocean':'\ud83c\udf0a',
  'octopus':'\ud83d\udc19',
  'oden':'\ud83c\udf62',
  'office':'\ud83c\udfe2',
  'oil_drum':'\ud83d\udee2',
  'ok':'\ud83c\udd97',
  'ok_hand':'\ud83d\udc4c',
  'ok_man':'\ud83d\ude46&zwj;\u2642\ufe0f',
  'ok_woman':'\ud83d\ude46',
  'old_key':'\ud83d\udddd',
  'older_man':'\ud83d\udc74',
  'older_woman':'\ud83d\udc75',
  'om':'\ud83d\udd49',
  'on':'\ud83d\udd1b',
  'oncoming_automobile':'\ud83d\ude98',
  'oncoming_bus':'\ud83d\ude8d',
  'oncoming_police_car':'\ud83d\ude94',
  'oncoming_taxi':'\ud83d\ude96',
  'open_file_folder':'\ud83d\udcc2',
  'open_hands':'\ud83d\udc50',
  'open_mouth':'\ud83d\ude2e',
  'open_umbrella':'\u2602\ufe0f',
  'ophiuchus':'\u26ce',
  'orange_book':'\ud83d\udcd9',
  'orthodox_cross':'\u2626\ufe0f',
  'outbox_tray':'\ud83d\udce4',
  'owl':'\ud83e\udd89',
  'ox':'\ud83d\udc02',
  'package':'\ud83d\udce6',
  'page_facing_up':'\ud83d\udcc4',
  'page_with_curl':'\ud83d\udcc3',
  'pager':'\ud83d\udcdf',
  'paintbrush':'\ud83d\udd8c',
  'palm_tree':'\ud83c\udf34',
  'pancakes':'\ud83e\udd5e',
  'panda_face':'\ud83d\udc3c',
  'paperclip':'\ud83d\udcce',
  'paperclips':'\ud83d\udd87',
  'parasol_on_ground':'\u26f1',
  'parking':'\ud83c\udd7f\ufe0f',
  'part_alternation_mark':'\u303d\ufe0f',
  'partly_sunny':'\u26c5\ufe0f',
  'passenger_ship':'\ud83d\udef3',
  'passport_control':'\ud83d\udec2',
  'pause_button':'\u23f8',
  'peace_symbol':'\u262e\ufe0f',
  'peach':'\ud83c\udf51',
  'peanuts':'\ud83e\udd5c',
  'pear':'\ud83c\udf50',
  'pen':'\ud83d\udd8a',
  'pencil2':'\u270f\ufe0f',
  'penguin':'\ud83d\udc27',
  'pensive':'\ud83d\ude14',
  'performing_arts':'\ud83c\udfad',
  'persevere':'\ud83d\ude23',
  'person_fencing':'\ud83e\udd3a',
  'pouting_woman':'\ud83d\ude4e',
  'phone':'\u260e\ufe0f',
  'pick':'\u26cf',
  'pig':'\ud83d\udc37',
  'pig2':'\ud83d\udc16',
  'pig_nose':'\ud83d\udc3d',
  'pill':'\ud83d\udc8a',
  'pineapple':'\ud83c\udf4d',
  'ping_pong':'\ud83c\udfd3',
  'pisces':'\u2653\ufe0f',
  'pizza':'\ud83c\udf55',
  'place_of_worship':'\ud83d\uded0',
  'plate_with_cutlery':'\ud83c\udf7d',
  'play_or_pause_button':'\u23ef',
  'point_down':'\ud83d\udc47',
  'point_left':'\ud83d\udc48',
  'point_right':'\ud83d\udc49',
  'point_up':'\u261d\ufe0f',
  'point_up_2':'\ud83d\udc46',
  'police_car':'\ud83d\ude93',
  'policewoman':'\ud83d\udc6e&zwj;\u2640\ufe0f',
  'poodle':'\ud83d\udc29',
  'popcorn':'\ud83c\udf7f',
  'post_office':'\ud83c\udfe3',
  'postal_horn':'\ud83d\udcef',
  'postbox':'\ud83d\udcee',
  'potable_water':'\ud83d\udeb0',
  'potato':'\ud83e\udd54',
  'pouch':'\ud83d\udc5d',
  'poultry_leg':'\ud83c\udf57',
  'pound':'\ud83d\udcb7',
  'rage':'\ud83d\ude21',
  'pouting_cat':'\ud83d\ude3e',
  'pouting_man':'\ud83d\ude4e&zwj;\u2642\ufe0f',
  'pray':'\ud83d\ude4f',
  'prayer_beads':'\ud83d\udcff',
  'pregnant_woman':'\ud83e\udd30',
  'previous_track_button':'\u23ee',
  'prince':'\ud83e\udd34',
  'princess':'\ud83d\udc78',
  'printer':'\ud83d\udda8',
  'purple_heart':'\ud83d\udc9c',
  'purse':'\ud83d\udc5b',
  'pushpin':'\ud83d\udccc',
  'put_litter_in_its_place':'\ud83d\udeae',
  'question':'\u2753',
  'rabbit':'\ud83d\udc30',
  'rabbit2':'\ud83d\udc07',
  'racehorse':'\ud83d\udc0e',
  'racing_car':'\ud83c\udfce',
  'radio':'\ud83d\udcfb',
  'radio_button':'\ud83d\udd18',
  'radioactive':'\u2622\ufe0f',
  'railway_car':'\ud83d\ude83',
  'railway_track':'\ud83d\udee4',
  'rainbow':'\ud83c\udf08',
  'rainbow_flag':'\ud83c\udff3\ufe0f&zwj;\ud83c\udf08',
  'raised_back_of_hand':'\ud83e\udd1a',
  'raised_hand_with_fingers_splayed':'\ud83d\udd90',
  'raised_hands':'\ud83d\ude4c',
  'raising_hand_woman':'\ud83d\ude4b',
  'raising_hand_man':'\ud83d\ude4b&zwj;\u2642\ufe0f',
  'ram':'\ud83d\udc0f',
  'ramen':'\ud83c\udf5c',
  'rat':'\ud83d\udc00',
  'record_button':'\u23fa',
  'recycle':'\u267b\ufe0f',
  'red_circle':'\ud83d\udd34',
  'registered':'\u00ae\ufe0f',
  'relaxed':'\u263a\ufe0f',
  'relieved':'\ud83d\ude0c',
  'reminder_ribbon':'\ud83c\udf97',
  'repeat':'\ud83d\udd01',
  'repeat_one':'\ud83d\udd02',
  'rescue_worker_helmet':'\u26d1',
  'restroom':'\ud83d\udebb',
  'revolving_hearts':'\ud83d\udc9e',
  'rewind':'\u23ea',
  'rhinoceros':'\ud83e\udd8f',
  'ribbon':'\ud83c\udf80',
  'rice':'\ud83c\udf5a',
  'rice_ball':'\ud83c\udf59',
  'rice_cracker':'\ud83c\udf58',
  'rice_scene':'\ud83c\udf91',
  'right_anger_bubble':'\ud83d\uddef',
  'ring':'\ud83d\udc8d',
  'robot':'\ud83e\udd16',
  'rocket':'\ud83d\ude80',
  'rofl':'\ud83e\udd23',
  'roll_eyes':'\ud83d\ude44',
  'roller_coaster':'\ud83c\udfa2',
  'rooster':'\ud83d\udc13',
  'rose':'\ud83c\udf39',
  'rosette':'\ud83c\udff5',
  'rotating_light':'\ud83d\udea8',
  'round_pushpin':'\ud83d\udccd',
  'rowing_man':'\ud83d\udea3',
  'rowing_woman':'\ud83d\udea3&zwj;\u2640\ufe0f',
  'rugby_football':'\ud83c\udfc9',
  'running_man':'\ud83c\udfc3',
  'running_shirt_with_sash':'\ud83c\udfbd',
  'running_woman':'\ud83c\udfc3&zwj;\u2640\ufe0f',
  'sa':'\ud83c\ude02\ufe0f',
  'sagittarius':'\u2650\ufe0f',
  'sake':'\ud83c\udf76',
  'sandal':'\ud83d\udc61',
  'santa':'\ud83c\udf85',
  'satellite':'\ud83d\udce1',
  'saxophone':'\ud83c\udfb7',
  'school':'\ud83c\udfeb',
  'school_satchel':'\ud83c\udf92',
  'scissors':'\u2702\ufe0f',
  'scorpion':'\ud83e\udd82',
  'scorpius':'\u264f\ufe0f',
  'scream':'\ud83d\ude31',
  'scream_cat':'\ud83d\ude40',
  'scroll':'\ud83d\udcdc',
  'seat':'\ud83d\udcba',
  'secret':'\u3299\ufe0f',
  'see_no_evil':'\ud83d\ude48',
  'seedling':'\ud83c\udf31',
  'selfie':'\ud83e\udd33',
  'shallow_pan_of_food':'\ud83e\udd58',
  'shamrock':'\u2618\ufe0f',
  'shark':'\ud83e\udd88',
  'shaved_ice':'\ud83c\udf67',
  'sheep':'\ud83d\udc11',
  'shell':'\ud83d\udc1a',
  'shield':'\ud83d\udee1',
  'shinto_shrine':'\u26e9',
  'ship':'\ud83d\udea2',
  'shirt':'\ud83d\udc55',
  'shopping':'\ud83d\udecd',
  'shopping_cart':'\ud83d\uded2',
  'shower':'\ud83d\udebf',
  'shrimp':'\ud83e\udd90',
  'signal_strength':'\ud83d\udcf6',
  'six_pointed_star':'\ud83d\udd2f',
  'ski':'\ud83c\udfbf',
  'skier':'\u26f7',
  'skull':'\ud83d\udc80',
  'skull_and_crossbones':'\u2620\ufe0f',
  'sleeping':'\ud83d\ude34',
  'sleeping_bed':'\ud83d\udecc',
  'sleepy':'\ud83d\ude2a',
  'slightly_frowning_face':'\ud83d\ude41',
  'slightly_smiling_face':'\ud83d\ude42',
  'slot_machine':'\ud83c\udfb0',
  'small_airplane':'\ud83d\udee9',
  'small_blue_diamond':'\ud83d\udd39',
  'small_orange_diamond':'\ud83d\udd38',
  'small_red_triangle':'\ud83d\udd3a',
  'small_red_triangle_down':'\ud83d\udd3b',
  'smile':'\ud83d\ude04',
  'smile_cat':'\ud83d\ude38',
  'smiley':'\ud83d\ude03',
  'smiley_cat':'\ud83d\ude3a',
  'smiling_imp':'\ud83d\ude08',
  'smirk':'\ud83d\ude0f',
  'smirk_cat':'\ud83d\ude3c',
  'smoking':'\ud83d\udeac',
  'snail':'\ud83d\udc0c',
  'snake':'\ud83d\udc0d',
  'sneezing_face':'\ud83e\udd27',
  'snowboarder':'\ud83c\udfc2',
  'snowflake':'\u2744\ufe0f',
  'snowman':'\u26c4\ufe0f',
  'snowman_with_snow':'\u2603\ufe0f',
  'sob':'\ud83d\ude2d',
  'soccer':'\u26bd\ufe0f',
  'soon':'\ud83d\udd1c',
  'sos':'\ud83c\udd98',
  'sound':'\ud83d\udd09',
  'space_invader':'\ud83d\udc7e',
  'spades':'\u2660\ufe0f',
  'spaghetti':'\ud83c\udf5d',
  'sparkle':'\u2747\ufe0f',
  'sparkler':'\ud83c\udf87',
  'sparkles':'\u2728',
  'sparkling_heart':'\ud83d\udc96',
  'speak_no_evil':'\ud83d\ude4a',
  'speaker':'\ud83d\udd08',
  'speaking_head':'\ud83d\udde3',
  'speech_balloon':'\ud83d\udcac',
  'speedboat':'\ud83d\udea4',
  'spider':'\ud83d\udd77',
  'spider_web':'\ud83d\udd78',
  'spiral_calendar':'\ud83d\uddd3',
  'spiral_notepad':'\ud83d\uddd2',
  'spoon':'\ud83e\udd44',
  'squid':'\ud83e\udd91',
  'stadium':'\ud83c\udfdf',
  'star':'\u2b50\ufe0f',
  'star2':'\ud83c\udf1f',
  'star_and_crescent':'\u262a\ufe0f',
  'star_of_david':'\u2721\ufe0f',
  'stars':'\ud83c\udf20',
  'station':'\ud83d\ude89',
  'statue_of_liberty':'\ud83d\uddfd',
  'steam_locomotive':'\ud83d\ude82',
  'stew':'\ud83c\udf72',
  'stop_button':'\u23f9',
  'stop_sign':'\ud83d\uded1',
  'stopwatch':'\u23f1',
  'straight_ruler':'\ud83d\udccf',
  'strawberry':'\ud83c\udf53',
  'stuck_out_tongue':'\ud83d\ude1b',
  'stuck_out_tongue_closed_eyes':'\ud83d\ude1d',
  'stuck_out_tongue_winking_eye':'\ud83d\ude1c',
  'studio_microphone':'\ud83c\udf99',
  'stuffed_flatbread':'\ud83e\udd59',
  'sun_behind_large_cloud':'\ud83c\udf25',
  'sun_behind_rain_cloud':'\ud83c\udf26',
  'sun_behind_small_cloud':'\ud83c\udf24',
  'sun_with_face':'\ud83c\udf1e',
  'sunflower':'\ud83c\udf3b',
  'sunglasses':'\ud83d\ude0e',
  'sunny':'\u2600\ufe0f',
  'sunrise':'\ud83c\udf05',
  'sunrise_over_mountains':'\ud83c\udf04',
  'surfing_man':'\ud83c\udfc4',
  'surfing_woman':'\ud83c\udfc4&zwj;\u2640\ufe0f',
  'sushi':'\ud83c\udf63',
  'suspension_railway':'\ud83d\ude9f',
  'sweat':'\ud83d\ude13',
  'sweat_drops':'\ud83d\udca6',
  'sweat_smile':'\ud83d\ude05',
  'sweet_potato':'\ud83c\udf60',
  'swimming_man':'\ud83c\udfca',
  'swimming_woman':'\ud83c\udfca&zwj;\u2640\ufe0f',
  'symbols':'\ud83d\udd23',
  'synagogue':'\ud83d\udd4d',
  'syringe':'\ud83d\udc89',
  'taco':'\ud83c\udf2e',
  'tada':'\ud83c\udf89',
  'tanabata_tree':'\ud83c\udf8b',
  'taurus':'\u2649\ufe0f',
  'taxi':'\ud83d\ude95',
  'tea':'\ud83c\udf75',
  'telephone_receiver':'\ud83d\udcde',
  'telescope':'\ud83d\udd2d',
  'tennis':'\ud83c\udfbe',
  'tent':'\u26fa\ufe0f',
  'thermometer':'\ud83c\udf21',
  'thinking':'\ud83e\udd14',
  'thought_balloon':'\ud83d\udcad',
  'ticket':'\ud83c\udfab',
  'tickets':'\ud83c\udf9f',
  'tiger':'\ud83d\udc2f',
  'tiger2':'\ud83d\udc05',
  'timer_clock':'\u23f2',
  'tipping_hand_man':'\ud83d\udc81&zwj;\u2642\ufe0f',
  'tired_face':'\ud83d\ude2b',
  'tm':'\u2122\ufe0f',
  'toilet':'\ud83d\udebd',
  'tokyo_tower':'\ud83d\uddfc',
  'tomato':'\ud83c\udf45',
  'tongue':'\ud83d\udc45',
  'top':'\ud83d\udd1d',
  'tophat':'\ud83c\udfa9',
  'tornado':'\ud83c\udf2a',
  'trackball':'\ud83d\uddb2',
  'tractor':'\ud83d\ude9c',
  'traffic_light':'\ud83d\udea5',
  'train':'\ud83d\ude8b',
  'train2':'\ud83d\ude86',
  'tram':'\ud83d\ude8a',
  'triangular_flag_on_post':'\ud83d\udea9',
  'triangular_ruler':'\ud83d\udcd0',
  'trident':'\ud83d\udd31',
  'triumph':'\ud83d\ude24',
  'trolleybus':'\ud83d\ude8e',
  'trophy':'\ud83c\udfc6',
  'tropical_drink':'\ud83c\udf79',
  'tropical_fish':'\ud83d\udc20',
  'truck':'\ud83d\ude9a',
  'trumpet':'\ud83c\udfba',
  'tulip':'\ud83c\udf37',
  'tumbler_glass':'\ud83e\udd43',
  'turkey':'\ud83e\udd83',
  'turtle':'\ud83d\udc22',
  'tv':'\ud83d\udcfa',
  'twisted_rightwards_arrows':'\ud83d\udd00',
  'two_hearts':'\ud83d\udc95',
  'two_men_holding_hands':'\ud83d\udc6c',
  'two_women_holding_hands':'\ud83d\udc6d',
  'u5272':'\ud83c\ude39',
  'u5408':'\ud83c\ude34',
  'u55b6':'\ud83c\ude3a',
  'u6307':'\ud83c\ude2f\ufe0f',
  'u6708':'\ud83c\ude37\ufe0f',
  'u6709':'\ud83c\ude36',
  'u6e80':'\ud83c\ude35',
  'u7121':'\ud83c\ude1a\ufe0f',
  'u7533':'\ud83c\ude38',
  'u7981':'\ud83c\ude32',
  'u7a7a':'\ud83c\ude33',
  'umbrella':'\u2614\ufe0f',
  'unamused':'\ud83d\ude12',
  'underage':'\ud83d\udd1e',
  'unicorn':'\ud83e\udd84',
  'unlock':'\ud83d\udd13',
  'up':'\ud83c\udd99',
  'upside_down_face':'\ud83d\ude43',
  'v':'\u270c\ufe0f',
  'vertical_traffic_light':'\ud83d\udea6',
  'vhs':'\ud83d\udcfc',
  'vibration_mode':'\ud83d\udcf3',
  'video_camera':'\ud83d\udcf9',
  'video_game':'\ud83c\udfae',
  'violin':'\ud83c\udfbb',
  'virgo':'\u264d\ufe0f',
  'volcano':'\ud83c\udf0b',
  'volleyball':'\ud83c\udfd0',
  'vs':'\ud83c\udd9a',
  'vulcan_salute':'\ud83d\udd96',
  'walking_man':'\ud83d\udeb6',
  'walking_woman':'\ud83d\udeb6&zwj;\u2640\ufe0f',
  'waning_crescent_moon':'\ud83c\udf18',
  'waning_gibbous_moon':'\ud83c\udf16',
  'warning':'\u26a0\ufe0f',
  'wastebasket':'\ud83d\uddd1',
  'watch':'\u231a\ufe0f',
  'water_buffalo':'\ud83d\udc03',
  'watermelon':'\ud83c\udf49',
  'wave':'\ud83d\udc4b',
  'wavy_dash':'\u3030\ufe0f',
  'waxing_crescent_moon':'\ud83c\udf12',
  'wc':'\ud83d\udebe',
  'weary':'\ud83d\ude29',
  'wedding':'\ud83d\udc92',
  'weight_lifting_man':'\ud83c\udfcb\ufe0f',
  'weight_lifting_woman':'\ud83c\udfcb\ufe0f&zwj;\u2640\ufe0f',
  'whale':'\ud83d\udc33',
  'whale2':'\ud83d\udc0b',
  'wheel_of_dharma':'\u2638\ufe0f',
  'wheelchair':'\u267f\ufe0f',
  'white_check_mark':'\u2705',
  'white_circle':'\u26aa\ufe0f',
  'white_flag':'\ud83c\udff3\ufe0f',
  'white_flower':'\ud83d\udcae',
  'white_large_square':'\u2b1c\ufe0f',
  'white_medium_small_square':'\u25fd\ufe0f',
  'white_medium_square':'\u25fb\ufe0f',
  'white_small_square':'\u25ab\ufe0f',
  'white_square_button':'\ud83d\udd33',
  'wilted_flower':'\ud83e\udd40',
  'wind_chime':'\ud83c\udf90',
  'wind_face':'\ud83c\udf2c',
  'wine_glass':'\ud83c\udf77',
  'wink':'\ud83d\ude09',
  'wolf':'\ud83d\udc3a',
  'woman':'\ud83d\udc69',
  'woman_artist':'\ud83d\udc69&zwj;\ud83c\udfa8',
  'woman_astronaut':'\ud83d\udc69&zwj;\ud83d\ude80',
  'woman_cartwheeling':'\ud83e\udd38&zwj;\u2640\ufe0f',
  'woman_cook':'\ud83d\udc69&zwj;\ud83c\udf73',
  'woman_facepalming':'\ud83e\udd26&zwj;\u2640\ufe0f',
  'woman_factory_worker':'\ud83d\udc69&zwj;\ud83c\udfed',
  'woman_farmer':'\ud83d\udc69&zwj;\ud83c\udf3e',
  'woman_firefighter':'\ud83d\udc69&zwj;\ud83d\ude92',
  'woman_health_worker':'\ud83d\udc69&zwj;\u2695\ufe0f',
  'woman_judge':'\ud83d\udc69&zwj;\u2696\ufe0f',
  'woman_juggling':'\ud83e\udd39&zwj;\u2640\ufe0f',
  'woman_mechanic':'\ud83d\udc69&zwj;\ud83d\udd27',
  'woman_office_worker':'\ud83d\udc69&zwj;\ud83d\udcbc',
  'woman_pilot':'\ud83d\udc69&zwj;\u2708\ufe0f',
  'woman_playing_handball':'\ud83e\udd3e&zwj;\u2640\ufe0f',
  'woman_playing_water_polo':'\ud83e\udd3d&zwj;\u2640\ufe0f',
  'woman_scientist':'\ud83d\udc69&zwj;\ud83d\udd2c',
  'woman_shrugging':'\ud83e\udd37&zwj;\u2640\ufe0f',
  'woman_singer':'\ud83d\udc69&zwj;\ud83c\udfa4',
  'woman_student':'\ud83d\udc69&zwj;\ud83c\udf93',
  'woman_teacher':'\ud83d\udc69&zwj;\ud83c\udfeb',
  'woman_technologist':'\ud83d\udc69&zwj;\ud83d\udcbb',
  'woman_with_turban':'\ud83d\udc73&zwj;\u2640\ufe0f',
  'womans_clothes':'\ud83d\udc5a',
  'womans_hat':'\ud83d\udc52',
  'women_wrestling':'\ud83e\udd3c&zwj;\u2640\ufe0f',
  'womens':'\ud83d\udeba',
  'world_map':'\ud83d\uddfa',
  'worried':'\ud83d\ude1f',
  'wrench':'\ud83d\udd27',
  'writing_hand':'\u270d\ufe0f',
  'x':'\u274c',
  'yellow_heart':'\ud83d\udc9b',
  'yen':'\ud83d\udcb4',
  'yin_yang':'\u262f\ufe0f',
  'yum':'\ud83d\ude0b',
  'zap':'\u26a1\ufe0f',
  'zipper_mouth_face':'\ud83e\udd10',
  'zzz':'\ud83d\udca4',

  /* special emojis :P */
  'octocat':  '<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',
  'showdown': '<span style="font-family: \'Anonymous Pro\', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>'
};

/**
 * Created by Estevao on 31-05-2015.
 */

/**
 * Showdown Converter class
 * @class
 * @param {object} [converterOptions]
 * @returns {Converter}
 */
showdown.Converter = function (converterOptions) {
  'use strict';

  var
      /**
       * Options used by this converter
       * @private
       * @type {{}}
       */
      options = {},

      /**
       * Language extensions used by this converter
       * @private
       * @type {Array}
       */
      langExtensions = [],

      /**
       * Output modifiers extensions used by this converter
       * @private
       * @type {Array}
       */
      outputModifiers = [],

      /**
       * Event listeners
       * @private
       * @type {{}}
       */
      listeners = {},

      /**
       * The flavor set in this converter
       */
      setConvFlavor = setFlavor,

      /**
       * Metadata of the document
       * @type {{parsed: {}, raw: string, format: string}}
       */
      metadata = {
        parsed: {},
        raw: '',
        format: ''
      };

  _constructor();

  /**
   * Converter constructor
   * @private
   */
  function _constructor () {
    converterOptions = converterOptions || {};

    for (var gOpt in globalOptions) {
      if (globalOptions.hasOwnProperty(gOpt)) {
        options[gOpt] = globalOptions[gOpt];
      }
    }

    // Merge options
    if (typeof converterOptions === 'object') {
      for (var opt in converterOptions) {
        if (converterOptions.hasOwnProperty(opt)) {
          options[opt] = converterOptions[opt];
        }
      }
    } else {
      throw Error('Converter expects the passed parameter to be an object, but ' + typeof converterOptions +
      ' was passed instead.');
    }

    if (options.extensions) {
      showdown.helper.forEach(options.extensions, _parseExtension);
    }
  }

  /**
   * Parse extension
   * @param {*} ext
   * @param {string} [name='']
   * @private
   */
  function _parseExtension (ext, name) {

    name = name || null;
    // If it's a string, the extension was previously loaded
    if (showdown.helper.isString(ext)) {
      ext = showdown.helper.stdExtName(ext);
      name = ext;

      // LEGACY_SUPPORT CODE
      if (showdown.extensions[ext]) {
        console.warn('DEPRECATION WARNING: ' + ext + ' is an old extension that uses a deprecated loading method.' +
          'Please inform the developer that the extension should be updated!');
        legacyExtensionLoading(showdown.extensions[ext], ext);
        return;
        // END LEGACY SUPPORT CODE

      } else if (!showdown.helper.isUndefined(extensions[ext])) {
        ext = extensions[ext];

      } else {
        throw Error('Extension "' + ext + '" could not be loaded. It was either not found or is not a valid extension.');
      }
    }

    if (typeof ext === 'function') {
      ext = ext();
    }

    if (!showdown.helper.isArray(ext)) {
      ext = [ext];
    }

    var validExt = validate(ext, name);
    if (!validExt.valid) {
      throw Error(validExt.error);
    }

    for (var i = 0; i < ext.length; ++i) {
      switch (ext[i].type) {

        case 'lang':
          langExtensions.push(ext[i]);
          break;

        case 'output':
          outputModifiers.push(ext[i]);
          break;
      }
      if (ext[i].hasOwnProperty('listeners')) {
        for (var ln in ext[i].listeners) {
          if (ext[i].listeners.hasOwnProperty(ln)) {
            listen(ln, ext[i].listeners[ln]);
          }
        }
      }
    }

  }

  /**
   * LEGACY_SUPPORT
   * @param {*} ext
   * @param {string} name
   */
  function legacyExtensionLoading (ext, name) {
    if (typeof ext === 'function') {
      ext = ext(new showdown.Converter());
    }
    if (!showdown.helper.isArray(ext)) {
      ext = [ext];
    }
    var valid = validate(ext, name);

    if (!valid.valid) {
      throw Error(valid.error);
    }

    for (var i = 0; i < ext.length; ++i) {
      switch (ext[i].type) {
        case 'lang':
          langExtensions.push(ext[i]);
          break;
        case 'output':
          outputModifiers.push(ext[i]);
          break;
        default:// should never reach here
          throw Error('Extension loader error: Type unrecognized!!!');
      }
    }
  }

  /**
   * Listen to an event
   * @param {string} name
   * @param {function} callback
   */
  function listen (name, callback) {
    if (!showdown.helper.isString(name)) {
      throw Error('Invalid argument in converter.listen() method: name must be a string, but ' + typeof name + ' given');
    }

    if (typeof callback !== 'function') {
      throw Error('Invalid argument in converter.listen() method: callback must be a function, but ' + typeof callback + ' given');
    }

    if (!listeners.hasOwnProperty(name)) {
      listeners[name] = [];
    }
    listeners[name].push(callback);
  }

  function rTrimInputText (text) {
    var rsp = text.match(/^\s*/)[0].length,
        rgx = new RegExp('^\\s{0,' + rsp + '}', 'gm');
    return text.replace(rgx, '');
  }

  /**
   * Dispatch an event
   * @private
   * @param {string} evtName Event name
   * @param {string} text Text
   * @param {{}} options Converter Options
   * @param {{}} globals
   * @returns {string}
   */
  this._dispatch = function dispatch (evtName, text, options, globals) {
    if (listeners.hasOwnProperty(evtName)) {
      for (var ei = 0; ei < listeners[evtName].length; ++ei) {
        var nText = listeners[evtName][ei](evtName, text, this, options, globals);
        if (nText && typeof nText !== 'undefined') {
          text = nText;
        }
      }
    }
    return text;
  };

  /**
   * Listen to an event
   * @param {string} name
   * @param {function} callback
   * @returns {showdown.Converter}
   */
  this.listen = function (name, callback) {
    listen(name, callback);
    return this;
  };

  /**
   * Converts a markdown string into HTML
   * @param {string} text
   * @returns {*}
   */
  this.makeHtml = function (text) {
    //check if text is not falsy
    if (!text) {
      return text;
    }

    var globals = {
      gHtmlBlocks:     [],
      gHtmlMdBlocks:   [],
      gHtmlSpans:      [],
      gUrls:           {},
      gTitles:         {},
      gDimensions:     {},
      gListLevel:      0,
      hashLinkCounts:  {},
      langExtensions:  langExtensions,
      outputModifiers: outputModifiers,
      converter:       this,
      ghCodeBlocks:    [],
      metadata: {
        parsed: {},
        raw: '',
        format: ''
      }
    };

    // This lets us use ¨ trema as an escape char to avoid md5 hashes
    // The choice of character is arbitrary; anything that isn't
    // magic in Markdown will work.
    text = text.replace(/¨/g, '¨T');

    // Replace $ with ¨D
    // RegExp interprets $ as a special character
    // when it's in a replacement string
    text = text.replace(/\$/g, '¨D');

    // Standardize line endings
    text = text.replace(/\r\n/g, '\n'); // DOS to Unix
    text = text.replace(/\r/g, '\n'); // Mac to Unix

    // Stardardize line spaces
    text = text.replace(/\u00A0/g, '&nbsp;');

    if (options.smartIndentationFix) {
      text = rTrimInputText(text);
    }

    // Make sure text begins and ends with a couple of newlines:
    text = '\n\n' + text + '\n\n';

    // detab
    text = showdown.subParser('detab')(text, options, globals);

    /**
     * Strip any lines consisting only of spaces and tabs.
     * This makes subsequent regexs easier to write, because we can
     * match consecutive blank lines with /\n+/ instead of something
     * contorted like /[ \t]*\n+/
     */
    text = text.replace(/^[ \t]+$/mg, '');

    //run languageExtensions
    showdown.helper.forEach(langExtensions, function (ext) {
      text = showdown.subParser('runExtension')(ext, text, options, globals);
    });

    // run the sub parsers
    text = showdown.subParser('metadata')(text, options, globals);
    text = showdown.subParser('hashPreCodeTags')(text, options, globals);
    text = showdown.subParser('githubCodeBlocks')(text, options, globals);
    text = showdown.subParser('hashHTMLBlocks')(text, options, globals);
    text = showdown.subParser('hashCodeTags')(text, options, globals);
    text = showdown.subParser('stripLinkDefinitions')(text, options, globals);
    text = showdown.subParser('blockGamut')(text, options, globals);
    text = showdown.subParser('unhashHTMLSpans')(text, options, globals);
    text = showdown.subParser('unescapeSpecialChars')(text, options, globals);

    // attacklab: Restore dollar signs
    text = text.replace(/¨D/g, '$$');

    // attacklab: Restore tremas
    text = text.replace(/¨T/g, '¨');

    // render a complete html document instead of a partial if the option is enabled
    text = showdown.subParser('completeHTMLDocument')(text, options, globals);

    // Run output modifiers
    showdown.helper.forEach(outputModifiers, function (ext) {
      text = showdown.subParser('runExtension')(ext, text, options, globals);
    });

    // update metadata
    metadata = globals.metadata;
    return text;
  };

  /**
   * Converts an HTML string into a markdown string
   * @param src
   * @param [HTMLParser] A WHATWG DOM and HTML parser, such as JSDOM. If none is supplied, window.document will be used.
   * @returns {string}
   */
  this.makeMarkdown = this.makeMd = function (src, HTMLParser) {

    // replace \r\n with \n
    src = src.replace(/\r\n/g, '\n');
    src = src.replace(/\r/g, '\n'); // old macs

    // due to an edge case, we need to find this: > <
    // to prevent removing of non silent white spaces
    // ex: <em>this is</em> <strong>sparta</strong>
    src = src.replace(/>[ \t]+</, '>¨NBSP;<');

    if (!HTMLParser) {
      if (window && window.document) {
        HTMLParser = window.document;
      } else {
        throw new Error('HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM');
      }
    }

    var doc = HTMLParser.createElement('div');
    doc.innerHTML = src;

    var globals = {
      preList: substitutePreCodeTags(doc)
    };

    // remove all newlines and collapse spaces
    clean(doc);

    // some stuff, like accidental reference links must now be escaped
    // TODO
    // doc.innerHTML = doc.innerHTML.replace(/\[[\S\t ]]/);

    var nodes = doc.childNodes,
        mdDoc = '';

    for (var i = 0; i < nodes.length; i++) {
      mdDoc += showdown.subParser('makeMarkdown.node')(nodes[i], globals);
    }

    function clean (node) {
      for (var n = 0; n < node.childNodes.length; ++n) {
        var child = node.childNodes[n];
        if (child.nodeType === 3) {
          if (!/\S/.test(child.nodeValue)) {
            node.removeChild(child);
            --n;
          } else {
            child.nodeValue = child.nodeValue.split('\n').join(' ');
            child.nodeValue = child.nodeValue.replace(/(\s)+/g, '$1');
          }
        } else if (child.nodeType === 1) {
          clean(child);
        }
      }
    }

    // find all pre tags and replace contents with placeholder
    // we need this so that we can remove all indentation from html
    // to ease up parsing
    function substitutePreCodeTags (doc) {

      var pres = doc.querySelectorAll('pre'),
          presPH = [];

      for (var i = 0; i < pres.length; ++i) {

        if (pres[i].childElementCount === 1 && pres[i].firstChild.tagName.toLowerCase() === 'code') {
          var content = pres[i].firstChild.innerHTML.trim(),
              language = pres[i].firstChild.getAttribute('data-language') || '';

          // if data-language attribute is not defined, then we look for class language-*
          if (language === '') {
            var classes = pres[i].firstChild.className.split(' ');
            for (var c = 0; c < classes.length; ++c) {
              var matches = classes[c].match(/^language-(.+)$/);
              if (matches !== null) {
                language = matches[1];
                break;
              }
            }
          }

          // unescape html entities in content
          content = showdown.helper.unescapeHTMLEntities(content);

          presPH.push(content);
          pres[i].outerHTML = '<precode language="' + language + '" precodenum="' + i.toString() + '"></precode>';
        } else {
          presPH.push(pres[i].innerHTML);
          pres[i].innerHTML = '';
          pres[i].setAttribute('prenum', i.toString());
        }
      }
      return presPH;
    }

    return mdDoc;
  };

  /**
   * Set an option of this Converter instance
   * @param {string} key
   * @param {*} value
   */
  this.setOption = function (key, value) {
    options[key] = value;
  };

  /**
   * Get the option of this Converter instance
   * @param {string} key
   * @returns {*}
   */
  this.getOption = function (key) {
    return options[key];
  };

  /**
   * Get the options of this Converter instance
   * @returns {{}}
   */
  this.getOptions = function () {
    return options;
  };

  /**
   * Add extension to THIS converter
   * @param {{}} extension
   * @param {string} [name=null]
   */
  this.addExtension = function (extension, name) {
    name = name || null;
    _parseExtension(extension, name);
  };

  /**
   * Use a global registered extension with THIS converter
   * @param {string} extensionName Name of the previously registered extension
   */
  this.useExtension = function (extensionName) {
    _parseExtension(extensionName);
  };

  /**
   * Set the flavor THIS converter should use
   * @param {string} name
   */
  this.setFlavor = function (name) {
    if (!flavor.hasOwnProperty(name)) {
      throw Error(name + ' flavor was not found');
    }
    var preset = flavor[name];
    setConvFlavor = name;
    for (var option in preset) {
      if (preset.hasOwnProperty(option)) {
        options[option] = preset[option];
      }
    }
  };

  /**
   * Get the currently set flavor of this converter
   * @returns {string}
   */
  this.getFlavor = function () {
    return setConvFlavor;
  };

  /**
   * Remove an extension from THIS converter.
   * Note: This is a costly operation. It's better to initialize a new converter
   * and specify the extensions you wish to use
   * @param {Array} extension
   */
  this.removeExtension = function (extension) {
    if (!showdown.helper.isArray(extension)) {
      extension = [extension];
    }
    for (var a = 0; a < extension.length; ++a) {
      var ext = extension[a];
      for (var i = 0; i < langExtensions.length; ++i) {
        if (langExtensions[i] === ext) {
          langExtensions[i].splice(i, 1);
        }
      }
      for (var ii = 0; ii < outputModifiers.length; ++i) {
        if (outputModifiers[ii] === ext) {
          outputModifiers[ii].splice(i, 1);
        }
      }
    }
  };

  /**
   * Get all extension of THIS converter
   * @returns {{language: Array, output: Array}}
   */
  this.getAllExtensions = function () {
    return {
      language: langExtensions,
      output: outputModifiers
    };
  };

  /**
   * Get the metadata of the previously parsed document
   * @param raw
   * @returns {string|{}}
   */
  this.getMetadata = function (raw) {
    if (raw) {
      return metadata.raw;
    } else {
      return metadata.parsed;
    }
  };

  /**
   * Get the metadata format of the previously parsed document
   * @returns {string}
   */
  this.getMetadataFormat = function () {
    return metadata.format;
  };

  /**
   * Private: set a single key, value metadata pair
   * @param {string} key
   * @param {string} value
   */
  this._setMetadataPair = function (key, value) {
    metadata.parsed[key] = value;
  };

  /**
   * Private: set metadata format
   * @param {string} format
   */
  this._setMetadataFormat = function (format) {
    metadata.format = format;
  };

  /**
   * Private: set metadata raw text
   * @param {string} raw
   */
  this._setMetadataRaw = function (raw) {
    metadata.raw = raw;
  };
};

/**
 * Turn Markdown link shortcuts into XHTML <a> tags.
 */
showdown.subParser('anchors', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('anchors.before', text, options, globals);

  var writeAnchorTag = function (wholeMatch, linkText, linkId, url, m5, m6, title) {
    if (showdown.helper.isUndefined(title)) {
      title = '';
    }
    linkId = linkId.toLowerCase();

    // Special case for explicit empty url
    if (wholeMatch.search(/\(<?\s*>? ?(['"].*['"])?\)$/m) > -1) {
      url = '';
    } else if (!url) {
      if (!linkId) {
        // lower-case and turn embedded newlines into spaces
        linkId = linkText.toLowerCase().replace(/ ?\n/g, ' ');
      }
      url = '#' + linkId;

      if (!showdown.helper.isUndefined(globals.gUrls[linkId])) {
        url = globals.gUrls[linkId];
        if (!showdown.helper.isUndefined(globals.gTitles[linkId])) {
          title = globals.gTitles[linkId];
        }
      } else {
        return wholeMatch;
      }
    }

    //url = showdown.helper.escapeCharacters(url, '*_', false); // replaced line to improve performance
    url = url.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);

    var result = '<a href="' + url + '"';

    if (title !== '' && title !== null) {
      title = title.replace(/"/g, '&quot;');
      //title = showdown.helper.escapeCharacters(title, '*_', false); // replaced line to improve performance
      title = title.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);
      result += ' title="' + title + '"';
    }

    // optionLinksInNewWindow only applies
    // to external links. Hash links (#) open in same page
    if (options.openLinksInNewWindow && !/^#/.test(url)) {
      // escaped _
      result += ' rel="noopener noreferrer" target="¨E95Eblank"';
    }

    result += '>' + linkText + '</a>';

    return result;
  };

  // First, handle reference-style links: [link text] [id]
  text = text.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g, writeAnchorTag);

  // Next, inline-style links: [link text](url "optional title")
  // cases with crazy urls like ./image/cat1).png
  text = text.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,
    writeAnchorTag);

  // normal cases
  text = text.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,
    writeAnchorTag);

  // handle reference-style shortcuts: [link text]
  // These must come last in case you've also got [link test][1]
  // or [link test](/foo)
  text = text.replace(/\[([^\[\]]+)]()()()()()/g, writeAnchorTag);

  // Lastly handle GithubMentions if option is enabled
  if (options.ghMentions) {
    text = text.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi, function (wm, st, escape, mentions, username) {
      if (escape === '\\') {
        return st + mentions;
      }

      //check if options.ghMentionsLink is a string
      if (!showdown.helper.isString(options.ghMentionsLink)) {
        throw new Error('ghMentionsLink option must be a string');
      }
      var lnk = options.ghMentionsLink.replace(/\{u}/g, username),
          target = '';
      if (options.openLinksInNewWindow) {
        target = ' rel="noopener noreferrer" target="¨E95Eblank"';
      }
      return st + '<a href="' + lnk + '"' + target + '>' + mentions + '</a>';
    });
  }

  text = globals.converter._dispatch('anchors.after', text, options, globals);
  return text;
});

// url allowed chars [a-z\d_.~:/?#[]@!$&'()*+,;=-]

var simpleURLRegex  = /([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,
    simpleURLRegex2 = /([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,
    delimUrlRegex   = /()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,
    simpleMailRegex = /(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,
    delimMailRegex  = /<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,

    replaceLink = function (options) {
      'use strict';
      return function (wm, leadingMagicChars, link, m2, m3, trailingPunctuation, trailingMagicChars) {
        link = link.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);
        var lnkTxt = link,
            append = '',
            target = '',
            lmc    = leadingMagicChars || '',
            tmc    = trailingMagicChars || '';
        if (/^www\./i.test(link)) {
          link = link.replace(/^www\./i, 'http://www.');
        }
        if (options.excludeTrailingPunctuationFromURLs && trailingPunctuation) {
          append = trailingPunctuation;
        }
        if (options.openLinksInNewWindow) {
          target = ' rel="noopener noreferrer" target="¨E95Eblank"';
        }
        return lmc + '<a href="' + link + '"' + target + '>' + lnkTxt + '</a>' + append + tmc;
      };
    },

    replaceMail = function (options, globals) {
      'use strict';
      return function (wholeMatch, b, mail) {
        var href = 'mailto:';
        b = b || '';
        mail = showdown.subParser('unescapeSpecialChars')(mail, options, globals);
        if (options.encodeEmails) {
          href = showdown.helper.encodeEmailAddress(href + mail);
          mail = showdown.helper.encodeEmailAddress(mail);
        } else {
          href = href + mail;
        }
        return b + '<a href="' + href + '">' + mail + '</a>';
      };
    };

showdown.subParser('autoLinks', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('autoLinks.before', text, options, globals);

  text = text.replace(delimUrlRegex, replaceLink(options));
  text = text.replace(delimMailRegex, replaceMail(options, globals));

  text = globals.converter._dispatch('autoLinks.after', text, options, globals);

  return text;
});

showdown.subParser('simplifiedAutoLinks', function (text, options, globals) {
  'use strict';

  if (!options.simplifiedAutoLink) {
    return text;
  }

  text = globals.converter._dispatch('simplifiedAutoLinks.before', text, options, globals);

  if (options.excludeTrailingPunctuationFromURLs) {
    text = text.replace(simpleURLRegex2, replaceLink(options));
  } else {
    text = text.replace(simpleURLRegex, replaceLink(options));
  }
  text = text.replace(simpleMailRegex, replaceMail(options, globals));

  text = globals.converter._dispatch('simplifiedAutoLinks.after', text, options, globals);

  return text;
});

/**
 * These are all the transformations that form block-level
 * tags like paragraphs, headers, and list items.
 */
showdown.subParser('blockGamut', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('blockGamut.before', text, options, globals);

  // we parse blockquotes first so that we can have headings and hrs
  // inside blockquotes
  text = showdown.subParser('blockQuotes')(text, options, globals);
  text = showdown.subParser('headers')(text, options, globals);

  // Do Horizontal Rules:
  text = showdown.subParser('horizontalRule')(text, options, globals);

  text = showdown.subParser('lists')(text, options, globals);
  text = showdown.subParser('codeBlocks')(text, options, globals);
  text = showdown.subParser('tables')(text, options, globals);

  // We already ran _HashHTMLBlocks() before, in Markdown(), but that
  // was to escape raw HTML in the original Markdown source. This time,
  // we're escaping the markup we've just created, so that we don't wrap
  // <p> tags around block-level tags.
  text = showdown.subParser('hashHTMLBlocks')(text, options, globals);
  text = showdown.subParser('paragraphs')(text, options, globals);

  text = globals.converter._dispatch('blockGamut.after', text, options, globals);

  return text;
});

showdown.subParser('blockQuotes', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('blockQuotes.before', text, options, globals);

  // add a couple extra lines after the text and endtext mark
  text = text + '\n\n';

  var rgx = /(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;

  if (options.splitAdjacentBlockquotes) {
    rgx = /^ {0,3}>[\s\S]*?(?:\n\n)/gm;
  }

  text = text.replace(rgx, function (bq) {
    // attacklab: hack around Konqueror 3.5.4 bug:
    // "----------bug".replace(/^-/g,"") == "bug"
    bq = bq.replace(/^[ \t]*>[ \t]?/gm, ''); // trim one level of quoting

    // attacklab: clean up hack
    bq = bq.replace(/¨0/g, '');

    bq = bq.replace(/^[ \t]+$/gm, ''); // trim whitespace-only lines
    bq = showdown.subParser('githubCodeBlocks')(bq, options, globals);
    bq = showdown.subParser('blockGamut')(bq, options, globals); // recurse

    bq = bq.replace(/(^|\n)/g, '$1  ');
    // These leading spaces screw with <pre> content, so we need to fix that:
    bq = bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm, function (wholeMatch, m1) {
      var pre = m1;
      // attacklab: hack around Konqueror 3.5.4 bug:
      pre = pre.replace(/^  /mg, '¨0');
      pre = pre.replace(/¨0/g, '');
      return pre;
    });

    return showdown.subParser('hashBlock')('<blockquote>\n' + bq + '\n</blockquote>', options, globals);
  });

  text = globals.converter._dispatch('blockQuotes.after', text, options, globals);
  return text;
});

/**
 * Process Markdown `<pre><code>` blocks.
 */
showdown.subParser('codeBlocks', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('codeBlocks.before', text, options, globals);

  // sentinel workarounds for lack of \A and \Z, safari\khtml bug
  text += '¨0';

  var pattern = /(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g;
  text = text.replace(pattern, function (wholeMatch, m1, m2) {
    var codeblock = m1,
        nextChar = m2,
        end = '\n';

    codeblock = showdown.subParser('outdent')(codeblock, options, globals);
    codeblock = showdown.subParser('encodeCode')(codeblock, options, globals);
    codeblock = showdown.subParser('detab')(codeblock, options, globals);
    codeblock = codeblock.replace(/^\n+/g, ''); // trim leading newlines
    codeblock = codeblock.replace(/\n+$/g, ''); // trim trailing newlines

    if (options.omitExtraWLInCodeBlocks) {
      end = '';
    }

    codeblock = '<pre><code>' + codeblock + end + '</code></pre>';

    return showdown.subParser('hashBlock')(codeblock, options, globals) + nextChar;
  });

  // strip sentinel
  text = text.replace(/¨0/, '');

  text = globals.converter._dispatch('codeBlocks.after', text, options, globals);
  return text;
});

/**
 *
 *   *  Backtick quotes are used for <code></code> spans.
 *
 *   *  You can use multiple backticks as the delimiters if you want to
 *     include literal backticks in the code span. So, this input:
 *
 *         Just type ``foo `bar` baz`` at the prompt.
 *
 *       Will translate to:
 *
 *         <p>Just type <code>foo `bar` baz</code> at the prompt.</p>
 *
 *    There's no arbitrary limit to the number of backticks you
 *    can use as delimters. If you need three consecutive backticks
 *    in your code, use four for delimiters, etc.
 *
 *  *  You can use spaces to get literal backticks at the edges:
 *
 *         ... type `` `bar` `` ...
 *
 *       Turns to:
 *
 *         ... type <code>`bar`</code> ...
 */
showdown.subParser('codeSpans', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('codeSpans.before', text, options, globals);

  if (typeof text === 'undefined') {
    text = '';
  }
  text = text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,
    function (wholeMatch, m1, m2, m3) {
      var c = m3;
      c = c.replace(/^([ \t]*)/g, '');	// leading whitespace
      c = c.replace(/[ \t]*$/g, '');	// trailing whitespace
      c = showdown.subParser('encodeCode')(c, options, globals);
      c = m1 + '<code>' + c + '</code>';
      c = showdown.subParser('hashHTMLSpans')(c, options, globals);
      return c;
    }
  );

  text = globals.converter._dispatch('codeSpans.after', text, options, globals);
  return text;
});

/**
 * Create a full HTML document from the processed markdown
 */
showdown.subParser('completeHTMLDocument', function (text, options, globals) {
  'use strict';

  if (!options.completeHTMLDocument) {
    return text;
  }

  text = globals.converter._dispatch('completeHTMLDocument.before', text, options, globals);

  var doctype = 'html',
      doctypeParsed = '<!DOCTYPE HTML>\n',
      title = '',
      charset = '<meta charset="utf-8">\n',
      lang = '',
      metadata = '';

  if (typeof globals.metadata.parsed.doctype !== 'undefined') {
    doctypeParsed = '<!DOCTYPE ' +  globals.metadata.parsed.doctype + '>\n';
    doctype = globals.metadata.parsed.doctype.toString().toLowerCase();
    if (doctype === 'html' || doctype === 'html5') {
      charset = '<meta charset="utf-8">';
    }
  }

  for (var meta in globals.metadata.parsed) {
    if (globals.metadata.parsed.hasOwnProperty(meta)) {
      switch (meta.toLowerCase()) {
        case 'doctype':
          break;

        case 'title':
          title = '<title>' +  globals.metadata.parsed.title + '</title>\n';
          break;

        case 'charset':
          if (doctype === 'html' || doctype === 'html5') {
            charset = '<meta charset="' + globals.metadata.parsed.charset + '">\n';
          } else {
            charset = '<meta name="charset" content="' + globals.metadata.parsed.charset + '">\n';
          }
          break;

        case 'language':
        case 'lang':
          lang = ' lang="' + globals.metadata.parsed[meta] + '"';
          metadata += '<meta name="' + meta + '" content="' + globals.metadata.parsed[meta] + '">\n';
          break;

        default:
          metadata += '<meta name="' + meta + '" content="' + globals.metadata.parsed[meta] + '">\n';
      }
    }
  }

  text = doctypeParsed + '<html' + lang + '>\n<head>\n' + title + charset + metadata + '</head>\n<body>\n' + text.trim() + '\n</body>\n</html>';

  text = globals.converter._dispatch('completeHTMLDocument.after', text, options, globals);
  return text;
});

/**
 * Convert all tabs to spaces
 */
showdown.subParser('detab', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('detab.before', text, options, globals);

  // expand first n-1 tabs
  text = text.replace(/\t(?=\t)/g, '    '); // g_tab_width

  // replace the nth with two sentinels
  text = text.replace(/\t/g, '¨A¨B');

  // use the sentinel to anchor our regex so it doesn't explode
  text = text.replace(/¨B(.+?)¨A/g, function (wholeMatch, m1) {
    var leadingText = m1,
        numSpaces = 4 - leadingText.length % 4;  // g_tab_width

    // there *must* be a better way to do this:
    for (var i = 0; i < numSpaces; i++) {
      leadingText += ' ';
    }

    return leadingText;
  });

  // clean up sentinels
  text = text.replace(/¨A/g, '    ');  // g_tab_width
  text = text.replace(/¨B/g, '');

  text = globals.converter._dispatch('detab.after', text, options, globals);
  return text;
});

showdown.subParser('ellipsis', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('ellipsis.before', text, options, globals);

  text = text.replace(/\.\.\./g, '…');

  text = globals.converter._dispatch('ellipsis.after', text, options, globals);

  return text;
});

/**
 * Turn emoji codes into emojis
 *
 * List of supported emojis: https://github.com/showdownjs/showdown/wiki/Emojis
 */
showdown.subParser('emoji', function (text, options, globals) {
  'use strict';

  if (!options.emoji) {
    return text;
  }

  text = globals.converter._dispatch('emoji.before', text, options, globals);

  var emojiRgx = /:([\S]+?):/g;

  text = text.replace(emojiRgx, function (wm, emojiCode) {
    if (showdown.helper.emojis.hasOwnProperty(emojiCode)) {
      return showdown.helper.emojis[emojiCode];
    }
    return wm;
  });

  text = globals.converter._dispatch('emoji.after', text, options, globals);

  return text;
});

/**
 * Smart processing for ampersands and angle brackets that need to be encoded.
 */
showdown.subParser('encodeAmpsAndAngles', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('encodeAmpsAndAngles.before', text, options, globals);

  // Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:
  // http://bumppo.net/projects/amputator/
  text = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g, '&amp;');

  // Encode naked <'s
  text = text.replace(/<(?![a-z\/?$!])/gi, '&lt;');

  // Encode <
  text = text.replace(/</g, '&lt;');

  // Encode >
  text = text.replace(/>/g, '&gt;');

  text = globals.converter._dispatch('encodeAmpsAndAngles.after', text, options, globals);
  return text;
});

/**
 * Returns the string, with after processing the following backslash escape sequences.
 *
 * attacklab: The polite way to do this is with the new escapeCharacters() function:
 *
 *    text = escapeCharacters(text,"\\",true);
 *    text = escapeCharacters(text,"`*_{}[]()>#+-.!",true);
 *
 * ...but we're sidestepping its use of the (slow) RegExp constructor
 * as an optimization for Firefox.  This function gets called a LOT.
 */
showdown.subParser('encodeBackslashEscapes', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('encodeBackslashEscapes.before', text, options, globals);

  text = text.replace(/\\(\\)/g, showdown.helper.escapeCharactersCallback);
  text = text.replace(/\\([`*_{}\[\]()>#+.!~=|-])/g, showdown.helper.escapeCharactersCallback);

  text = globals.converter._dispatch('encodeBackslashEscapes.after', text, options, globals);
  return text;
});

/**
 * Encode/escape certain characters inside Markdown code runs.
 * The point is that in code, these characters are literals,
 * and lose their special Markdown meanings.
 */
showdown.subParser('encodeCode', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('encodeCode.before', text, options, globals);

  // Encode all ampersands; HTML entities are not
  // entities within a Markdown code span.
  text = text
    .replace(/&/g, '&amp;')
  // Do the angle bracket song and dance:
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
  // Now, escape characters that are magic in Markdown:
    .replace(/([*_{}\[\]\\=~-])/g, showdown.helper.escapeCharactersCallback);

  text = globals.converter._dispatch('encodeCode.after', text, options, globals);
  return text;
});

/**
 * Within tags -- meaning between < and > -- encode [\ ` * _ ~ =] so they
 * don't conflict with their use in Markdown for code, italics and strong.
 */
showdown.subParser('escapeSpecialCharsWithinTagAttributes', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('escapeSpecialCharsWithinTagAttributes.before', text, options, globals);

  // Build a regex to find HTML tags.
  var tags     = /<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,
      comments = /<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;

  text = text.replace(tags, function (wholeMatch) {
    return wholeMatch
      .replace(/(.)<\/?code>(?=.)/g, '$1`')
      .replace(/([\\`*_~=|])/g, showdown.helper.escapeCharactersCallback);
  });

  text = text.replace(comments, function (wholeMatch) {
    return wholeMatch
      .replace(/([\\`*_~=|])/g, showdown.helper.escapeCharactersCallback);
  });

  text = globals.converter._dispatch('escapeSpecialCharsWithinTagAttributes.after', text, options, globals);
  return text;
});

/**
 * Handle github codeblocks prior to running HashHTML so that
 * HTML contained within the codeblock gets escaped properly
 * Example:
 * ```ruby
 *     def hello_world(x)
 *       puts "Hello, #{x}"
 *     end
 * ```
 */
showdown.subParser('githubCodeBlocks', function (text, options, globals) {
  'use strict';

  // early exit if option is not enabled
  if (!options.ghCodeBlocks) {
    return text;
  }

  text = globals.converter._dispatch('githubCodeBlocks.before', text, options, globals);

  text += '¨0';

  text = text.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g, function (wholeMatch, delim, language, codeblock) {
    var end = (options.omitExtraWLInCodeBlocks) ? '' : '\n';

    // First parse the github code block
    codeblock = showdown.subParser('encodeCode')(codeblock, options, globals);
    codeblock = showdown.subParser('detab')(codeblock, options, globals);
    codeblock = codeblock.replace(/^\n+/g, ''); // trim leading newlines
    codeblock = codeblock.replace(/\n+$/g, ''); // trim trailing whitespace

    codeblock = '<pre><code' + (language ? ' class="' + language + ' language-' + language + '"' : '') + '>' + codeblock + end + '</code></pre>';

    codeblock = showdown.subParser('hashBlock')(codeblock, options, globals);

    // Since GHCodeblocks can be false positives, we need to
    // store the primitive text and the parsed text in a global var,
    // and then return a token
    return '\n\n¨G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\n\n';
  });

  // attacklab: strip sentinel
  text = text.replace(/¨0/, '');

  return globals.converter._dispatch('githubCodeBlocks.after', text, options, globals);
});

showdown.subParser('hashBlock', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('hashBlock.before', text, options, globals);
  text = text.replace(/(^\n+|\n+$)/g, '');
  text = '\n\n¨K' + (globals.gHtmlBlocks.push(text) - 1) + 'K\n\n';
  text = globals.converter._dispatch('hashBlock.after', text, options, globals);
  return text;
});

/**
 * Hash and escape <code> elements that should not be parsed as markdown
 */
showdown.subParser('hashCodeTags', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('hashCodeTags.before', text, options, globals);

  var repFunc = function (wholeMatch, match, left, right) {
    var codeblock = left + showdown.subParser('encodeCode')(match, options, globals) + right;
    return '¨C' + (globals.gHtmlSpans.push(codeblock) - 1) + 'C';
  };

  // Hash naked <code>
  text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '<code\\b[^>]*>', '</code>', 'gim');

  text = globals.converter._dispatch('hashCodeTags.after', text, options, globals);
  return text;
});

showdown.subParser('hashElement', function (text, options, globals) {
  'use strict';

  return function (wholeMatch, m1) {
    var blockText = m1;

    // Undo double lines
    blockText = blockText.replace(/\n\n/g, '\n');
    blockText = blockText.replace(/^\n/, '');

    // strip trailing blank lines
    blockText = blockText.replace(/\n+$/g, '');

    // Replace the element text with a marker ("¨KxK" where x is its key)
    blockText = '\n\n¨K' + (globals.gHtmlBlocks.push(blockText) - 1) + 'K\n\n';

    return blockText;
  };
});

showdown.subParser('hashHTMLBlocks', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('hashHTMLBlocks.before', text, options, globals);

  var blockTags = [
        'pre',
        'div',
        'h1',
        'h2',
        'h3',
        'h4',
        'h5',
        'h6',
        'blockquote',
        'table',
        'dl',
        'ol',
        'ul',
        'script',
        'noscript',
        'form',
        'fieldset',
        'iframe',
        'math',
        'style',
        'section',
        'header',
        'footer',
        'nav',
        'article',
        'aside',
        'address',
        'audio',
        'canvas',
        'figure',
        'hgroup',
        'output',
        'video',
        'p'
      ],
      repFunc = function (wholeMatch, match, left, right) {
        var txt = wholeMatch;
        // check if this html element is marked as markdown
        // if so, it's contents should be parsed as markdown
        if (left.search(/\bmarkdown\b/) !== -1) {
          txt = left + globals.converter.makeHtml(match) + right;
        }
        return '\n\n¨K' + (globals.gHtmlBlocks.push(txt) - 1) + 'K\n\n';
      };

  if (options.backslashEscapesHTMLTags) {
    // encode backslash escaped HTML tags
    text = text.replace(/\\<(\/?[^>]+?)>/g, function (wm, inside) {
      return '&lt;' + inside + '&gt;';
    });
  }

  // hash HTML Blocks
  for (var i = 0; i < blockTags.length; ++i) {

    var opTagPos,
        rgx1     = new RegExp('^ {0,3}(<' + blockTags[i] + '\\b[^>]*>)', 'im'),
        patLeft  = '<' + blockTags[i] + '\\b[^>]*>',
        patRight = '</' + blockTags[i] + '>';
    // 1. Look for the first position of the first opening HTML tag in the text
    while ((opTagPos = showdown.helper.regexIndexOf(text, rgx1)) !== -1) {

      // if the HTML tag is \ escaped, we need to escape it and break


      //2. Split the text in that position
      var subTexts = showdown.helper.splitAtIndex(text, opTagPos),
          //3. Match recursively
          newSubText1 = showdown.helper.replaceRecursiveRegExp(subTexts[1], repFunc, patLeft, patRight, 'im');

      // prevent an infinite loop
      if (newSubText1 === subTexts[1]) {
        break;
      }
      text = subTexts[0].concat(newSubText1);
    }
  }
  // HR SPECIAL CASE
  text = text.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,
    showdown.subParser('hashElement')(text, options, globals));

  // Special case for standalone HTML comments
  text = showdown.helper.replaceRecursiveRegExp(text, function (txt) {
    return '\n\n¨K' + (globals.gHtmlBlocks.push(txt) - 1) + 'K\n\n';
  }, '^ {0,3}<!--', '-->', 'gm');

  // PHP and ASP-style processor instructions (<?...?> and <%...%>)
  text = text.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,
    showdown.subParser('hashElement')(text, options, globals));

  text = globals.converter._dispatch('hashHTMLBlocks.after', text, options, globals);
  return text;
});

/**
 * Hash span elements that should not be parsed as markdown
 */
showdown.subParser('hashHTMLSpans', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('hashHTMLSpans.before', text, options, globals);

  function hashHTMLSpan (html) {
    return '¨C' + (globals.gHtmlSpans.push(html) - 1) + 'C';
  }

  // Hash Self Closing tags
  text = text.replace(/<[^>]+?\/>/gi, function (wm) {
    return hashHTMLSpan(wm);
  });

  // Hash tags without properties
  text = text.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g, function (wm) {
    return hashHTMLSpan(wm);
  });

  // Hash tags with properties
  text = text.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g, function (wm) {
    return hashHTMLSpan(wm);
  });

  // Hash self closing tags without />
  text = text.replace(/<[^>]+?>/gi, function (wm) {
    return hashHTMLSpan(wm);
  });

  /*showdown.helper.matchRecursiveRegExp(text, '<code\\b[^>]*>', '</code>', 'gi');*/

  text = globals.converter._dispatch('hashHTMLSpans.after', text, options, globals);
  return text;
});

/**
 * Unhash HTML spans
 */
showdown.subParser('unhashHTMLSpans', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('unhashHTMLSpans.before', text, options, globals);

  for (var i = 0; i < globals.gHtmlSpans.length; ++i) {
    var repText = globals.gHtmlSpans[i],
        // limiter to prevent infinite loop (assume 10 as limit for recurse)
        limit = 0;

    while (/¨C(\d+)C/.test(repText)) {
      var num = RegExp.$1;
      repText = repText.replace('¨C' + num + 'C', globals.gHtmlSpans[num]);
      if (limit === 10) {
        console.error('maximum nesting of 10 spans reached!!!');
        break;
      }
      ++limit;
    }
    text = text.replace('¨C' + i + 'C', repText);
  }

  text = globals.converter._dispatch('unhashHTMLSpans.after', text, options, globals);
  return text;
});

/**
 * Hash and escape <pre><code> elements that should not be parsed as markdown
 */
showdown.subParser('hashPreCodeTags', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('hashPreCodeTags.before', text, options, globals);

  var repFunc = function (wholeMatch, match, left, right) {
    // encode html entities
    var codeblock = left + showdown.subParser('encodeCode')(match, options, globals) + right;
    return '\n\n¨G' + (globals.ghCodeBlocks.push({text: wholeMatch, codeblock: codeblock}) - 1) + 'G\n\n';
  };

  // Hash <pre><code>
  text = showdown.helper.replaceRecursiveRegExp(text, repFunc, '^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>', '^ {0,3}</code>\\s*</pre>', 'gim');

  text = globals.converter._dispatch('hashPreCodeTags.after', text, options, globals);
  return text;
});

showdown.subParser('headers', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('headers.before', text, options, globals);

  var headerLevelStart = (isNaN(parseInt(options.headerLevelStart))) ? 1 : parseInt(options.headerLevelStart),

      // Set text-style headers:
      //	Header 1
      //	========
      //
      //	Header 2
      //	--------
      //
      setextRegexH1 = (options.smoothLivePreview) ? /^(.+)[ \t]*\n={2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n=+[ \t]*\n+/gm,
      setextRegexH2 = (options.smoothLivePreview) ? /^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm : /^(.+)[ \t]*\n-+[ \t]*\n+/gm;

  text = text.replace(setextRegexH1, function (wholeMatch, m1) {

    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),
        hID = (options.noHeaderId) ? '' : ' id="' + headerId(m1) + '"',
        hLevel = headerLevelStart,
        hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';
    return showdown.subParser('hashBlock')(hashBlock, options, globals);
  });

  text = text.replace(setextRegexH2, function (matchFound, m1) {
    var spanGamut = showdown.subParser('spanGamut')(m1, options, globals),
        hID = (options.noHeaderId) ? '' : ' id="' + headerId(m1) + '"',
        hLevel = headerLevelStart + 1,
        hashBlock = '<h' + hLevel + hID + '>' + spanGamut + '</h' + hLevel + '>';
    return showdown.subParser('hashBlock')(hashBlock, options, globals);
  });

  // atx-style headers:
  //  # Header 1
  //  ## Header 2
  //  ## Header 2 with closing hashes ##
  //  ...
  //  ###### Header 6
  //
  var atxStyle = (options.requireSpaceBeforeHeadingText) ? /^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm : /^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;

  text = text.replace(atxStyle, function (wholeMatch, m1, m2) {
    var hText = m2;
    if (options.customizedHeaderId) {
      hText = m2.replace(/\s?\{([^{]+?)}\s*$/, '');
    }

    var span = showdown.subParser('spanGamut')(hText, options, globals),
        hID = (options.noHeaderId) ? '' : ' id="' + headerId(m2) + '"',
        hLevel = headerLevelStart - 1 + m1.length,
        header = '<h' + hLevel + hID + '>' + span + '</h' + hLevel + '>';

    return showdown.subParser('hashBlock')(header, options, globals);
  });

  function headerId (m) {
    var title,
        prefix;

    // It is separate from other options to allow combining prefix and customized
    if (options.customizedHeaderId) {
      var match = m.match(/\{([^{]+?)}\s*$/);
      if (match && match[1]) {
        m = match[1];
      }
    }

    title = m;

    // Prefix id to prevent causing inadvertent pre-existing style matches.
    if (showdown.helper.isString(options.prefixHeaderId)) {
      prefix = options.prefixHeaderId;
    } else if (options.prefixHeaderId === true) {
      prefix = 'section-';
    } else {
      prefix = '';
    }

    if (!options.rawPrefixHeaderId) {
      title = prefix + title;
    }

    if (options.ghCompatibleHeaderId) {
      title = title
        .replace(/ /g, '-')
        // replace previously escaped chars (&, ¨ and $)
        .replace(/&amp;/g, '')
        .replace(/¨T/g, '')
        .replace(/¨D/g, '')
        // replace rest of the chars (&~$ are repeated as they might have been escaped)
        // borrowed from github's redcarpet (some they should produce similar results)
        .replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g, '')
        .toLowerCase();
    } else if (options.rawHeaderId) {
      title = title
        .replace(/ /g, '-')
        // replace previously escaped chars (&, ¨ and $)
        .replace(/&amp;/g, '&')
        .replace(/¨T/g, '¨')
        .replace(/¨D/g, '$')
        // replace " and '
        .replace(/["']/g, '-')
        .toLowerCase();
    } else {
      title = title
        .replace(/[^\w]/g, '')
        .toLowerCase();
    }

    if (options.rawPrefixHeaderId) {
      title = prefix + title;
    }

    if (globals.hashLinkCounts[title]) {
      title = title + '-' + (globals.hashLinkCounts[title]++);
    } else {
      globals.hashLinkCounts[title] = 1;
    }
    return title;
  }

  text = globals.converter._dispatch('headers.after', text, options, globals);
  return text;
});

/**
 * Turn Markdown link shortcuts into XHTML <a> tags.
 */
showdown.subParser('horizontalRule', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('horizontalRule.before', text, options, globals);

  var key = showdown.subParser('hashBlock')('<hr />', options, globals);
  text = text.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm, key);
  text = text.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm, key);
  text = text.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm, key);

  text = globals.converter._dispatch('horizontalRule.after', text, options, globals);
  return text;
});

/**
 * Turn Markdown image shortcuts into <img> tags.
 */
showdown.subParser('images', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('images.before', text, options, globals);

  var inlineRegExp      = /!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,
      crazyRegExp       = /!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,
      base64RegExp      = /!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,
      referenceRegExp   = /!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,
      refShortcutRegExp = /!\[([^\[\]]+)]()()()()()/g;

  function writeImageTagBase64 (wholeMatch, altText, linkId, url, width, height, m5, title) {
    url = url.replace(/\s/g, '');
    return writeImageTag (wholeMatch, altText, linkId, url, width, height, m5, title);
  }

  function writeImageTag (wholeMatch, altText, linkId, url, width, height, m5, title) {

    var gUrls   = globals.gUrls,
        gTitles = globals.gTitles,
        gDims   = globals.gDimensions;

    linkId = linkId.toLowerCase();

    if (!title) {
      title = '';
    }
    // Special case for explicit empty url
    if (wholeMatch.search(/\(<?\s*>? ?(['"].*['"])?\)$/m) > -1) {
      url = '';

    } else if (url === '' || url === null) {
      if (linkId === '' || linkId === null) {
        // lower-case and turn embedded newlines into spaces
        linkId = altText.toLowerCase().replace(/ ?\n/g, ' ');
      }
      url = '#' + linkId;

      if (!showdown.helper.isUndefined(gUrls[linkId])) {
        url = gUrls[linkId];
        if (!showdown.helper.isUndefined(gTitles[linkId])) {
          title = gTitles[linkId];
        }
        if (!showdown.helper.isUndefined(gDims[linkId])) {
          width = gDims[linkId].width;
          height = gDims[linkId].height;
        }
      } else {
        return wholeMatch;
      }
    }

    altText = altText
      .replace(/"/g, '&quot;')
    //altText = showdown.helper.escapeCharacters(altText, '*_', false);
      .replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);
    //url = showdown.helper.escapeCharacters(url, '*_', false);
    url = url.replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);
    var result = '<img src="' + url + '" alt="' + altText + '"';

    if (title && showdown.helper.isString(title)) {
      title = title
        .replace(/"/g, '&quot;')
      //title = showdown.helper.escapeCharacters(title, '*_', false);
        .replace(showdown.helper.regexes.asteriskDashAndColon, showdown.helper.escapeCharactersCallback);
      result += ' title="' + title + '"';
    }

    if (width && height) {
      width  = (width === '*') ? 'auto' : width;
      height = (height === '*') ? 'auto' : height;

      result += ' width="' + width + '"';
      result += ' height="' + height + '"';
    }

    result += ' />';

    return result;
  }

  // First, handle reference-style labeled images: ![alt text][id]
  text = text.replace(referenceRegExp, writeImageTag);

  // Next, handle inline images:  ![alt text](url =<width>x<height> "optional title")

  // base64 encoded images
  text = text.replace(base64RegExp, writeImageTagBase64);

  // cases with crazy urls like ./image/cat1).png
  text = text.replace(crazyRegExp, writeImageTag);

  // normal cases
  text = text.replace(inlineRegExp, writeImageTag);

  // handle reference-style shortcuts: ![img text]
  text = text.replace(refShortcutRegExp, writeImageTag);

  text = globals.converter._dispatch('images.after', text, options, globals);
  return text;
});

showdown.subParser('italicsAndBold', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('italicsAndBold.before', text, options, globals);

  // it's faster to have 3 separate regexes for each case than have just one
  // because of backtracing, in some cases, it could lead to an exponential effect
  // called "catastrophic backtrace". Ominous!

  function parseInside (txt, left, right) {
    /*
    if (options.simplifiedAutoLink) {
      txt = showdown.subParser('simplifiedAutoLinks')(txt, options, globals);
    }
    */
    return left + txt + right;
  }

  // Parse underscores
  if (options.literalMidWordUnderscores) {
    text = text.replace(/\b___(\S[\s\S]*?)___\b/g, function (wm, txt) {
      return parseInside (txt, '<strong><em>', '</em></strong>');
    });
    text = text.replace(/\b__(\S[\s\S]*?)__\b/g, function (wm, txt) {
      return parseInside (txt, '<strong>', '</strong>');
    });
    text = text.replace(/\b_(\S[\s\S]*?)_\b/g, function (wm, txt) {
      return parseInside (txt, '<em>', '</em>');
    });
  } else {
    text = text.replace(/___(\S[\s\S]*?)___/g, function (wm, m) {
      return (/\S$/.test(m)) ? parseInside (m, '<strong><em>', '</em></strong>') : wm;
    });
    text = text.replace(/__(\S[\s\S]*?)__/g, function (wm, m) {
      return (/\S$/.test(m)) ? parseInside (m, '<strong>', '</strong>') : wm;
    });
    text = text.replace(/_([^\s_][\s\S]*?)_/g, function (wm, m) {
      // !/^_[^_]/.test(m) - test if it doesn't start with __ (since it seems redundant, we removed it)
      return (/\S$/.test(m)) ? parseInside (m, '<em>', '</em>') : wm;
    });
  }

  // Now parse asterisks
  if (options.literalMidWordAsterisks) {
    text = text.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g, function (wm, lead, txt) {
      return parseInside (txt, lead + '<strong><em>', '</em></strong>');
    });
    text = text.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g, function (wm, lead, txt) {
      return parseInside (txt, lead + '<strong>', '</strong>');
    });
    text = text.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g, function (wm, lead, txt) {
      return parseInside (txt, lead + '<em>', '</em>');
    });
  } else {
    text = text.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g, function (wm, m) {
      return (/\S$/.test(m)) ? parseInside (m, '<strong><em>', '</em></strong>') : wm;
    });
    text = text.replace(/\*\*(\S[\s\S]*?)\*\*/g, function (wm, m) {
      return (/\S$/.test(m)) ? parseInside (m, '<strong>', '</strong>') : wm;
    });
    text = text.replace(/\*([^\s*][\s\S]*?)\*/g, function (wm, m) {
      // !/^\*[^*]/.test(m) - test if it doesn't start with ** (since it seems redundant, we removed it)
      return (/\S$/.test(m)) ? parseInside (m, '<em>', '</em>') : wm;
    });
  }


  text = globals.converter._dispatch('italicsAndBold.after', text, options, globals);
  return text;
});

/**
 * Form HTML ordered (numbered) and unordered (bulleted) lists.
 */
showdown.subParser('lists', function (text, options, globals) {
  'use strict';

  /**
   * Process the contents of a single ordered or unordered list, splitting it
   * into individual list items.
   * @param {string} listStr
   * @param {boolean} trimTrailing
   * @returns {string}
   */
  function processListItems (listStr, trimTrailing) {
    // The $g_list_level global keeps track of when we're inside a list.
    // Each time we enter a list, we increment it; when we leave a list,
    // we decrement. If it's zero, we're not in a list anymore.
    //
    // We do this because when we're not inside a list, we want to treat
    // something like this:
    //
    //    I recommend upgrading to version
    //    8. Oops, now this line is treated
    //    as a sub-list.
    //
    // As a single paragraph, despite the fact that the second line starts
    // with a digit-period-space sequence.
    //
    // Whereas when we're inside a list (or sub-list), that line will be
    // treated as the start of a sub-list. What a kludge, huh? This is
    // an aspect of Markdown's syntax that's hard to parse perfectly
    // without resorting to mind-reading. Perhaps the solution is to
    // change the syntax rules such that sub-lists must start with a
    // starting cardinal number; e.g. "1." or "a.".
    globals.gListLevel++;

    // trim trailing blank lines:
    listStr = listStr.replace(/\n{2,}$/, '\n');

    // attacklab: add sentinel to emulate \z
    listStr += '¨0';

    var rgx = /(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,
        isParagraphed = (/\n[ \t]*\n(?!¨0)/.test(listStr));

    // Since version 1.5, nesting sublists requires 4 spaces (or 1 tab) indentation,
    // which is a syntax breaking change
    // activating this option reverts to old behavior
    if (options.disableForced4SpacesIndentedSublists) {
      rgx = /(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm;
    }

    listStr = listStr.replace(rgx, function (wholeMatch, m1, m2, m3, m4, taskbtn, checked) {
      checked = (checked && checked.trim() !== '');

      var item = showdown.subParser('outdent')(m4, options, globals),
          bulletStyle = '';

      // Support for github tasklists
      if (taskbtn && options.tasklists) {
        bulletStyle = ' class="task-list-item" style="list-style-type: none;"';
        item = item.replace(/^[ \t]*\[(x|X| )?]/m, function () {
          var otp = '<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';
          if (checked) {
            otp += ' checked';
          }
          otp += '>';
          return otp;
        });
      }

      // ISSUE #312
      // This input: - - - a
      // causes trouble to the parser, since it interprets it as:
      // <ul><li><li><li>a</li></li></li></ul>
      // instead of:
      // <ul><li>- - a</li></ul>
      // So, to prevent it, we will put a marker (¨A)in the beginning of the line
      // Kind of hackish/monkey patching, but seems more effective than overcomplicating the list parser
      item = item.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g, function (wm2) {
        return '¨A' + wm2;
      });

      // m1 - Leading line or
      // Has a double return (multi paragraph) or
      // Has sublist
      if (m1 || (item.search(/\n{2,}/) > -1)) {
        item = showdown.subParser('githubCodeBlocks')(item, options, globals);
        item = showdown.subParser('blockGamut')(item, options, globals);
      } else {
        // Recursion for sub-lists:
        item = showdown.subParser('lists')(item, options, globals);
        item = item.replace(/\n$/, ''); // chomp(item)
        item = showdown.subParser('hashHTMLBlocks')(item, options, globals);

        // Colapse double linebreaks
        item = item.replace(/\n\n+/g, '\n\n');
        if (isParagraphed) {
          item = showdown.subParser('paragraphs')(item, options, globals);
        } else {
          item = showdown.subParser('spanGamut')(item, options, globals);
        }
      }

      // now we need to remove the marker (¨A)
      item = item.replace('¨A', '');
      // we can finally wrap the line in list item tags
      item =  '<li' + bulletStyle + '>' + item + '</li>\n';

      return item;
    });

    // attacklab: strip sentinel
    listStr = listStr.replace(/¨0/g, '');

    globals.gListLevel--;

    if (trimTrailing) {
      listStr = listStr.replace(/\s+$/, '');
    }

    return listStr;
  }

  function styleStartNumber (list, listType) {
    // check if ol and starts by a number different than 1
    if (listType === 'ol') {
      var res = list.match(/^ *(\d+)\./);
      if (res && res[1] !== '1') {
        return ' start="' + res[1] + '"';
      }
    }
    return '';
  }

  /**
   * Check and parse consecutive lists (better fix for issue #142)
   * @param {string} list
   * @param {string} listType
   * @param {boolean} trimTrailing
   * @returns {string}
   */
  function parseConsecutiveLists (list, listType, trimTrailing) {
    // check if we caught 2 or more consecutive lists by mistake
    // we use the counterRgx, meaning if listType is UL we look for OL and vice versa
    var olRgx = (options.disableForced4SpacesIndentedSublists) ? /^ ?\d+\.[ \t]/gm : /^ {0,3}\d+\.[ \t]/gm,
        ulRgx = (options.disableForced4SpacesIndentedSublists) ? /^ ?[*+-][ \t]/gm : /^ {0,3}[*+-][ \t]/gm,
        counterRxg = (listType === 'ul') ? olRgx : ulRgx,
        result = '';

    if (list.search(counterRxg) !== -1) {
      (function parseCL (txt) {
        var pos = txt.search(counterRxg),
            style = styleStartNumber(list, listType);
        if (pos !== -1) {
          // slice
          result += '\n\n<' + listType + style + '>\n' + processListItems(txt.slice(0, pos), !!trimTrailing) + '</' + listType + '>\n';

          // invert counterType and listType
          listType = (listType === 'ul') ? 'ol' : 'ul';
          counterRxg = (listType === 'ul') ? olRgx : ulRgx;

          //recurse
          parseCL(txt.slice(pos));
        } else {
          result += '\n\n<' + listType + style + '>\n' + processListItems(txt, !!trimTrailing) + '</' + listType + '>\n';
        }
      })(list);
    } else {
      var style = styleStartNumber(list, listType);
      result = '\n\n<' + listType + style + '>\n' + processListItems(list, !!trimTrailing) + '</' + listType + '>\n';
    }

    return result;
  }

  /** Start of list parsing **/
  text = globals.converter._dispatch('lists.before', text, options, globals);
  // add sentinel to hack around khtml/safari bug:
  // http://bugs.webkit.org/show_bug.cgi?id=11231
  text += '¨0';

  if (globals.gListLevel) {
    text = text.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,
      function (wholeMatch, list, m2) {
        var listType = (m2.search(/[*+-]/g) > -1) ? 'ul' : 'ol';
        return parseConsecutiveLists(list, listType, true);
      }
    );
  } else {
    text = text.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,
      function (wholeMatch, m1, list, m3) {
        var listType = (m3.search(/[*+-]/g) > -1) ? 'ul' : 'ol';
        return parseConsecutiveLists(list, listType, false);
      }
    );
  }

  // strip sentinel
  text = text.replace(/¨0/, '');
  text = globals.converter._dispatch('lists.after', text, options, globals);
  return text;
});

/**
 * Parse metadata at the top of the document
 */
showdown.subParser('metadata', function (text, options, globals) {
  'use strict';

  if (!options.metadata) {
    return text;
  }

  text = globals.converter._dispatch('metadata.before', text, options, globals);

  function parseMetadataContents (content) {
    // raw is raw so it's not changed in any way
    globals.metadata.raw = content;

    // escape chars forbidden in html attributes
    // double quotes
    content = content
      // ampersand first
      .replace(/&/g, '&amp;')
      // double quotes
      .replace(/"/g, '&quot;');

    content = content.replace(/\n {4}/g, ' ');
    content.replace(/^([\S ]+): +([\s\S]+?)$/gm, function (wm, key, value) {
      globals.metadata.parsed[key] = value;
      return '';
    });
  }

  text = text.replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/, function (wholematch, format, content) {
    parseMetadataContents(content);
    return '¨M';
  });

  text = text.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/, function (wholematch, format, content) {
    if (format) {
      globals.metadata.format = format;
    }
    parseMetadataContents(content);
    return '¨M';
  });

  text = text.replace(/¨M/g, '');

  text = globals.converter._dispatch('metadata.after', text, options, globals);
  return text;
});

/**
 * Remove one level of line-leading tabs or spaces
 */
showdown.subParser('outdent', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('outdent.before', text, options, globals);

  // attacklab: hack around Konqueror 3.5.4 bug:
  // "----------bug".replace(/^-/g,"") == "bug"
  text = text.replace(/^(\t|[ ]{1,4})/gm, '¨0'); // attacklab: g_tab_width

  // attacklab: clean up hack
  text = text.replace(/¨0/g, '');

  text = globals.converter._dispatch('outdent.after', text, options, globals);
  return text;
});

/**
 *
 */
showdown.subParser('paragraphs', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('paragraphs.before', text, options, globals);
  // Strip leading and trailing lines:
  text = text.replace(/^\n+/g, '');
  text = text.replace(/\n+$/g, '');

  var grafs = text.split(/\n{2,}/g),
      grafsOut = [],
      end = grafs.length; // Wrap <p> tags

  for (var i = 0; i < end; i++) {
    var str = grafs[i];
    // if this is an HTML marker, copy it
    if (str.search(/¨(K|G)(\d+)\1/g) >= 0) {
      grafsOut.push(str);

    // test for presence of characters to prevent empty lines being parsed
    // as paragraphs (resulting in undesired extra empty paragraphs)
    } else if (str.search(/\S/) >= 0) {
      str = showdown.subParser('spanGamut')(str, options, globals);
      str = str.replace(/^([ \t]*)/g, '<p>');
      str += '</p>';
      grafsOut.push(str);
    }
  }

  /** Unhashify HTML blocks */
  end = grafsOut.length;
  for (i = 0; i < end; i++) {
    var blockText = '',
        grafsOutIt = grafsOut[i],
        codeFlag = false;
    // if this is a marker for an html block...
    // use RegExp.test instead of string.search because of QML bug
    while (/¨(K|G)(\d+)\1/.test(grafsOutIt)) {
      var delim = RegExp.$1,
          num   = RegExp.$2;

      if (delim === 'K') {
        blockText = globals.gHtmlBlocks[num];
      } else {
        // we need to check if ghBlock is a false positive
        if (codeFlag) {
          // use encoded version of all text
          blockText = showdown.subParser('encodeCode')(globals.ghCodeBlocks[num].text, options, globals);
        } else {
          blockText = globals.ghCodeBlocks[num].codeblock;
        }
      }
      blockText = blockText.replace(/\$/g, '$$$$'); // Escape any dollar signs

      grafsOutIt = grafsOutIt.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/, blockText);
      // Check if grafsOutIt is a pre->code
      if (/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(grafsOutIt)) {
        codeFlag = true;
      }
    }
    grafsOut[i] = grafsOutIt;
  }
  text = grafsOut.join('\n');
  // Strip leading and trailing lines:
  text = text.replace(/^\n+/g, '');
  text = text.replace(/\n+$/g, '');
  return globals.converter._dispatch('paragraphs.after', text, options, globals);
});

/**
 * Run extension
 */
showdown.subParser('runExtension', function (ext, text, options, globals) {
  'use strict';

  if (ext.filter) {
    text = ext.filter(text, globals.converter, options);

  } else if (ext.regex) {
    // TODO remove this when old extension loading mechanism is deprecated
    var re = ext.regex;
    if (!(re instanceof RegExp)) {
      re = new RegExp(re, 'g');
    }
    text = text.replace(re, ext.replace);
  }

  return text;
});

/**
 * These are all the transformations that occur *within* block-level
 * tags like paragraphs, headers, and list items.
 */
showdown.subParser('spanGamut', function (text, options, globals) {
  'use strict';

  text = globals.converter._dispatch('spanGamut.before', text, options, globals);
  text = showdown.subParser('codeSpans')(text, options, globals);
  text = showdown.subParser('escapeSpecialCharsWithinTagAttributes')(text, options, globals);
  text = showdown.subParser('encodeBackslashEscapes')(text, options, globals);

  // Process anchor and image tags. Images must come first,
  // because ![foo][f] looks like an anchor.
  text = showdown.subParser('images')(text, options, globals);
  text = showdown.subParser('anchors')(text, options, globals);

  // Make links out of things like `<http://example.com/>`
  // Must come after anchors, because you can use < and >
  // delimiters in inline links like [this](<url>).
  text = showdown.subParser('autoLinks')(text, options, globals);
  text = showdown.subParser('simplifiedAutoLinks')(text, options, globals);
  text = showdown.subParser('emoji')(text, options, globals);
  text = showdown.subParser('underline')(text, options, globals);
  text = showdown.subParser('italicsAndBold')(text, options, globals);
  text = showdown.subParser('strikethrough')(text, options, globals);
  text = showdown.subParser('ellipsis')(text, options, globals);

  // we need to hash HTML tags inside spans
  text = showdown.subParser('hashHTMLSpans')(text, options, globals);

  // now we encode amps and angles
  text = showdown.subParser('encodeAmpsAndAngles')(text, options, globals);

  // Do hard breaks
  if (options.simpleLineBreaks) {
    // GFM style hard breaks
    // only add line breaks if the text does not contain a block (special case for lists)
    if (!/\n\n¨K/.test(text)) {
      text = text.replace(/\n+/g, '<br />\n');
    }
  } else {
    // Vanilla hard breaks
    text = text.replace(/  +\n/g, '<br />\n');
  }

  text = globals.converter._dispatch('spanGamut.after', text, options, globals);
  return text;
});

showdown.subParser('strikethrough', function (text, options, globals) {
  'use strict';

  function parseInside (txt) {
    if (options.simplifiedAutoLink) {
      txt = showdown.subParser('simplifiedAutoLinks')(txt, options, globals);
    }
    return '<del>' + txt + '</del>';
  }

  if (options.strikethrough) {
    text = globals.converter._dispatch('strikethrough.before', text, options, globals);
    text = text.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g, function (wm, txt) { return parseInside(txt); });
    text = globals.converter._dispatch('strikethrough.after', text, options, globals);
  }

  return text;
});

/**
 * Strips link definitions from text, stores the URLs and titles in
 * hash references.
 * Link defs are in the form: ^[id]: url "optional title"
 */
showdown.subParser('stripLinkDefinitions', function (text, options, globals) {
  'use strict';

  var regex       = /^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,
      base64Regex = /^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm;

  // attacklab: sentinel workarounds for lack of \A and \Z, safari\khtml bug
  text += '¨0';

  var replaceFunc = function (wholeMatch, linkId, url, width, height, blankLines, title) {
    linkId = linkId.toLowerCase();
    if (url.match(/^data:.+?\/.+?;base64,/)) {
      // remove newlines
      globals.gUrls[linkId] = url.replace(/\s/g, '');
    } else {
      globals.gUrls[linkId] = showdown.subParser('encodeAmpsAndAngles')(url, options, globals);  // Link IDs are case-insensitive
    }

    if (blankLines) {
      // Oops, found blank lines, so it's not a title.
      // Put back the parenthetical statement we stole.
      return blankLines + title;

    } else {
      if (title) {
        globals.gTitles[linkId] = title.replace(/"|'/g, '&quot;');
      }
      if (options.parseImgDimensions && width && height) {
        globals.gDimensions[linkId] = {
          width:  width,
          height: height
        };
      }
    }
    // Completely remove the definition from the text
    return '';
  };

  // first we try to find base64 link references
  text = text.replace(base64Regex, replaceFunc);

  text = text.replace(regex, replaceFunc);

  // attacklab: strip sentinel
  text = text.replace(/¨0/, '');

  return text;
});

showdown.subParser('tables', function (text, options, globals) {
  'use strict';

  if (!options.tables) {
    return text;
  }

  var tableRgx       = /^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,
      //singeColTblRgx = /^ {0,3}\|.+\|\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n(?: {0,3}\|.+\|\n)+(?:\n\n|¨0)/gm;
      singeColTblRgx = /^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm;

  function parseStyles (sLine) {
    if (/^:[ \t]*--*$/.test(sLine)) {
      return ' style="text-align:left;"';
    } else if (/^--*[ \t]*:[ \t]*$/.test(sLine)) {
      return ' style="text-align:right;"';
    } else if (/^:[ \t]*--*[ \t]*:$/.test(sLine)) {
      return ' style="text-align:center;"';
    } else {
      return '';
    }
  }

  function parseHeaders (header, style) {
    var id = '';
    header = header.trim();
    // support both tablesHeaderId and tableHeaderId due to error in documentation so we don't break backwards compatibility
    if (options.tablesHeaderId || options.tableHeaderId) {
      id = ' id="' + header.replace(/ /g, '_').toLowerCase() + '"';
    }
    header = showdown.subParser('spanGamut')(header, options, globals);

    return '<th' + id + style + '>' + header + '</th>\n';
  }

  function parseCells (cell, style) {
    var subText = showdown.subParser('spanGamut')(cell, options, globals);
    return '<td' + style + '>' + subText + '</td>\n';
  }

  function buildTable (headers, cells) {
    var tb = '<table>\n<thead>\n<tr>\n',
        tblLgn = headers.length;

    for (var i = 0; i < tblLgn; ++i) {
      tb += headers[i];
    }
    tb += '</tr>\n</thead>\n<tbody>\n';

    for (i = 0; i < cells.length; ++i) {
      tb += '<tr>\n';
      for (var ii = 0; ii < tblLgn; ++ii) {
        tb += cells[i][ii];
      }
      tb += '</tr>\n';
    }
    tb += '</tbody>\n</table>\n';
    return tb;
  }

  function parseTable (rawTable) {
    var i, tableLines = rawTable.split('\n');

    for (i = 0; i < tableLines.length; ++i) {
      // strip wrong first and last column if wrapped tables are used
      if (/^ {0,3}\|/.test(tableLines[i])) {
        tableLines[i] = tableLines[i].replace(/^ {0,3}\|/, '');
      }
      if (/\|[ \t]*$/.test(tableLines[i])) {
        tableLines[i] = tableLines[i].replace(/\|[ \t]*$/, '');
      }
      // parse code spans first, but we only support one line code spans
      tableLines[i] = showdown.subParser('codeSpans')(tableLines[i], options, globals);
    }

    var rawHeaders = tableLines[0].split('|').map(function (s) { return s.trim();}),
        rawStyles = tableLines[1].split('|').map(function (s) { return s.trim();}),
        rawCells = [],
        headers = [],
        styles = [],
        cells = [];

    tableLines.shift();
    tableLines.shift();

    for (i = 0; i < tableLines.length; ++i) {
      if (tableLines[i].trim() === '') {
        continue;
      }
      rawCells.push(
        tableLines[i]
          .split('|')
          .map(function (s) {
            return s.trim();
          })
      );
    }

    if (rawHeaders.length < rawStyles.length) {
      return rawTable;
    }

    for (i = 0; i < rawStyles.length; ++i) {
      styles.push(parseStyles(rawStyles[i]));
    }

    for (i = 0; i < rawHeaders.length; ++i) {
      if (showdown.helper.isUndefined(styles[i])) {
        styles[i] = '';
      }
      headers.push(parseHeaders(rawHeaders[i], styles[i]));
    }

    for (i = 0; i < rawCells.length; ++i) {
      var row = [];
      for (var ii = 0; ii < headers.length; ++ii) {
        if (showdown.helper.isUndefined(rawCells[i][ii])) {

        }
        row.push(parseCells(rawCells[i][ii], styles[ii]));
      }
      cells.push(row);
    }

    return buildTable(headers, cells);
  }

  text = globals.converter._dispatch('tables.before', text, options, globals);

  // find escaped pipe characters
  text = text.replace(/\\(\|)/g, showdown.helper.escapeCharactersCallback);

  // parse multi column tables
  text = text.replace(tableRgx, parseTable);

  // parse one column tables
  text = text.replace(singeColTblRgx, parseTable);

  text = globals.converter._dispatch('tables.after', text, options, globals);

  return text;
});

showdown.subParser('underline', function (text, options, globals) {
  'use strict';

  if (!options.underline) {
    return text;
  }

  text = globals.converter._dispatch('underline.before', text, options, globals);

  if (options.literalMidWordUnderscores) {
    text = text.replace(/\b___(\S[\s\S]*?)___\b/g, function (wm, txt) {
      return '<u>' + txt + '</u>';
    });
    text = text.replace(/\b__(\S[\s\S]*?)__\b/g, function (wm, txt) {
      return '<u>' + txt + '</u>';
    });
  } else {
    text = text.replace(/___(\S[\s\S]*?)___/g, function (wm, m) {
      return (/\S$/.test(m)) ? '<u>' + m + '</u>' : wm;
    });
    text = text.replace(/__(\S[\s\S]*?)__/g, function (wm, m) {
      return (/\S$/.test(m)) ? '<u>' + m + '</u>' : wm;
    });
  }

  // escape remaining underscores to prevent them being parsed by italic and bold
  text = text.replace(/(_)/g, showdown.helper.escapeCharactersCallback);

  text = globals.converter._dispatch('underline.after', text, options, globals);

  return text;
});

/**
 * Swap back in all the special characters we've hidden.
 */
showdown.subParser('unescapeSpecialChars', function (text, options, globals) {
  'use strict';
  text = globals.converter._dispatch('unescapeSpecialChars.before', text, options, globals);

  text = text.replace(/¨E(\d+)E/g, function (wholeMatch, m1) {
    var charCodeToReplace = parseInt(m1);
    return String.fromCharCode(charCodeToReplace);
  });

  text = globals.converter._dispatch('unescapeSpecialChars.after', text, options, globals);
  return text;
});

showdown.subParser('makeMarkdown.blockquote', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes()) {
    var children = node.childNodes,
        childrenLength = children.length;

    for (var i = 0; i < childrenLength; ++i) {
      var innerTxt = showdown.subParser('makeMarkdown.node')(children[i], globals);

      if (innerTxt === '') {
        continue;
      }
      txt += innerTxt;
    }
  }
  // cleanup
  txt = txt.trim();
  txt = '> ' + txt.split('\n').join('\n> ');
  return txt;
});

showdown.subParser('makeMarkdown.codeBlock', function (node, globals) {
  'use strict';

  var lang = node.getAttribute('language'),
      num  = node.getAttribute('precodenum');
  return '```' + lang + '\n' + globals.preList[num] + '\n```';
});

showdown.subParser('makeMarkdown.codeSpan', function (node) {
  'use strict';

  return '`' + node.innerHTML + '`';
});

showdown.subParser('makeMarkdown.emphasis', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes()) {
    txt += '*';
    var children = node.childNodes,
        childrenLength = children.length;
    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
    txt += '*';
  }
  return txt;
});

showdown.subParser('makeMarkdown.header', function (node, globals, headerLevel) {
  'use strict';

  var headerMark = new Array(headerLevel + 1).join('#'),
      txt = '';

  if (node.hasChildNodes()) {
    txt = headerMark + ' ';
    var children = node.childNodes,
        childrenLength = children.length;

    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
  }
  return txt;
});

showdown.subParser('makeMarkdown.hr', function () {
  'use strict';

  return '---';
});

showdown.subParser('makeMarkdown.image', function (node) {
  'use strict';

  var txt = '';
  if (node.hasAttribute('src')) {
    txt += '![' + node.getAttribute('alt') + '](';
    txt += '<' + node.getAttribute('src') + '>';
    if (node.hasAttribute('width') && node.hasAttribute('height')) {
      txt += ' =' + node.getAttribute('width') + 'x' + node.getAttribute('height');
    }

    if (node.hasAttribute('title')) {
      txt += ' "' + node.getAttribute('title') + '"';
    }
    txt += ')';
  }
  return txt;
});

showdown.subParser('makeMarkdown.links', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes() && node.hasAttribute('href')) {
    var children = node.childNodes,
        childrenLength = children.length;
    txt = '[';
    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
    txt += '](';
    txt += '<' + node.getAttribute('href') + '>';
    if (node.hasAttribute('title')) {
      txt += ' "' + node.getAttribute('title') + '"';
    }
    txt += ')';
  }
  return txt;
});

showdown.subParser('makeMarkdown.list', function (node, globals, type) {
  'use strict';

  var txt = '';
  if (!node.hasChildNodes()) {
    return '';
  }
  var listItems       = node.childNodes,
      listItemsLenght = listItems.length,
      listNum = node.getAttribute('start') || 1;

  for (var i = 0; i < listItemsLenght; ++i) {
    if (typeof listItems[i].tagName === 'undefined' || listItems[i].tagName.toLowerCase() !== 'li') {
      continue;
    }

    // define the bullet to use in list
    var bullet = '';
    if (type === 'ol') {
      bullet = listNum.toString() + '. ';
    } else {
      bullet = '- ';
    }

    // parse list item
    txt += bullet + showdown.subParser('makeMarkdown.listItem')(listItems[i], globals);
    ++listNum;
  }

  // add comment at the end to prevent consecutive lists to be parsed as one
  txt += '\n<!-- -->\n';
  return txt.trim();
});

showdown.subParser('makeMarkdown.listItem', function (node, globals) {
  'use strict';

  var listItemTxt = '';

  var children = node.childNodes,
      childrenLenght = children.length;

  for (var i = 0; i < childrenLenght; ++i) {
    listItemTxt += showdown.subParser('makeMarkdown.node')(children[i], globals);
  }
  // if it's only one liner, we need to add a newline at the end
  if (!/\n$/.test(listItemTxt)) {
    listItemTxt += '\n';
  } else {
    // it's multiparagraph, so we need to indent
    listItemTxt = listItemTxt
      .split('\n')
      .join('\n    ')
      .replace(/^ {4}$/gm, '')
      .replace(/\n\n+/g, '\n\n');
  }

  return listItemTxt;
});



showdown.subParser('makeMarkdown.node', function (node, globals, spansOnly) {
  'use strict';

  spansOnly = spansOnly || false;

  var txt = '';

  // edge case of text without wrapper paragraph
  if (node.nodeType === 3) {
    return showdown.subParser('makeMarkdown.txt')(node, globals);
  }

  // HTML comment
  if (node.nodeType === 8) {
    return '<!--' + node.data + '-->\n\n';
  }

  // process only node elements
  if (node.nodeType !== 1) {
    return '';
  }

  var tagName = node.tagName.toLowerCase();

  switch (tagName) {

    //
    // BLOCKS
    //
    case 'h1':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 1) + '\n\n'; }
      break;
    case 'h2':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 2) + '\n\n'; }
      break;
    case 'h3':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 3) + '\n\n'; }
      break;
    case 'h4':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 4) + '\n\n'; }
      break;
    case 'h5':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 5) + '\n\n'; }
      break;
    case 'h6':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.header')(node, globals, 6) + '\n\n'; }
      break;

    case 'p':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.paragraph')(node, globals) + '\n\n'; }
      break;

    case 'blockquote':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.blockquote')(node, globals) + '\n\n'; }
      break;

    case 'hr':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.hr')(node, globals) + '\n\n'; }
      break;

    case 'ol':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.list')(node, globals, 'ol') + '\n\n'; }
      break;

    case 'ul':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.list')(node, globals, 'ul') + '\n\n'; }
      break;

    case 'precode':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.codeBlock')(node, globals) + '\n\n'; }
      break;

    case 'pre':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.pre')(node, globals) + '\n\n'; }
      break;

    case 'table':
      if (!spansOnly) { txt = showdown.subParser('makeMarkdown.table')(node, globals) + '\n\n'; }
      break;

    //
    // SPANS
    //
    case 'code':
      txt = showdown.subParser('makeMarkdown.codeSpan')(node, globals);
      break;

    case 'em':
    case 'i':
      txt = showdown.subParser('makeMarkdown.emphasis')(node, globals);
      break;

    case 'strong':
    case 'b':
      txt = showdown.subParser('makeMarkdown.strong')(node, globals);
      break;

    case 'del':
      txt = showdown.subParser('makeMarkdown.strikethrough')(node, globals);
      break;

    case 'a':
      txt = showdown.subParser('makeMarkdown.links')(node, globals);
      break;

    case 'img':
      txt = showdown.subParser('makeMarkdown.image')(node, globals);
      break;

    default:
      txt = node.outerHTML + '\n\n';
  }

  // common normalization
  // TODO eventually

  return txt;
});

showdown.subParser('makeMarkdown.paragraph', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes()) {
    var children = node.childNodes,
        childrenLength = children.length;
    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
  }

  // some text normalization
  txt = txt.trim();

  return txt;
});

showdown.subParser('makeMarkdown.pre', function (node, globals) {
  'use strict';

  var num  = node.getAttribute('prenum');
  return '<pre>' + globals.preList[num] + '</pre>';
});

showdown.subParser('makeMarkdown.strikethrough', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes()) {
    txt += '~~';
    var children = node.childNodes,
        childrenLength = children.length;
    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
    txt += '~~';
  }
  return txt;
});

showdown.subParser('makeMarkdown.strong', function (node, globals) {
  'use strict';

  var txt = '';
  if (node.hasChildNodes()) {
    txt += '**';
    var children = node.childNodes,
        childrenLength = children.length;
    for (var i = 0; i < childrenLength; ++i) {
      txt += showdown.subParser('makeMarkdown.node')(children[i], globals);
    }
    txt += '**';
  }
  return txt;
});

showdown.subParser('makeMarkdown.table', function (node, globals) {
  'use strict';

  var txt = '',
      tableArray = [[], []],
      headings   = node.querySelectorAll('thead>tr>th'),
      rows       = node.querySelectorAll('tbody>tr'),
      i, ii;
  for (i = 0; i < headings.length; ++i) {
    var headContent = showdown.subParser('makeMarkdown.tableCell')(headings[i], globals),
        allign = '---';

    if (headings[i].hasAttribute('style')) {
      var style = headings[i].getAttribute('style').toLowerCase().replace(/\s/g, '');
      switch (style) {
        case 'text-align:left;':
          allign = ':---';
          break;
        case 'text-align:right;':
          allign = '---:';
          break;
        case 'text-align:center;':
          allign = ':---:';
          break;
      }
    }
    tableArray[0][i] = headContent.trim();
    tableArray[1][i] = allign;
  }

  for (i = 0; i < rows.length; ++i) {
    var r = tableArray.push([]) - 1,
        cols = rows[i].getElementsByTagName('td');

    for (ii = 0; ii < headings.length; ++ii) {
      var cellContent = ' ';
      if (typeof cols[ii] !== 'undefined') {
        cellContent = showdown.subParser('makeMarkdown.tableCell')(cols[ii], globals);
      }
      tableArray[r].push(cellContent);
    }
  }

  var cellSpacesCount = 3;
  for (i = 0; i < tableArray.length; ++i) {
    for (ii = 0; ii < tableArray[i].length; ++ii) {
      var strLen = tableArray[i][ii].length;
      if (strLen > cellSpacesCount) {
        cellSpacesCount = strLen;
      }
    }
  }

  for (i = 0; i < tableArray.length; ++i) {
    for (ii = 0; ii < tableArray[i].length; ++ii) {
      if (i === 1) {
        if (tableArray[i][ii].slice(-1) === ':') {
          tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii].slice(-1), cellSpacesCount - 1, '-') + ':';
        } else {
          tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii], cellSpacesCount, '-');
        }
      } else {
        tableArray[i][ii] = showdown.helper.padEnd(tableArray[i][ii], cellSpacesCount);
      }
    }
    txt += '| ' + tableArray[i].join(' | ') + ' |\n';
  }

  return txt.trim();
});

showdown.subParser('makeMarkdown.tableCell', function (node, globals) {
  'use strict';

  var txt = '';
  if (!node.hasChildNodes()) {
    return '';
  }
  var children = node.childNodes,
      childrenLength = children.length;

  for (var i = 0; i < childrenLength; ++i) {
    txt += showdown.subParser('makeMarkdown.node')(children[i], globals, true);
  }
  return txt.trim();
});

showdown.subParser('makeMarkdown.txt', function (node) {
  'use strict';

  var txt = node.nodeValue;

  // multiple spaces are collapsed
  txt = txt.replace(/ +/g, ' ');

  // replace the custom ¨NBSP; with a space
  txt = txt.replace(/¨NBSP;/g, ' ');

  // ", <, > and & should replace escaped html entities
  txt = showdown.helper.unescapeHTMLEntities(txt);

  // escape markdown magic characters
  // emphasis, strong and strikethrough - can appear everywhere
  // we also escape pipe (|) because of tables
  // and escape ` because of code blocks and spans
  txt = txt.replace(/([*_~|`])/g, '\\$1');

  // escape > because of blockquotes
  txt = txt.replace(/^(\s*)>/g, '\\$1>');

  // hash character, only troublesome at the beginning of a line because of headers
  txt = txt.replace(/^#/gm, '\\#');

  // horizontal rules
  txt = txt.replace(/^(\s*)([-=]{3,})(\s*)$/, '$1\\$2$3');

  // dot, because of ordered lists, only troublesome at the beginning of a line when preceded by an integer
  txt = txt.replace(/^( {0,3}\d+)\./gm, '$1\\.');

  // +, * and -, at the beginning of a line becomes a list, so we need to escape them also (asterisk was already escaped)
  txt = txt.replace(/^( {0,3})([+-])/gm, '$1\\$2');

  // images and links, ] followed by ( is problematic, so we escape it
  txt = txt.replace(/]([\s]*)\(/g, '\\]$1\\(');

  // reference URIs must also be escaped
  txt = txt.replace(/^ {0,3}\[([\S \t]*?)]:/gm, '\\[$1]:');

  return txt;
});

var root = this;

// AMD Loader
if (typeof define === 'function' && define.amd) {
  define(function () {
    'use strict';
    return showdown;
  });

// CommonJS/nodeJS Loader
} else if (typeof module !== 'undefined' && module.exports) {
  module.exports = showdown;

// Regular Browser loader
} else {
  root.showdown = showdown;
}
}).call(this);

//# sourceMappingURL=showdown.js.map

/*! showdown-twitter 26-11-2016 */(function (extension) {
  'use strict';

  if (typeof showdown !== 'undefined') {
    extension(showdown);
  } else if (typeof define === 'function' && define.amd) {
    define(['showdown'], extension);
  } else if (typeof exports === 'object') {
    module.exports = extension(require('showdown'));
  } else {
    throw Error('Could not find showdown library');
  }

}(function (showdown) {
  'use strict';

  showdown.extension('twitter', function () {
    return [
      {
        type:    'lang',
        regex:   '\\B(\\\\)?@([\\S]+)\\b',
        replace: function (match, leadingSlash, username) {
          if (leadingSlash === '\\') {
            return match;
          } else {
            return '<a href="http://twitter.com/' + username + '">@' + username + '</a>';
          }
        }
      },
      {
        type:    'lang',
        regex:   '\\B(\\\\)?#([\\S]+)\\b',
        replace: function (match, leadingSlash, tag) {
          if (leadingSlash === '\\') {
            return match;
          } else {
            return '<a href="http://twitter.com/search/%23' + tag + '">#' + tag + '</a>';
          }
        }
      },
      {
        type:    'lang',
        regex:   '\\\\@',
        replace: '@'
      }
    ];
  });
}));

//# sourceMappingURL=showdown-twitter.js.map
/*! showdown-prettify 06-01-2016 */
(function (extension) {
  'use strict';

  if (typeof showdown !== 'undefined') {
    extension(showdown);
  } else if (typeof define === 'function' && define.amd) {
    define(['showdown'], extension);
  } else if (typeof exports === 'object') {
    module.exports = extension(require('showdown'));
  } else {
    throw Error('Could not find showdown library');
  }

}(function (showdown) {
  'use strict';
  showdown.extension('prettify', function () {
    return [{
      type:   'output',
      filter: function (source) {
        return source.replace(/(<pre[^>]*>)?[\n\s]?<code([^>]*)>/gi, function (match, pre, codeClass) {
          if (pre) {
            return '<pre class="prettyprint linenums"><code' + codeClass + '>';
          } else {
            return ' <code class="prettyprint">';
          }
        });
      }
    }];
  });
}));

//# sourceMappingURL=showdown-prettify.js.map
"use strict";!function(){var s={},o={};function e(e,t,i,n,o){var r;return!i.isPostOpen||s.transientJobs[t].canRunWithOpenGrid?(e=e||function(e,t,i,n,o){return new window.hg[s.transientJobs[e].constructorName](t,i,n,o)}.bind(s,t),r=e(i,n,function(){s.transientJobs[t].jobs[i.index].splice(s.transientJobs[t].jobs[i.index].indexOf(r),1)},o),s.transientJobs[t].jobs[i.index].push(r),window.hg.animator.startJob(r),r):(console.log("Cannot create a "+s.transientJobs[t].constructorName+" while the Grid is expanded"),null)}function t(e,t){return s.transientJobs[e].create(t,(e=t,t=parseInt(Math.random()*e.originalTiles.length),e.originalTiles[t]))}function i(i,n,e,t,o){var r,a,l;l=s.transientJobs[i].timeouts,a=t+.5*o-(r=0<(r=t-.5*o)?r:1),l[n.index]&&(clearTimeout(l[n.index]),l[n.index]=null),e&&(l[n.index]=setTimeout(function e(){var t=Math.random()*a+r;s.transientJobs[i].createRandom(n);l[n.index]=setTimeout(e,t)},t))}function n(e,t){var i=s.persistentJobs[e],e=new window.hg[i.constructorName](t);i.jobs[t.index].push(e),i.start(t,i.jobs[t.index].length-1)}function r(e,t,i){void 0!==i?window.hg.animator.startJob(s.persistentJobs[e].jobs[t.index][i]):s.persistentJobs[e].jobs[t.index].forEach(window.hg.animator.startJob)}function a(e,t,i){void 0!==i?s.persistentJobs[e].jobs[t.index][i].cancel():s.persistentJobs[e].jobs[t.index].forEach(function(e){e.cancel()})}function l(){o.grids.forEach(c)}function c(e){var i,n,t=e.isPostOpen?e.expandedTile.postData.id:null;window.hg.animator.cancelAll(),e.resize(),u(e),t&&(t=d(e,t),s.transientJobs.OpenPostJob.create(e,t)),o.performanceCheckJob&&(o.performanceCheckJob={start:function(e){n=i=0,o.performanceCheckJob.startTime=e,o.performanceCheckJob.isComplete=!1},update:function(e,t){i++,t>=window.hg.animator.config.deltaTimeUpperThreshold&&n++,20<=i&&(o.performanceCheckJob.isComplete=!0,o.performanceCheckJob=null,console.info("--- PERFORMANCE DIAGNOSTICS ---"),console.info("maxDeltaTimeFrameCount",n),console.info("frameCount",i),console.info("-------------------------------"),.25<n/i&&window.hg.util.requestAnimationFrame(function(){s.isLowPerformanceBrowser=!0,o.grids.forEach(g),l(),function(){console.info("Is a low-performance browser");var e=document.createElement("div"),t=document.getElementsByTagName("body")[0];t.appendChild(e),e.innerHTML="Switching to low-performance mode.",e.style.zIndex=5e3,e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.bottom="0",e.style.left="0",e.style.width="70%",e.style.height="70%",e.style.margin="auto",e.style.padding="5%",e.style.fontSize="5em",e.style.fontWeight="bold",e.style.opacity="1",e.style.color="white",e.style.backgroundColor="rgba(60,0,0,0.6)",window.hg.util.setTransition(e,"opacity 1s linear 1.5s"),setTimeout(function(){e.style.opacity="0",setTimeout(function(){t.removeChild(e)},2500)},10)}()}))},draw:function(){},cancel:function(){},init:function(){},isComplete:!0},window.hg.util.requestAnimationFrame(function(){window.hg.animator.startJob(o.performanceCheckJob)})),p(e),m(),b()}function d(e,t){for(var i=0,n=e.originalTiles.length;i<n;i+=1)if(e.originalTiles[i].holdsContent&&e.originalTiles[i].postData.id===t)return e.originalTiles[i];return null}function u(e){window.hg.animator.startJob(e),s.persistentJobs.ColorResetJob.start(e),s.persistentJobs.DisplacementResetJob.start(e),window.hg.animator.startJob(o.annotations[e.index]),s.isLowPerformanceBrowser||(s.persistentJobs.ColorShiftJob.start(e),s.persistentJobs.ColorWaveJob.start(e),s.persistentJobs.DisplacementWaveJob.start(e))}function g(e){s.persistentJobs.ColorShiftJob.cancel(e),s.persistentJobs.ColorWaveJob.cancel(e),s.persistentJobs.DisplacementWaveJob.cancel(e)}function h(e,t){e.isPostOpen=!1,e.pagePost=null,e.isTransitioning=!1,e.expandedTile=null,e.sectors=null,e.allNonContentTiles=null,e.postData=t,e.computeContentIndices(),c(e)}function p(e){window.hg.util.checkForSafari()&&(console.info("Is a Safari browser"),s.isSafariBrowser=!0,e.svg.style.width=e.parent.offsetWidth+"px",e.svg.style.height=e.parent.offsetHeight+"px")}function m(){window.hg.util.checkForIos()&&(console.info("Is an iOS browser"),s.isIosBrowser=!0)}function b(){document.documentElement.clientWidth<1250?(console.info("Is a small-screen browser"),s.isSmallScreen=!0):s.isSmallScreen=!1}s.persistentJobs={ColorShiftJob:{constructorName:"ColorShiftJob",jobs:[],create:n.bind(s,"ColorShiftJob"),start:r.bind(s,"ColorShiftJob"),cancel:a.bind(s,"ColorShiftJob")},ColorWaveJob:{constructorName:"ColorWaveJob",jobs:[],create:n.bind(s,"ColorWaveJob"),start:r.bind(s,"ColorWaveJob"),cancel:a.bind(s,"ColorWaveJob")},DisplacementWaveJob:{constructorName:"DisplacementWaveJob",jobs:[],create:n.bind(s,"DisplacementWaveJob"),start:r.bind(s,"DisplacementWaveJob"),cancel:a.bind(s,"DisplacementWaveJob")},ColorResetJob:{constructorName:"ColorResetJob",jobs:[],create:n.bind(s,"ColorResetJob"),start:r.bind(s,"ColorResetJob"),cancel:a.bind(s,"ColorResetJob")},DisplacementResetJob:{constructorName:"DisplacementResetJob",jobs:[],create:n.bind(s,"DisplacementResetJob"),start:r.bind(s,"DisplacementResetJob"),cancel:a.bind(s,"DisplacementResetJob")}},s.transientJobs={OpenPostJob:{constructorName:"OpenPostJob",jobs:[],timeouts:[],create:e.bind(s,null,"OpenPostJob"),createRandom:function(e){return e.isPostOpen?null:s.transientJobs.OpenPostJob.create(e,function(e){var t=parseInt(Math.random()*e.contentTiles.length);return e.contentTiles[t]}(e))},toggleRecurrence:i.bind(s,"OpenPostJob"),canRunWithOpenGrid:!1},ClosePostJob:{constructorName:"ClosePostJob",jobs:[],timeouts:[],create:e.bind(s,null,"ClosePostJob"),createRandom:function(e,t){return e.isPostOpen?s.transientJobs.ClosePostJob.create(e,e.expandedTile,t):null},toggleRecurrence:i.bind(s,"ClosePostJob"),canRunWithOpenGrid:!0},CarouselImageSlideJob:{constructorName:"CarouselImageSlideJob",jobs:[],timeouts:[],create:e.bind(s,null,"CarouselImageSlideJob"),createRandom:null,toggleRecurrence:null,canRunWithOpenGrid:!0},DilateSectorsJob:{constructorName:"DilateSectorsJob",jobs:[],timeouts:[],create:e.bind(s,null,"DilateSectorsJob"),createRandom:null,toggleRecurrence:null,canRunWithOpenGrid:!0},FadePostJob:{constructorName:"FadePostJob",jobs:[],timeouts:[],create:e.bind(s,null,"FadePostJob"),createRandom:null,toggleRecurrence:null,canRunWithOpenGrid:!0},DisplacementRadiateJob:{constructorName:"DisplacementRadiateJob",jobs:[],timeouts:[],create:e.bind(s,null,"DisplacementRadiateJob"),createRandom:t.bind(s,"DisplacementRadiateJob"),toggleRecurrence:i.bind(s,"DisplacementRadiateJob"),canRunWithOpenGrid:!0},HighlightHoverJob:{constructorName:"HighlightHoverJob",jobs:[],timeouts:[],create:e.bind(s,null,"HighlightHoverJob"),createRandom:t.bind(s,"HighlightHoverJob"),toggleRecurrence:i.bind(s,"HighlightHoverJob"),canRunWithOpenGrid:!0},HighlightRadiateJob:{constructorName:"HighlightRadiateJob",jobs:[],timeouts:[],create:e.bind(s,null,"HighlightRadiateJob"),createRandom:t.bind(s,"HighlightRadiateJob"),toggleRecurrence:i.bind(s,"HighlightRadiateJob"),canRunWithOpenGrid:!0},IntraTileRadiateJob:{constructorName:"IntraTileRadiateJob",jobs:[],timeouts:[],create:e.bind(s,null,"IntraTileRadiateJob"),createRandom:t.bind(s,"IntraTileRadiateJob"),toggleRecurrence:i.bind(s,"IntraTileRadiateJob"),canRunWithOpenGrid:!0},LineJob:{constructorName:"LineJob",jobs:[],timeouts:[],create:e.bind(s,function(e,t,i){return window.hg.LineJob.createRandomLineJob(e,i)},"LineJob"),createRandom:t.bind(s,"LineJob"),toggleRecurrence:i.bind(s,"LineJob"),canRunWithOpenGrid:!1},LinesRadiateJob:{constructorName:"LinesRadiateJob",jobs:[],timeouts:[],create:e.bind(s,function(t,e,i){var n=new window.hg.LinesRadiateJob(t,e,function(){n.lineJobs.forEach(function(e){s.transientJobs.LineJob.jobs[t.index].splice(s.transientJobs.LineJob.jobs[t.index].indexOf(e),1)}),i()});return n.lineJobs.forEach(function(e){s.transientJobs.LineJob.jobs[t.index].push(e)}),n},"LinesRadiateJob"),createRandom:t.bind(s,"LinesRadiateJob"),toggleRecurrence:i.bind(s,"LinesRadiateJob"),canRunWithOpenGrid:!1},PanJob:{constructorName:"PanJob",jobs:[],timeouts:[],create:e.bind(s,null,"PanJob"),createRandom:t.bind(s,"PanJob"),toggleRecurrence:i.bind(s,"PanJob"),canRunWithOpenGrid:!0},SpreadJob:{constructorName:"SpreadJob",jobs:[],timeouts:[],create:e.bind(s,null,"SpreadJob"),createRandom:t.bind(s,"SpreadJob"),toggleRecurrence:i.bind(s,"SpreadJob"),canRunWithOpenGrid:!0},TileBorderJob:{constructorName:"TileBorderJob",jobs:[],timeouts:[],create:e.bind(s,null,"TileBorderJob"),createRandom:t.bind(s,"TileBorderJob"),toggleRecurrence:i.bind(s,"TileBorderJob"),canRunWithOpenGrid:!0}},o.grids=[],o.inputs=[],o.annotations=[],o.postData=[],o.performanceCheckJob=!0,s.isLowPerformanceBrowser=!1,s.isSafariBrowser=!1,s.isIosBrowser=!1,s.isSmallScreen=!1,s.config={},s.createNewHexGrid=function(e,t,i){var n;return function(t){Object.keys(s.persistentJobs).forEach(function(e){s.persistentJobs[e].jobs[t]=[]}),Object.keys(s.transientJobs).forEach(function(e){s.transientJobs[e].jobs[t]=[]})}(n=o.grids.length),e=new window.hg.Grid(n,e,t,i),o.grids.push(e),t=e.annotations,o.annotations.push(t),i=new window.hg.Input(e),o.inputs.push(i),window.hg.animator.startJob(e),s.persistentJobs.ColorResetJob.create(e),s.persistentJobs.DisplacementResetJob.create(e),window.hg.animator.startJob(t),s.persistentJobs.ColorShiftJob.create(e),s.persistentJobs.ColorWaveJob.create(e),s.persistentJobs.DisplacementWaveJob.create(e),function(i){Object.keys(s.transientJobs).forEach(function(e){var t=window.hg[s.transientJobs[e].constructorName].config;t.isRecurring&&s.transientJobs[e].toggleRecurrence(i,!0,t.avgDelay,t.delayDeviationRange)})}(e),p(e),m(),b(),e},s.resetGrid=c,s.resetPersistentJobs=u,s.setGridPostData=function(e,t){o.postData[e.index]=t,h(e,t),function(e){{var t;1<location.hash.length&&((t=d(e,location.hash.substr(1)))&&o.inputs[0].createClickAnimation(e,t))}}(e)},s.filterGridPostDataByCategory=function(e,t){var i=o.postData[e.index];i="all"!==t?i.filter(function(e){return 0<=e.categories.indexOf(t)}):i.slice(0);h(e,i)},window.hg=window.hg||{},window.hg.controller=s,window.addEventListener("load",function e(){window.removeEventListener("load",e);var t=window.hg.util.debounce(l,300);window.addEventListener("resize",t,!1)},!1),console.log("controller module loaded")}(),function(){function n(e,t){var i=e.className.indexOf(t);return 0<=i&&!(0!==i&&" "!==e.className[i-1]||(t=i+t.length)!==e.className.length&&" "!==e.className[t])}function r(e,t){e.setAttribute("class",e.className+" "+t)}function o(e,t){e.setAttribute("class",e.className.split(" ").filter(function(e){return e!==t}).join(" "))}var t;var a={listenToMultipleForMultiple:function(e,i,n){e.forEach(function(t){i.forEach(function(e){a.listen(t,e,n)})})},createElement:function(e,t,i,n){var o=document.createElement(e);return t&&t.appendChild(o),i&&(o.id=i),n&&n.forEach(function(e){r(o,e)}),o},containsClass:n,toggleClass:function(e,t,i){(void 0===i?n(e,t)?o:r:i?r:o)(e,t)},getPageOffset:function(e){for(var t=0,i=0;e;)t+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;return{x:t-=a.getScrollLeft(),y:i-=a.getScrollTop()}},getViewportSize:function(){var e,t=void 0!==window.innerWidth?(e=window.innerWidth,window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(e=document.documentElement.clientWidth,document.documentElement.clientHeight):(e=document.getElementsByTagName("body")[0].clientWidth,document.getElementsByTagName("body")[0].clientHeight);return{w:e,h:t}},removeChildIfPresent:function(e,t){return!(!t||t.parentNode!==e)&&(e.removeChild(t),!0)},addClass:r,removeClass:o,clearClasses:function(e){e.className=""},getTextWidth:function(e,t,i,n,o){return i=i||document.getElementsByTagName("body")[0],(o=a.createElement(t,null,n,o)).style.position="absolute",o.style.visibility="hidden",o.style.whiteSpace="nowrap",i.appendChild(o),o.innerHTML=e,e=o.clientWidth,i.removeChild(o),e},encodeQueryString:function(e){var t,i=[];for(t in e)e.hasOwnProperty(t)&&i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return"?"+i.join("&")},getQueryStringParameterValue:function(e,t){return t=(t=encodeURIComponent(t)).replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(e=new RegExp("[\\?&]"+t+"=([^&#]*)","i").exec(e))?null:decodeURIComponent(e[1].replace(/\+/g," "))},setTransition:function(e,t){e.style.transition=t,e.style.WebkitTransition=t,e.style.MozTransition=t,e.style.msTransition=t,e.style.OTransition=t},setTransitionDurationSeconds:function(e,t){e.style.transitionDuration=t+"s",e.style.WebkitTransitionDuration=t+"s",e.style.MozTransitionDuration=t+"s",e.style.msTransitionDuration=t+"s",e.style.OTransitionDuration=t+"s"},setTransitionDelaySeconds:function(e,t){e.style.transitionDelay=t+"s",e.style.WebkitTransitionDelay=t+"s",e.style.MozTransitionDelay=t+"s",e.style.msTransitionDelay=t+"s",e.style.OTransitionDelay=t+"s"},setUserSelectNone:function(e){e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.MozUserSelect="none",e.style.msUserSelect="none"},removeChildrenWithClass:function(e,t){for(var i=e.querySelectorAll("."+t),n=0,o=i.length;n<o;n++)e.removeChild(i[n])},setTransitionCubicBezierTimingFunction:function(e,t){t="cubic-bezier("+t.p1x+","+t.p1y+","+t.p2x+","+t.p2y+")",e.style.transitionTimingFunction=t,e.style.WebkitTransitionTimingFunction=t,e.style.MozTransitionTimingFunction=t,e.style.msTransitionTimingFunction=t,e.style.OTransitionTimingFunction=t},easingFunctions:{linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1+--e*e*e},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},inverseEasingFunctions:{linear:function(e){return e},easeInQuad:function(e){return Math.sqrt(e)},easeOutQuad:function(e){return 1-Math.sqrt(1-e)},easeInOutQuad:function(e){return e<.5?Math.sqrt(.5*e):1-.70710678*Math.sqrt(1-e)}},requestAnimationFrame:(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,16)}).bind(window),getXYFromPercentWithBezier:function(e,t){var i=(o=1-e)*o*o,n=3*e*o*o,o=3*e*e*o,e=e*e*e;return{x:t[0].x*i+t[1].x*n+t[2].x*o+t[3].x*e,y:t[0].y*i+t[1].y*n+t[2].y*o+t[3].y*e}},setTransform:function(e,t){e.style.webkitTransform=t,e.style.MozTransform=t,e.style.msTransform=t,e.style.OTransform=t,e.style.transform=t},shuffle:function(e){for(var t,i,n=0,o=e.length;n<o;n+=1)i=e[t=parseInt(Math.random()*o)],e[t]=e[n],e[n]=i;return e},isPointInsidePolyline:function(e,t,i,n){var o,r,a,l,s,c,d,u,g,h,p=!1;if(n){if(i.length<6)return p;d=i[i.length-4],u=i[i.length-3]}else{if(i.length<4)return p;d=i[i.length-2],u=i[i.length-1]}for(o=0,r=i.length-2;o<r;o+=2)g=i[o],h=i[o+1],c=d<g?(a=d,l=u,s=g,h):(a=g,l=h,s=d,u),g<e==e<=d&&(t-l)*(s-a)<(c-l)*(e-a)&&(p=!p),d=g,u=h;return p},shallowCopy:function(e){var t,i;if("object"!=typeof e)return e;for(t in i={},e)i[t]=e[t];return i},deepCopy:function e(t){var i,n;if("object"!=typeof t)return t;for(i in n=t instanceof Array?[]:{},t)"object"==typeof t[i]?n[i]=e(t[i]):n[i]=t[i];return n},hsvToHsl:function(e){var t=(2-e.s)*e.v;return{h:e.h,s:e.s*e.v/(t<1?t:2.00000001-t),l:.5*t}},hslToHsv:function(e){var t=e.s*(e.l<.5?e.l:1-e.l);return{h:e.h,s:2*t/(e.l+t),v:e.l+t}},findClassInSelfOrAncestors:function(e,t){for(;e;)if(window.hg.util.containsClass(e,t))return e;return null},addRuleToStyleSheet:function(e){t||(t=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(t)),t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))},checkForSafari:function(){return/Safari/i.test(window.navigator.userAgent)&&!/Chrome/i.test(window.navigator.userAgent)},checkForIos:function(){return/iPhone|iPod|iPad/i.test(window.navigator.userAgent)},debounce:function(n,o,r){var a;return function(){var e=this,t=arguments,i=r&&!a;clearTimeout(a),a=setTimeout(function(){a=null,r||n.apply(e,t)},o),i&&n.apply(e,t)}},isSmallScreen:function(){return window.innerWidth<660},svgNamespace:"http://www.w3.org/2000/svg",xlinkNamespace:"http://www.w3.org/1999/xlink"};window.hg=window.hg||{},window.hg.util=a,console.log("util module loaded")}(),function(){var o={},i={};function n(e){var t=(t=e-o.previousTime)>i.deltaTimeUpperThreshold?i.deltaTimeUpperThreshold:t;o.isLooping=!0,o.isPaused?o.isLooping=!1:(function(e,t){var i,n;for(i=0,n=o.jobs.length;i<n;i+=1)o.jobs[i].update(e,t),o.jobs[i].isComplete&&(r(o.jobs[i],i),i--,n--)}(e,t),function(){var e,t;for(e=0,t=o.jobs.length;e<t;e+=1)o.jobs[e].draw()}(),window.hg.util.requestAnimationFrame(n)),o.previousTime=e}function r(e,t){var i;if("number"==typeof t)o.jobs.splice(t,1);else for(t=0,i=o.jobs.length;t<i;t+=1)if(o.jobs[t]===e){o.jobs.splice(t,1);break}0===o.jobs.length&&(o.isPaused=!0)}function e(e){console.log("Job cancelling: "+e.constructor.name),e.cancel(),r(e)}i.deltaTimeUpperThreshold=160,o.jobs=[],o.previousTime=window.performance&&window.performance.now()||0,o.isLooping=!1,o.isPaused=!0,o.startJob=function(e){e.isComplete?(console.log("Job starting: "+e.constructor.name),e.init(),e.start(o.previousTime),o.jobs.push(e)):(console.log("Job restarting: "+e.constructor.name),e.refresh?e.refresh():(e.cancel(),e.init(),e.start(o.previousTime)));o.isPaused=!1,o.isLooping||(o.isLooping=!0,window.hg.util.requestAnimationFrame(function(e){o.previousTime=e,window.hg.util.requestAnimationFrame(n)}))},o.cancelJob=e,o.cancelAll=function(){for(;o.jobs.length;)e(o.jobs[0])},o.config=i,window.hg=window.hg||{},window.hg.animator=o,console.log("animator module loaded")}(),function(){var o={};function e(e){var t=this;t.grid=e,t.startTime=0,t.isComplete=!0,t.annotations=window.hg.util.shallowCopy(o.annotations),t.contentAreaGuideLines=[],t.tileParticleCenters=[],t.tileAnchorLines=[],t.tileAnchorCenters=[],t.tileDisplacementCircles=[],t.tileInnerRadii=[],t.tileOuterRadii=[],t.neighborLines=[],t.forceLines=[],t.velocityLines=[],t.indexTexts=[],t.lineAnimationGapDots=[],t.lineAnimationSelfCornerDots=[],t.lineAnimationLowerNeighborCornerDots=[],t.lineAnimationUpperNeighborCornerDots=[],t.sectorAnchorLines=[],t.sectorAnchorCenters=[],t.originalGridCenterDot=null,t.currentGridCenterDot=null,t.panCenterDot=null,t.toggleAnnotationEnabled=d,t.createAnnotations=u,t.destroyAnnotations=g,t.setExpandedAnnotations=h,t.start=p,t.update=m,t.draw=b,t.cancel=f,t.init=w,t.refresh=v}function t(){for(var e=this,t=0,i=e.grid.originalTiles.length;t<i;t+=1)e.grid.originalTiles[t].holdsContent&&(e.grid.originalTiles[t].currentColor.h=o.contentTileHue,e.grid.originalTiles[t].currentColor.s=o.contentTileSaturation,e.grid.originalTiles[t].currentColor.l=o.contentTileLightness)}function i(){for(var e=this,t=0,i=e.grid.allTiles.length;t<i;t+=1)e.grid.allTiles[t].getIsBorderTile()&&(e.grid.allTiles[t].currentColor.h=o.borderTileHue,e.grid.allTiles[t].currentColor.s=o.borderTileSaturation,e.grid.allTiles[t].currentColor.l=o.borderTileLightness)}function n(){for(var e=this,t=0,i=e.grid.originalBorderTiles.length;t<i;t+=1)e.grid.originalBorderTiles[t].isCornerTile&&(e.grid.originalTiles[t].currentColor.h=o.cornerTileHue,e.grid.originalTiles[t].currentColor.s=o.cornerTileSaturation,e.grid.originalTiles[t].currentColor.l=o.cornerTileLightness)}function r(){var e,t,i,n,o,r=this;for(r.neighborLines=[],e=0,i=r.grid.allTiles.length;e<i;e+=1)for(o=r.grid.allTiles[e].getNeighborStates(),r.neighborLines[e]=[],t=0,n=o.length;t<n;t+=1)o[t]&&(r.neighborLines[e][t]=document.createElementNS(window.hg.util.svgNamespace,"line"),r.grid.svg.appendChild(r.neighborLines[e][t]),r.neighborLines[e][t].setAttribute("stroke","purple"),r.neighborLines[e][t].setAttribute("stroke-width","1"))}function a(){for(var e,t,i,n,o=0,r=this.grid.sectors.length;o<r;o+=1)for(n=60*o+20,e=0,t=(i=this.grid.sectors[o]).tiles.length;e<t;e+=1)i.tiles[e].currentColor.h=n,i.tiles[e].currentColor.s=window.hg.Grid.config.tileSaturation,i.tiles[e].currentColor.l=window.hg.Grid.config.tileLightness}function l(){for(var e,t,i=this,n=0,o=i.neighborLines.length;n<o;n+=1)for(e=0,t=i.neighborLines[n].length;e<t;e+=1)i.neighborLines[n][e]&&i.grid.svg.removeChild(i.neighborLines[n][e]);i.neighborLines=[]}function s(){for(var e=0,t=this.lineAnimationGapDots.length;e<t;e+=1)this.grid.svg.removeChild(this.lineAnimationGapDots[e]);this.lineAnimationGapDots=[]}function c(){for(var e=this,t=0,i=e.lineAnimationSelfCornerDots.length;t<i;t+=1)e.grid.svg.removeChild(e.lineAnimationSelfCornerDots[t]);for(t=0,i=e.lineAnimationLowerNeighborCornerDots.length;t<i;t+=1)e.grid.svg.removeChild(e.lineAnimationLowerNeighborCornerDots[t]);for(t=0,i=e.lineAnimationUpperNeighborCornerDots.length;t<i;t+=1)e.grid.svg.removeChild(e.lineAnimationUpperNeighborCornerDots[t]);e.lineAnimationSelfCornerDots=[],e.lineAnimationLowerNeighborCornerDots=[],e.lineAnimationUpperNeighborCornerDots=[]}function d(e,t){var i=this;((i.annotations[e].enabled=t)?i.annotations[e].create:i.annotations[e].destroy).call(i)}function u(){for(var e=0,t=o.annotationsArray.length;e<t;e+=1)o.annotationsArray[e].enabled&&o.annotationsArray[e].create.call(this)}function g(){for(var e=0,t=o.annotationsArray.length;e<t;e+=1)o.annotationsArray[e].destroy.call(this)}function h(e){this.annotations.tileNeighborConnections.enabled&&(l.call(this),r.call(this))}function p(){this.isComplete=!1}function m(e,t){for(var i=0,n=o.annotationsArray.length;i<n;i+=1)o.annotationsArray[i].enabled&&o.annotationsArray[i].update.call(this)}function b(){}function f(){this.isComplete=!0}function w(){o.computeDependentValues()}function v(){w(),this.annotations=window.hg.util.shallowCopy(o.annotations)}o.forceLineLengthMultiplier=4e3,o.velocityLineLengthMultiplier=300,o.contentTileHue=187,o.contentTileSaturation=50,o.contentTileLightness=30,o.borderTileHue=267,o.borderTileSaturation=0,o.borderTileLightness=30,o.cornerTileHue=267,o.cornerTileSaturation=50,o.cornerTileLightness=30,o.annotations={tileNeighborConnections:{enabled:!1,create:r,destroy:l,update:function(){var e,t,i,n,o,r,a,l;for(t=0,n=(e=this).grid.allTiles.length;t<n;t+=1)for(r=e.grid.allTiles[t],a=r.getNeighborStates(),i=0,o=a.length;i<o;i+=1)(l=a[i])&&(e.neighborLines[t][i].setAttribute("x1",r.particle.px),e.neighborLines[t][i].setAttribute("y1",r.particle.py),e.neighborLines[t][i].setAttribute("x2",l.tile.particle.px),e.neighborLines[t][i].setAttribute("y2",l.tile.particle.py))},priority:1300},tileAnchorCenters:{enabled:!1,create:function(){var e,t,i;for((e=this).tileAnchorLines=[],e.tileAnchorCenters=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.tileAnchorLines[t]=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(e.tileAnchorLines[t]),e.tileAnchorLines[t].setAttribute("stroke","#666666"),e.tileAnchorLines[t].setAttribute("stroke-width","2"),e.tileAnchorCenters[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.tileAnchorCenters[t]),e.tileAnchorCenters[t].setAttribute("r","4"),e.tileAnchorCenters[t].setAttribute("fill","#888888")},destroy:function(){var e,t,i;for(t=0,i=(e=this).tileAnchorLines.length;t<i;t+=1)e.grid.svg.removeChild(e.tileAnchorLines[t]),e.grid.svg.removeChild(e.tileAnchorCenters[t]);e.tileAnchorLines=[],e.tileAnchorCenters=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.tileAnchorLines[t].setAttribute("x1",e.grid.allTiles[t].particle.px),e.tileAnchorLines[t].setAttribute("y1",e.grid.allTiles[t].particle.py),e.tileAnchorLines[t].setAttribute("x2",e.grid.allTiles[t].currentAnchor.x),e.tileAnchorLines[t].setAttribute("y2",e.grid.allTiles[t].currentAnchor.y),e.tileAnchorCenters[t].setAttribute("cx",e.grid.allTiles[t].currentAnchor.x),e.tileAnchorCenters[t].setAttribute("cy",e.grid.allTiles[t].currentAnchor.y)},priority:500},transparentTiles:{enabled:!1,create:function(){var e,t;for(e=0,t=this.grid.allTiles.length;e<t;e+=1)this.grid.allTiles[e].element.setAttribute("opacity","0")},destroy:function(){var e,t;for(e=0,t=this.grid.originalTiles.length;e<t;e+=1)this.grid.originalTiles[e].element.setAttribute("opacity","1")},update:function(){},priority:400},tileIndices:{enabled:!1,create:function(){var e,t,i;for((e=this).indexTexts=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.indexTexts[t]=document.createElementNS(window.hg.util.svgNamespace,"text"),e.indexTexts[t].innerHTML=isNaN(e.grid.allTiles[t].originalIndex)?"?":e.grid.allTiles[t].originalIndex,e.grid.svg.appendChild(e.indexTexts[t]),e.indexTexts[t].setAttribute("font-size","16"),e.indexTexts[t].setAttribute("fill","black"),e.indexTexts[t].setAttribute("pointer-events","none")},destroy:function(){var e,t;for(e=0,t=this.indexTexts.length;e<t;e+=1)this.grid.svg.removeChild(this.indexTexts[e]);this.indexTexts=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.indexTexts[t].setAttribute("x",e.grid.allTiles[t].particle.px-10),e.indexTexts[t].setAttribute("y",e.grid.allTiles[t].particle.py+6)},priority:1e3},tileForces:{enabled:!1,create:function(){var e,t,i;for((e=this).forceLines=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.forceLines[t]=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(e.forceLines[t]),e.forceLines[t].setAttribute("stroke","orange"),e.forceLines[t].setAttribute("stroke-width","2")},destroy:function(){var e,t;for(e=0,t=this.forceLines.length;e<t;e+=1)this.grid.svg.removeChild(this.forceLines[e]);this.forceLines=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.forceLines[t].setAttribute("x1",e.grid.allTiles[t].particle.px),e.forceLines[t].setAttribute("y1",e.grid.allTiles[t].particle.py),e.forceLines[t].setAttribute("x2",e.grid.allTiles[t].particle.px+e.grid.allTiles[t].particle.fx*o.forceLineLengthMultiplier),e.forceLines[t].setAttribute("y2",e.grid.allTiles[t].particle.py+e.grid.allTiles[t].particle.fy*o.forceLineLengthMultiplier)},priority:1100},tileVelocities:{enabled:!1,create:function(){var e,t,i;for((e=this).velocityLines=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.velocityLines[t]=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(e.velocityLines[t]),e.velocityLines[t].setAttribute("stroke","red"),e.velocityLines[t].setAttribute("stroke-width","2")},destroy:function(){var e,t;for(e=0,t=this.velocityLines.length;e<t;e+=1)this.grid.svg.removeChild(this.velocityLines[e]);this.velocityLines=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.velocityLines[t].setAttribute("x1",e.grid.allTiles[t].particle.px),e.velocityLines[t].setAttribute("y1",e.grid.allTiles[t].particle.py),e.velocityLines[t].setAttribute("x2",e.grid.allTiles[t].particle.px+e.grid.allTiles[t].particle.vx*o.velocityLineLengthMultiplier),e.velocityLines[t].setAttribute("y2",e.grid.allTiles[t].particle.py+e.grid.allTiles[t].particle.vy*o.velocityLineLengthMultiplier)},priority:1200},sectorColors:{enabled:!1,create:a,destroy:function(){},update:a,priority:0},borderTiles:{enabled:!1,create:i,destroy:function(){},update:i,priority:200},contentTiles:{enabled:!1,create:t,destroy:function(){},update:t,priority:100},cornerTiles:{enabled:!1,create:n,destroy:function(){},update:n,priority:300},tileParticleCenters:{enabled:!1,create:function(){var e,t,i;for((e=this).tileParticleCenters=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.tileParticleCenters[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.tileParticleCenters[t]),e.tileParticleCenters[t].setAttribute("r","4"),e.tileParticleCenters[t].setAttribute("fill","gray")},destroy:function(){var e,t;for(e=0,t=this.tileParticleCenters.length;e<t;e+=1)this.grid.svg.removeChild(this.tileParticleCenters[e]);this.tileParticleCenters=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.tileParticleCenters[t].setAttribute("cx",e.grid.allTiles[t].particle.px),e.tileParticleCenters[t].setAttribute("cy",e.grid.allTiles[t].particle.py)},priority:600},tileDisplacementColors:{enabled:!1,create:function(){var e,t,i;for((e=this).tileDisplacementCircles=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.tileDisplacementCircles[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.tileDisplacementCircles[t]),e.tileDisplacementCircles[t].setAttribute("r","80"),e.tileDisplacementCircles[t].setAttribute("opacity","0.4"),e.tileDisplacementCircles[t].setAttribute("fill","white")},destroy:function(){var e,t;for(e=0,t=this.tileDisplacementCircles.length;e<t;e+=1)this.grid.svg.removeChild(this.tileDisplacementCircles[e]);this.tileDisplacementCircles=[]},update:function(){var e,t,i,n,o,r;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)n=e.grid.allTiles[t].particle.px-e.grid.allTiles[t].originalAnchor.x,r=e.grid.allTiles[t].particle.py-e.grid.allTiles[t].originalAnchor.y,o=180*Math.atan2(n,r)/Math.PI,r=Math.sqrt(n*n+r*r),r="hsl("+o+","+r/window.hg.DisplacementWaveJob.config.displacementAmplitude*100+"%,80%)",e.tileDisplacementCircles[t].setAttribute("fill",r),e.tileDisplacementCircles[t].setAttribute("cx",e.grid.allTiles[t].particle.px),e.tileDisplacementCircles[t].setAttribute("cy",e.grid.allTiles[t].particle.py)},priority:700},tileInnerRadii:{enabled:!1,create:function(){var e,t,i;for((e=this).tileInnerRadii=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.tileInnerRadii[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.tileInnerRadii[t]),e.tileInnerRadii[t].setAttribute("stroke","blue"),e.tileInnerRadii[t].setAttribute("stroke-width","1"),e.tileInnerRadii[t].setAttribute("fill","transparent")},destroy:function(){var e,t;for(e=0,t=this.tileInnerRadii.length;e<t;e+=1)this.grid.svg.removeChild(this.tileInnerRadii[e]);this.tileInnerRadii=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.tileInnerRadii[t].setAttribute("cx",e.grid.allTiles[t].particle.px),e.tileInnerRadii[t].setAttribute("cy",e.grid.allTiles[t].particle.py),e.tileInnerRadii[t].setAttribute("r",e.grid.allTiles[t].outerRadius*window.hg.Grid.config.sqrtThreeOverTwo)},priority:800},tileOuterRadii:{enabled:!1,create:function(){var e,t,i;for((e=this).tileOuterRadii=[],t=0,i=e.grid.allTiles.length;t<i;t+=1)e.tileOuterRadii[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.tileOuterRadii[t]),e.tileOuterRadii[t].setAttribute("stroke","green"),e.tileOuterRadii[t].setAttribute("stroke-width","1"),e.tileOuterRadii[t].setAttribute("fill","transparent")},destroy:function(){var e,t;for(e=0,t=this.tileOuterRadii.length;e<t;e+=1)this.grid.svg.removeChild(this.tileOuterRadii[e]);this.tileOuterRadii=[]},update:function(){var e,t,i;for(t=0,i=(e=this).grid.allTiles.length;t<i;t+=1)e.tileOuterRadii[t].setAttribute("cx",e.grid.allTiles[t].particle.px),e.tileOuterRadii[t].setAttribute("cy",e.grid.allTiles[t].particle.py),e.tileOuterRadii[t].setAttribute("r",e.grid.allTiles[t].outerRadius)},priority:900},contentAreaGuidelines:{enabled:!1,create:function(){var e,t;(e=this).contentAreaGuideLines=[],t=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(t),(e.contentAreaGuideLines[0]=t).setAttribute("x1",e.grid.contentAreaLeft),t.setAttribute("y1",0),t.setAttribute("x2",e.grid.contentAreaLeft),t.setAttribute("y2",e.grid.height),t.setAttribute("stroke","red"),t.setAttribute("stroke-width","2"),t=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(t),(e.contentAreaGuideLines[1]=t).setAttribute("x1",e.grid.contentAreaRight),t.setAttribute("y1",0),t.setAttribute("x2",e.grid.contentAreaRight),t.setAttribute("y2",e.grid.height),t.setAttribute("stroke","red"),t.setAttribute("stroke-width","2")},destroy:function(){var e,t;for(e=0,t=this.contentAreaGuideLines.length;e<t;e+=1)this.grid.svg.removeChild(this.contentAreaGuideLines[e]);this.contentAreaGuideLines=[]},update:function(){},priority:1400},lineAnimationGapPoints:{enabled:!1,create:function(){},destroy:s,update:function(){var e,t,i,n,o,r,a;for(s.call(e=this),e.lineAnimationGapDots=[],t=r=0,i=window.hg.controller.transientJobs.LineJob.jobs[e.grid.index].length;t<i;t+=1)for(a=window.hg.controller.transientJobs.LineJob.jobs[e.grid.index][t],n=0,o=a.gapPoints.length;n<o;n+=1,r+=1)e.lineAnimationGapDots[r]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.lineAnimationGapDots[r].setAttribute("cx",a.gapPoints[n].x),e.lineAnimationGapDots[r].setAttribute("cy",a.gapPoints[n].y),e.lineAnimationGapDots[r].setAttribute("r","4"),e.lineAnimationGapDots[r].setAttribute("fill","white"),e.grid.svg.appendChild(e.lineAnimationGapDots[r])},priority:1500},lineAnimationCornerData:{enabled:!1,create:function(){},destroy:c,update:function(){var e,t,i,n,o,r,a,l;for(c.call(e=this),e.lineAnimationSelfCornerDots=[],e.lineAnimationLowerNeighborCornerDots=[],e.lineAnimationUpperNeighborCornerDots=[],t=0,i=window.hg.controller.transientJobs.LineJob.jobs[e.grid.index].length;t<i;t+=1)for(r=window.hg.controller.transientJobs.LineJob.jobs[e.grid.index][t],n=0,o=r.corners.length;n<o;n+=1)a=s(r.tiles[n],r.corners[n]),(l=document.createElementNS(window.hg.util.svgNamespace,"circle")).setAttribute("cx",a.x),l.setAttribute("cy",a.y),l.setAttribute("r","3"),l.setAttribute("fill","#ffaaaa"),e.grid.svg.appendChild(l),e.lineAnimationSelfCornerDots.push(l),r.lowerNeighbors[n]&&(a=s(r.lowerNeighbors[n].tile,r.lowerNeighborCorners[n]),(l=document.createElementNS(window.hg.util.svgNamespace,"circle")).setAttribute("cx",a.x),l.setAttribute("cy",a.y),l.setAttribute("r","3"),l.setAttribute("fill","#aaffaa"),e.grid.svg.appendChild(l),e.lineAnimationLowerNeighborCornerDots.push(l)),r.upperNeighbors[n]&&(a=s(r.upperNeighbors[n].tile,r.upperNeighborCorners[n]),(l=document.createElementNS(window.hg.util.svgNamespace,"circle")).setAttribute("cx",a.x),l.setAttribute("cy",a.y),l.setAttribute("r","3"),l.setAttribute("fill","#aaaaff"),e.grid.svg.appendChild(l),e.lineAnimationUpperNeighborCornerDots.push(l));function s(e,t){return{x:e.vertices[2*t],y:e.vertices[2*t+1]}}},priority:1600},panCenterPoints:{enabled:!1,create:function(){var e;(e=this).currentGridCenterDot=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.currentGridCenterDot),e.currentGridCenterDot.setAttribute("r","8"),e.currentGridCenterDot.setAttribute("fill","chartreuse"),e.panCenterDot=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.panCenterDot),e.panCenterDot.setAttribute("r","5"),e.panCenterDot.setAttribute("fill","red"),e.originalGridCenterDot=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.originalGridCenterDot),e.originalGridCenterDot.setAttribute("r","2"),e.originalGridCenterDot.setAttribute("fill","yellow")},destroy:function(){var e;(e=this).originalGridCenterDot&&(e.grid.svg.removeChild(e.originalGridCenterDot),e.grid.svg.removeChild(e.currentGridCenterDot),e.grid.svg.removeChild(e.panCenterDot),e.originalGridCenterDot=null,e.currentGridCenterDot=null,e.panCenterDot=null)},update:function(){var e;(e=this).originalGridCenterDot&&(e.originalGridCenterDot.setAttribute("cx",e.grid.originalCenter.x),e.originalGridCenterDot.setAttribute("cy",e.grid.originalCenter.y),e.currentGridCenterDot.setAttribute("cx",e.grid.currentCenter.x),e.currentGridCenterDot.setAttribute("cy",e.grid.currentCenter.y),e.panCenterDot.setAttribute("cx",e.grid.panCenter.x),e.panCenterDot.setAttribute("cy",e.grid.panCenter.y),(e=window.hg.controller.transientJobs.PanJob.jobs[e.grid.index][0])&&(e.baseTile.currentColor.h=0,e.baseTile.currentColor.s=0,e.baseTile.currentColor.l=90))},priority:1700},sectorAnchorCenters:{enabled:!1,create:function(){var e,t;for((e=this).sectorAnchorLines=[],e.sectorAnchorCenters=[],t=0;t<e.grid.sectors.length;t+=1)e.sectorAnchorLines[t]=document.createElementNS(window.hg.util.svgNamespace,"line"),e.grid.svg.appendChild(e.sectorAnchorLines[t]),e.sectorAnchorLines[t].setAttribute("stroke","#999999"),e.sectorAnchorLines[t].setAttribute("stroke-width","2"),e.sectorAnchorCenters[t]=document.createElementNS(window.hg.util.svgNamespace,"circle"),e.grid.svg.appendChild(e.sectorAnchorCenters[t]),e.sectorAnchorCenters[t].setAttribute("r","5"),e.sectorAnchorCenters[t].setAttribute("fill","#BBBBBB")},destroy:function(){var e,t;for(e=this,t=0;t<e.sectorAnchorLines.length;t+=1)e.grid.svg.removeChild(e.sectorAnchorLines[t]),e.grid.svg.removeChild(e.sectorAnchorCenters[t]);e.sectorAnchorLines=[],e.sectorAnchorCenters=[]},update:function(){var e,t,i,n,o,r;for(e=this,t=0;t<e.sectorAnchorLines.length;t+=1)i=e.grid.sectors[t].currentAnchor.x,n=e.grid.sectors[t].currentAnchor.y,o=e.grid.sectors[t].originalAnchor.x-e.grid.sectors[t].expandedDisplacement.x,r=e.grid.sectors[t].originalAnchor.y-e.grid.sectors[t].expandedDisplacement.y,e.sectorAnchorLines[t].setAttribute("x1",i),e.sectorAnchorLines[t].setAttribute("y1",n),e.sectorAnchorLines[t].setAttribute("x2",o),e.sectorAnchorLines[t].setAttribute("y2",r),e.sectorAnchorCenters[t].setAttribute("cx",o),e.sectorAnchorCenters[t].setAttribute("cy",r)},priority:1800}},o.annotationsArray=[],o.computeDependentValues=function(){o.annotationsArray=Object.keys(o.annotations).map(function(e){return o.annotations[e]}),o.annotationsArray.sort(function(e,t){return e.priority-t.priority})},o.computeDependentValues(),e.config=o,window.hg=window.hg||{},window.hg.Annotations=e,console.log("Annotations module loaded")}(),function(){var m,e,t,i,n;function o(e,t,i,n,o,r){var a=this;a.grid=e,a.pagePost=t,a.parent=i,a.elements=null,a.currentIndex=0,a.previousIndex=0,a.mediaMetadata=null,a.currentIndexPositionRatio=0,a.loadMedia=w,a.onSlideFinished=l,a.draw=s,a.destroy=c,function(e,t){this.mediaMetadata=t.concat(e).map(function(e){return e.isVideo=!!e.videoHost,e})}.call(a,n,o),function(e){var t=this,i=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div"),s=document.createElement("p"),c=document.createElement("div"),d=document.createElementNS(window.hg.util.svgNamespace,"svg"),u=document.createElementNS(window.hg.util.svgNamespace,"use"),g=document.createElement("div"),h=document.createElementNS(window.hg.util.svgNamespace,"svg"),p=document.createElementNS(window.hg.util.svgNamespace,"use");t.parent.appendChild(i),i.appendChild(n),n.appendChild(o),n.appendChild(r),n.appendChild(a),a.appendChild(c),c.appendChild(d),d.appendChild(u),a.appendChild(g),g.appendChild(h),h.appendChild(p),i.appendChild(l),l.appendChild(s),t.elements={},t.elements.container=i,t.elements.slidersContainer=n,t.elements.mainMediaRibbon=o,t.elements.thumbnailsRibbon=r,t.elements.buttonsContainer=a,t.elements.captionsPanel=l,t.elements.captionsText=s,t.elements.previousButtonPanel=c,t.elements.previousButtonSvg=d,t.elements.previousButtonUse=u,t.elements.nextButtonPanel=g,t.elements.nextButtonSvg=h,t.elements.nextButtonUse=p,t.elements.mainMedia=[],t.elements.thumbnails=[],t.elements.thumbnailScreens=[],i.setAttribute("data-hg-carousel-container","data-hg-carousel-container"),n.setAttribute("data-hg-carousel-sliders-container","data-hg-carousel-sliders-container"),n.style.position="relative",n.style.overflow="hidden",n.style.width="100%",window.hg.util.setUserSelectNone(i),o.style.position="relative",o.style.width="100%",o.style.height="0",o.style.padding="56.25% 0 0 0",r.style.position="relative",r.style.width=m.thumbnailWidth*t.mediaMetadata.length+"px",r.style.height=m.thumbnailHeight+"px",r.style.left="calc(50% - "+m.thumbnailWidth/2+"px)",r.style.paddingTop=m.thumbnailRibbonPadding+"px",a.style.position="absolute",a.style.top="0",a.style.width="100%",a.style.height="0",a.style.padding="56.25% 0 0 0",c.setAttribute("data-hg-carousel-button","data-hg-carousel-button"),c.style.position="absolute",c.style.top="0",c.style.left="0",c.style.width="calc(33.33% - "+m.prevNextButtonPadding+"px)",c.style.height="100%",c.style.cursor="pointer",c.addEventListener("click",function(){var e,t=this;0<t.currentIndex?(e=(t.currentIndex+t.mediaMetadata.length-1)%t.mediaMetadata.length,f.call(t,e)):console.warn("Carousel cannot go to previous. Already at first medium.")}.bind(t),!1),d.style.position="absolute",d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.margin="auto",d.style.height=m.prevNextButtonHeight+"px",d.style.width=m.prevNextButtonWidth+"px",d.style.paddingLeft=m.prevNextButtonPadding+"px",u.setAttributeNS(window.hg.util.xlinkNamespace,"xlink:href","#chevron-left"),g.setAttribute("data-hg-carousel-button","data-hg-carousel-button"),g.style.position="absolute",g.style.top="0",g.style.right="0",g.style.width="calc(66.67% - "+m.prevNextButtonPadding+"px)",g.style.height="100%",g.style.cursor="pointer",g.addEventListener("click",function(){var e,t=this;t.currentIndex<t.mediaMetadata.length-1?(e=(t.currentIndex+1)%t.mediaMetadata.length,f.call(t,e)):console.warn("Carousel cannot go to next. Already at last medium.")}.bind(t),!1),window.hg.util.setTransform(h,"scaleX(-1)"),h.style.position="absolute",h.style.top="0",h.style.bottom="0",h.style.right="0",h.style.margin="auto",h.style.height=m.prevNextButtonHeight+"px",h.style.width=m.prevNextButtonWidth+"px",h.style.paddingLeft=m.prevNextButtonPadding+"px",p.setAttributeNS(window.hg.util.xlinkNamespace,"xlink:href","#chevron-left"),l.setAttribute("data-hg-captions-panel","data-hg-captions-panel"),s.style.margin="0",s.style.padding="0",t.elements.captionsPanel.setAttribute("data-hg-selected","data-hg-selected"),e||w.call(t);0===t.mediaMetadata.length?(i.style.display="none",l.style.display="none"):(s.innerHTML=t.mediaMetadata[0].description,1===t.mediaMetadata.length&&(r.style.display="none"));b.call(t)}.call(a,r),console.log("Carousel created")}function b(){var e,t,i=this,n=!i.mediaMetadata.length||i.mediaMetadata[i.currentIndex].isVideo?t=e="hidden":(e=0<i.currentIndex?"visible":"hidden",t=i.currentIndex<i.mediaMetadata.length-1?"visible":"hidden","visible");i.elements.previousButtonPanel.style.visibility=e,i.elements.nextButtonPanel.style.visibility=t,i.elements.buttonsContainer.style.visibility=n}function f(e){var t=this;if(t.previousIndex=t.currentIndex,t.currentIndex=e,window.hg.controller.transientJobs.CarouselImageSlideJob.create(t.grid,null,t),t.mediaMetadata[t.previousIndex].isVideo)switch(t.mediaMetadata[t.previousIndex].videoHost){case"youtube":t.elements.mainMedia[t.previousIndex].querySelector("iframe").contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");break;case"vimeo":t.elements.mainMedia[t.previousIndex].querySelector("iframe").contentWindow.postMessage('{"method": "pause", "value": ""}',"*");break;default:throw new Error("Invalid video host: "+t.mediaMetadata[t.previousIndex].videoHost)}t.elements.captionsPanel.removeAttribute("data-hg-selected"),t.elements.thumbnails[t.previousIndex].removeAttribute("data-hg-selected"),t.elements.thumbnails[t.currentIndex].setAttribute("data-hg-selected","data-hg-selected"),b.call(t)}function w(){var a=this;0===a.elements.mainMedia.length&&a.mediaMetadata.forEach(function(e,t){var i,n,o,r;if(e.isVideo)switch((o=document.createElement("iframe")).setAttribute("src",e.videoSrc),o.setAttribute("allowfullscreen","allowfullscreen"),o.setAttribute("frameborder","0"),o.style.position="absolute",o.style.top="0",o.style.width="100%",o.style.height="100%",(i=document.createElement("div")).appendChild(o),e.videoHost){case"youtube":r=e.thumbnailSrc;break;case"vimeo":r="",function(t,i){var e=m.vimeoMetadataBaseUrl+"/"+t.id+".json",n=new XMLHttpRequest;n.addEventListener("load",function(){var e;console.log("Vimeo metadata response status="+n.status+" ("+n.statusText+")");try{e=JSON.parse(n.response)}catch(e){return void console.error("Unable to parse Vimeo metadata response body as JSON: "+n.response)}t.thumbnailSrc=e[0].thumbnail_large,a.elements.thumbnails[i].style.backgroundImage="url("+t.thumbnailSrc+")"},!1),n.addEventListener("error",function(){console.error("An error occurred while loading the Vimeo thumbnail")},!1),n.addEventListener("abort",function(){console.error("The Vimeo thumbnail load has been cancelled by the user")},!1),console.log("Sending request for Vimeo metadata to "+e),n.open("GET",e,!0),n.send()}(e,t);break;default:throw new Error("Invalid video host: "+e.videoHost)}else(i=document.createElement("div")).style.backgroundImage="url("+e.src+")",i.style.backgroundSize="contain",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="50% 50%",r=e.src;i.setAttribute("data-hg-carousel-main-media","data-hg-carousel-main-media"),i.style.position="absolute",i.style.top="0",i.style.left=100*t+"%",i.style.width="100%",i.style.height="0",i.style.padding="56.25% 0 0 0",(n=document.createElement("div")).setAttribute("data-hg-carousel-thumbnail","data-hg-carousel-thumbnail"),n.style.backgroundImage="url("+r+")",n.style.backgroundSize="contain",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="50% 50%",n.style.width=m.thumbnailWidth+"px",n.style.height=m.thumbnailHeight+"px",n.style.styleFloat="left",n.style.cssFloat="left",(o=document.createElement("div")).setAttribute("data-hg-carousel-thumbnail-screen","data-hg-carousel-thumbnail-screen"),o.style.width="100%",o.style.height="100%",o.style.cursor="pointer",o.addEventListener("click",f.bind(a,t),!1),a.elements.mainMedia.push(i),a.elements.thumbnails.push(n),a.elements.thumbnailScreens.push(o),a.elements.mainMediaRibbon.appendChild(i),a.elements.thumbnailsRibbon.appendChild(n),n.appendChild(o)}),0<a.mediaMetadata.length&&a.elements.thumbnails[0].setAttribute("data-hg-selected","data-hg-selected")}function l(){this.elements.captionsText.innerHTML=this.mediaMetadata[this.currentIndex].description,this.elements.captionsPanel.setAttribute("data-hg-selected","data-hg-selected")}function s(){this.elements.mainMediaRibbon.style.left=100*-this.currentIndexPositionRatio+"%",this.elements.thumbnailsRibbon.style.left="calc(50% - "+(m.thumbnailWidth/2+this.currentIndexPositionRatio*m.thumbnailWidth)+"px"}function c(){this.parent.removeChild(this.elements.container),this.elements.container=null}(m={thumbnailHeight:80,thumbnailRibbonPadding:3,prevNextButtonPadding:10,prevNextButtonHeight:41,prevNextButtonWidth:24,aspectRatio:16/9,vimeoMetadataBaseUrl:"http://vimeo.com/api/v2/video",computeDependentValues:function(){m.thumbnailWidth=m.thumbnailHeight*m.aspectRatio}}).computeDependentValues(),e=document.querySelector("body"),t=document.createElementNS(window.hg.util.svgNamespace,"svg"),i=document.createElementNS(window.hg.util.svgNamespace,"symbol"),n=document.createElementNS(window.hg.util.svgNamespace,"path"),e.appendChild(t),t.appendChild(i),i.appendChild(n),t.style.display="none",i.setAttribute("id","chevron-left"),i.setAttribute("viewBox","0 0 247.88 428.75"),n.setAttribute("d","M149.03125,428.29625,0.54125,214.36625,149.03125,0.44725l97.959,0.000001-148.49,213.92,148.49,213.92z"),o.config=m,window.hg=window.hg||{},window.hg.Carousel=o,console.log("Carousel module loaded")}(),function(){var w={};function e(e,t,i,n){var o=this;o.index=e,o.parent=t,o.postData=i,o.isVertical=n,o.actualContentAreaWidth=w.targetContentAreaWidth,o.isComplete=!0,o.svg=null,o.svgDefs=null,o.originalTiles=[],o.originalBorderTiles=[],o.contentTiles=[],o.originalContentInnerIndices=null,o.innerIndexOfLastContentTile=null,o.originalCenter=null,o.currentCenter=null,o.panCenter=null,o.isPostOpen=!1,o.pagePost=null,o.isTransitioning=!1,o.expandedTile=null,o.sectors=null,o.allTiles=null,o.allNonContentTiles=null,o.lastExpansionJob=null,o.scrollTop=Number.NaN,o.annotations=new window.hg.Annotations(o),o.actualContentAreaWidth=Number.NaN,o.rowDeltaY=Number.NaN,o.tileDeltaX=Number.NaN,o.tileNeighborDistance=Number.NaN,o.oddRowTileCount=Number.NaN,o.evenRowTileCount=Number.NaN,o.oddRowXOffset=Number.NaN,o.rowCount=Number.NaN,o.evenRowXOffset=Number.NaN,o.contentAreaLeft=Number.NaN,o.contentAreaRight=Number.NaN,o.oddRowContentStartIndex=Number.NaN,o.evenRowContentStartIndex=Number.NaN,o.oddRowContentTileCount=Number.NaN,o.evenRowContentTileCount=Number.NaN,o.oddRowContentEndIndex=Number.NaN,o.evenRowContentEndIndex=Number.NaN,o.actualContentInnerIndices=Number.NaN,o.innerIndexOfLastContentTile=Number.NaN,o.rowCount=Number.NaN,o.height=Number.NaN,o.resize=a,o.start=d,o.update=u,o.draw=g,o.cancel=h,o.init=f,o.setBackgroundColor=l,o.updateTileColor=s,o.updateTileMass=c,o.setHoveredTile=p,o.createPagePost=m,o.destroyPagePost=b,o.updateAllTilesCollection=y,o.computeContentIndices=r,o.parent.setAttribute("data-hg-grid-parent","data-hg-grid-parent"),function(){var e;(e=this).svg=document.createElementNS(window.hg.util.svgNamespace,"svg"),e.parent.appendChild(e.svg),e.svg.style.display="block",e.svg.style.position="relative",e.svg.style.width="100%",e.svg.style.height="100%",e.svg.style.zIndex="1000",e.svg.style.overflow="visible",e.svg.style.pointerEvents="none",e.svg.setAttribute("data-hg-svg","data-hg-svg"),e.svgDefs=document.createElementNS(window.hg.util.svgNamespace,"defs"),e.svg.appendChild(e.svgDefs)}.call(o),l.call(o),r.call(o),a.call(o)}function r(){for(var e,t=this,i=[],n=t.postData.length,o=0;o<n;o+=1)i[o]=1;for(n=1/w.contentDensity*t.postData.length,o=t.postData.length;o<n;o+=1)i[o]=0;for(i=window.hg.util.shuffle(i),t.originalContentInnerIndices=[],e=o=0,n=i.length;o<n;o+=1)i[o]&&(t.originalContentInnerIndices[e++]=o)}function t(){var e,t,i,n,o,r,a,l,s,c,d,u,g,h,p,m,b,f=this;for(f.originalTiles=[],f.originalBorderTiles=[],g=u=e=0,a=w.firstRowYOffset,i=f.rowCount,p=[],h=function(){var e,t,i;i=[],t=(e=this).oddRowTileCount>e.evenRowTileCount?e.oddRowTileCount:e.evenRowTileCount,e.isVertical?(i[0]=1-t,i[1]=1,i[2]=t,i[3]=t-1,i[4]=-1):(i[0]=2*-t+1,i[1]=1-t,i[2]=t,i[3]=2*t-1,i[4]=t-1),i[5]=-t;return i}.call(f),m=f.oddRowTileCount>f.evenRowTileCount,t=0;t<i;t+=1,a+=f.rowDeltaY)for(d=t%2==0,b=m&&d||!m&&!d,o=d?(r=f.oddRowXOffset,f.oddRowTileCount):(r=f.evenRowXOffset,f.evenRowTileCount),n=0;n<o;e+=1,n+=1,r+=f.tileDeltaX)l=d?n<f.oddRowContentStartIndex||n>f.oddRowContentEndIndex:n<f.evenRowContentStartIndex||n>f.evenRowContentEndIndex,c=(s=f.isVertical?0===n||n===o-1||0===t||t===i-1:t<=1||i-2<=t||b&&(0===n||n===o-1))&&(f.isVertical?!(0!==n&&n!==o-1||0!==t&&t!==i-1):(t<=1||i-2<=t)&&b&&(0===n||n===o-1)),f.originalTiles[e]=new window.hg.Tile(f.svg,f,r,a,w.tileOuterRadius,f.isVertical,w.tileHue,w.tileSaturation,w.tileLightness,null,e,t,n,l,s,c,b,w.tileMass),s&&f.originalBorderTiles.push(f.originalTiles[e]),l||(u===f.actualContentInnerIndices[g]&&(f.originalTiles[e].setContent(f.postData[g]),f.contentTiles[g]=f.originalTiles[e],g+=1),u+=1),p[e]=v.call(f,t,i,n,o,b,h);!function(e){var t,i,n,o;for(o=[],t=0,n=this.originalTiles.length;t<n;t+=1){for(i=0,0;i<6;i+=1)o[i]=isNaN(e[t][i])?null:this.originalTiles[t+e[t][i]];this.originalTiles[t].setNeighborTiles(o)}}.call(f,p),y.call(f,f.originalTiles)}function v(e,t,i,n,o,r){r=r.slice(0);return this.isVertical?(o?(0===i&&(r[3]=Number.NaN,r[4]=Number.NaN,r[5]=Number.NaN),i===n-1&&(r[0]=Number.NaN,r[1]=Number.NaN,r[2]=Number.NaN)):(0===i&&(r[4]=Number.NaN),i===n-1&&(r[1]=Number.NaN)),0===e&&(r[0]=Number.NaN,r[5]=Number.NaN),e===t-1&&(r[2]=Number.NaN,r[3]=Number.NaN)):(o&&(0===i&&(r[4]=Number.NaN,r[5]=Number.NaN),i===n-1&&(r[1]=Number.NaN,r[2]=Number.NaN)),0===e?(r[0]=Number.NaN,r[1]=Number.NaN,r[5]=Number.NaN):1===e&&(r[0]=Number.NaN),e===t-1?(r[2]=Number.NaN,r[3]=Number.NaN,r[4]=Number.NaN):e===t-2&&(r[3]=Number.NaN)),r}function a(){var e=this;e.allTiles&&e.allTiles.forEach(function(e){e.destroy()}),e.isPostOpen&&e.pagePost.destroy(),e.originalCenter={x:Number.NaN,y:Number.NaN},e.currentCenter={x:Number.NaN,y:Number.NaN},e.panCenter={x:Number.NaN,y:Number.NaN},e.isPostOpen=!1,e.isTransitioning=!1,e.expandedTile=null,e.sectors=[],e.allTiles=null,e.allNonContentTiles=null,e.lastExpansionJob=null,e.parent.style.overflowX="hidden",e.parent.style.overflowY="auto",function(){var e=this.svg;for(this.annotations.destroyAnnotations();e.firstChild;)e.removeChild(e.firstChild);this.svg.appendChild(this.svgDefs)}.call(e),function(){var e,t,i,n,o,r,a=this,l=a.parent.clientWidth,s=.5*l,c=a.parent.clientHeight;for(a.originalCenter.x=s,a.originalCenter.y=.5*c,a.currentCenter.x=a.originalCenter.x,a.currentCenter.y=a.originalCenter.y,a.panCenter.x=a.originalCenter.x,a.panCenter.y=a.originalCenter.y,a.actualContentAreaWidth=l<w.targetContentAreaWidth?l:w.targetContentAreaWidth,a.isVertical?(a.rowDeltaY=1.5*w.tileOuterRadius+w.tileGap*w.sqrtThreeOverTwo,a.tileDeltaX=w.tileShortLengthWithGap,a.oddRowTileCount=2*Math.ceil((s-(w.tileInnerRadius+w.tileGap))/w.tileShortLengthWithGap)+1,a.evenRowTileCount=2*Math.ceil((s-(w.tileShortLengthWithGap+.5*w.tileGap))/w.tileShortLengthWithGap)+2,a.oddRowXOffset=s-w.tileShortLengthWithGap*(a.oddRowTileCount-1)/2,a.rowCount=Math.ceil((c-(w.firstRowYOffset+2*w.tileOuterRadius+w.tileGap*Math.sqrt(3)))/a.rowDeltaY)+2):(a.rowDeltaY=w.tileInnerRadius+.5*w.tileGap,a.tileDeltaX=3*w.tileOuterRadius+w.tileGap*Math.sqrt(3),a.oddRowTileCount=2*Math.ceil((s-(a.tileDeltaX-w.tileOuterRadius))/a.tileDeltaX)+1,a.evenRowTileCount=2*Math.ceil((s-(a.tileDeltaX+w.tileGap*w.sqrtThreeOverTwo+.5*w.tileOuterRadius))/a.tileDeltaX)+2,a.oddRowXOffset=s-a.tileDeltaX*(a.oddRowTileCount-1)/2,a.rowCount=Math.ceil((c-(w.firstRowYOffset+3*w.tileInnerRadius+2*w.tileGap))/a.rowDeltaY)+4),a.evenRowXOffset=a.oddRowXOffset+(a.evenRowTileCount>a.oddRowTileCount?-1:1)*a.tileDeltaX*.5,a.contentAreaLeft=s-.5*a.actualContentAreaWidth,a.contentAreaRight=a.contentAreaLeft+a.actualContentAreaWidth,a.isVertical?(a.oddRowContentStartIndex=Math.ceil((a.contentAreaLeft-(a.oddRowXOffset-w.tileInnerRadius))/a.tileDeltaX),a.evenRowContentStartIndex=Math.ceil((a.contentAreaLeft-(a.evenRowXOffset-w.tileInnerRadius))/a.tileDeltaX)):(a.oddRowContentStartIndex=Math.ceil((a.contentAreaLeft-(a.oddRowXOffset-w.tileOuterRadius))/a.tileDeltaX),a.evenRowContentStartIndex=Math.ceil((a.contentAreaLeft-(a.evenRowXOffset-w.tileOuterRadius))/a.tileDeltaX)),a.oddRowContentTileCount=a.oddRowTileCount-2*a.oddRowContentStartIndex,a.evenRowContentTileCount=a.evenRowTileCount-2*a.evenRowContentStartIndex,a.oddRowContentEndIndex=a.oddRowContentStartIndex+a.oddRowContentTileCount-1,a.evenRowContentEndIndex=a.evenRowContentStartIndex+a.evenRowContentTileCount-1,a.actualContentInnerIndices=[],o=Math.ceil(w.contentStartingRowIndex/2)*a.oddRowContentTileCount+Math.floor(w.contentStartingRowIndex/2)*a.evenRowContentTileCount,i=0,n=a.originalContentInnerIndices.length;i<n;i+=1)a.actualContentInnerIndices[i]=a.originalContentInnerIndices[i]+o;for(a.innerIndexOfLastContentTile=a.actualContentInnerIndices[a.actualContentInnerIndices.length-1],r=o+a.innerIndexOfLastContentTile+1,t=e=0;e<r;)e+=t%2==0?a.oddRowContentTileCount:a.evenRowContentTileCount,t+=1;t>a.rowCount?(a.rowCount=t+(a.isVertical?0:1),a.height=(a.rowCount-2)*a.rowDeltaY):a.height=c}.call(e),t.call(e),function(){console.log("// --- Grid Info: ------- //"),console.log("// - Tile count="+this.originalTiles.length),console.log("// - Row count="+this.rowCount),console.log("// - Odd row tile count="+this.oddRowTileCount),console.log("// - Even row tile count="+this.evenRowTileCount),console.log("// ------------------------- //")}.call(e)}function l(){this.parent.style.backgroundColor="hsl("+w.backgroundHue+","+w.backgroundSaturation+"%,"+w.backgroundLightness+"%)"}function s(){for(var e=0,t=this.allNonContentTiles.length;e<t;e+=1)this.allNonContentTiles[e].setColor(w.tileHue,w.tileSaturation,w.tileLightness)}function c(e){for(var t=0,i=this.allTiles.length;t<i;t+=1)this.allTiles[t].particle.m=e}function d(){this.isComplete=!1}function u(e,t){for(var i=0,n=this.allTiles.length;i<n;i+=1)this.allTiles[i].update(e,t)}function g(){for(var e=0,t=this.allTiles.length;e<t;e+=1)this.allTiles[e].draw();this.isPostOpen&&this.pagePost.draw()}function h(){this.isComplete=!0}function p(e){this.hoveredTile&&this.hoveredTile.setIsHighlighted(!1),e&&e.setIsHighlighted(!0),this.hoveredTile=e}function m(e,t){return this.pagePost=new window.hg.PagePost(e,t),this.pagePost}function b(){this.pagePost.destroy(),this.pagePost=null}function y(e){var t,i,n,o=this;for(o.allTiles=e,o.allNonContentTiles=[],t=n=0,i=e.length;t<i;t+=1)e[t].holdsContent||(o.allNonContentTiles[n++]=e[t]);o.annotations.destroyAnnotations(),o.annotations.createAnnotations(),function(){for(var e=0,t=this.allTiles.length;e<t;e+=1)this.allTiles[e].element.setAttribute("data-hg-index",e)}.call(o)}function f(){w.computeDependentValues()}w.targetContentAreaWidth=900,w.backgroundHue=230,w.backgroundSaturation=1,w.backgroundLightness=4,w.tileHue=230,w.tileSaturation=67,w.tileLightness=22,w.tileOuterRadius=812<document.documentElement.clientWidth?100:72,w.tileGap=12,w.contentStartingRowIndex=2,w.firstRowYOffset=-.8*w.tileOuterRadius,w.contentDensity=1,w.tileMass=1,w.computeDependentValues=function(){w.sqrtThreeOverTwo=Math.sqrt(3)/2,w.twoOverSqrtThree=2/Math.sqrt(3),w.tileInnerRadius=w.tileOuterRadius*w.sqrtThreeOverTwo,w.longGap=w.tileGap*w.twoOverSqrtThree,w.tileShortLengthWithGap=2*w.tileInnerRadius+w.tileGap,w.tileLongLengthWithGap=2*w.tileOuterRadius+w.longGap},w.computeDependentValues(),e.config=w,window.hg=window.hg||{},window.hg.Grid=e,console.log("Grid module loaded")}(),function(){var i={};function e(e){this.grid=e,this.createClickAnimation=o,function(){var i;function n(e){var t;return e.target.getAttribute("data-hg-tile")?(t=e.target.getAttribute("data-hg-index"),i.grid.allTiles[t]):e.target.parentElement.getAttribute("data-hg-tile")?(t=e.target.parentElement.getAttribute("data-hg-index"),i.grid.allTiles[t]):null}i=this,document.addEventListener("mouseover",function(e){(e=n(e))&&(e.element.getAttribute("data-hg-post-tile"),i.grid.setHoveredTile(e))},!1),document.addEventListener("mouseout",function(e){var t;e.relatedTarget&&"HTML"!==e.relatedTarget.nodeName?(t=n(e))&&(t.element.getAttribute("data-hg-post-tile"),i.grid.setHoveredTile(null),window.hg.controller.transientJobs.HighlightHoverJob.create(i.grid,t),e.stopPropagation()):(console.log("The mouse left the viewport"),i.grid.setHoveredTile(null))},!1),document.addEventListener("mousemove",function(e){e.target.getAttribute("data-hg-post-tile")||e.target.getAttribute("data-hg-tile")},!1),document.addEventListener("mousedown",function(e){e.target.getAttribute("data-hg-post-tile")},!1),document.addEventListener("mouseup",function(e){var t;0===e.button&&(t=n(e))&&(t.element.getAttribute("data-hg-post-tile"),o.call(i,i.grid,t))},!1),document.addEventListener("keydown",function(e){"Escape"!==e.key&&"Esc"!==e.key||r.call(i,!1)},!1)}.call(this)}function o(e,t){t.holdsContent?(i.possibleClickAnimations[i.contentTileClickAnimation](e,t),r.call(this,!0),window.hg.controller.transientJobs.OpenPostJob.create(e,t)):(i.possibleClickAnimations[i.emptyTileClickAnimation](e,t),r.call(this,!1))}function r(e){this.grid.isPostOpen&&window.hg.controller.transientJobs.ClosePostJob.create(this.grid,this.grid.expandedTile,e)}i.contentTileClickAnimation="Radiate Highlight",i.emptyTileClickAnimation="Radiate Highlight",i.possibleClickAnimations={"Radiate Highlight":window.hg.controller.transientJobs.HighlightRadiateJob.create,"Radiate Lines":window.hg.controller.transientJobs.LinesRadiateJob.create,"Random Line":window.hg.controller.transientJobs.LineJob.create,None:function(){}},e.config=i,window.hg=window.hg||{},window.hg.Input=e,console.log("Input module loaded")}(),function(){var N,e,t,i,n;function o(e,t){var i=this;i.tile=e,i.elements=null,i.carousel=null,i.opacity=0,i.paddingX=Number.NaN,i.paddingY=Number.NaN,i.halfWidth=Number.NaN,i.halfHeight=Number.NaN,i.innerWrapperPaddingFromCss=Number.NaN,i.center={x:t.x,y:t.y},i.loadCarouselMedia=r,i.draw=A,i.destroy=a,function(){var t=this,e=new showdown.Converter;e.setFlavor("github");var i=window.hg.Grid.config.tileShortLengthWithGap*(window.hg.OpenPostJob.config.expandedDisplacementTileCount+4.25),n=window.hg.Grid.config.longGap*(2*window.hg.OpenPostJob.config.expandedDisplacementTileCount)+window.hg.Grid.config.tileOuterRadius*(3*window.hg.OpenPostJob.config.expandedDisplacementTileCount+2);switch(window.hg.OpenPostJob.config.expandedDisplacementTileCount){case 2:n+=window.hg.Grid.config.tileOuterRadius;break;case 1:n+=3*window.hg.Grid.config.tileOuterRadius,i-=window.hg.Grid.config.tileShortLengthWithGap;break;case 0:n+=4*window.hg.Grid.config.tileOuterRadius,i-=window.hg.Grid.config.tileShortLengthWithGap}var o,r,a,l,s,c,d=1.4*window.hg.Grid.config.tileShortLengthWithGap,u=2.65*window.hg.Grid.config.tileOuterRadius;l=t.tile.grid.isVertical?(o=i,r=n,a=d,u):(o=n,r=i,a=u,d);o-=2*a,r-=2*(l+=32);var g=NaN;r+2*l>window.innerHeight&&(l=100,r=window.innerHeight-2*l,g=68);window.hg.util.isSmallScreen()&&(o=window.innerWidth,a=0);t.paddingX=a,t.paddingY=l,t.halfWidth=o/2,t.halfHeight=r/2,s="hsl("+window.hg.Grid.config.backgroundHue+","+window.hg.Grid.config.backgroundSaturation+"%,"+window.hg.Grid.config.backgroundLightness+"%)",c="hsla("+window.hg.Grid.config.backgroundHue+","+window.hg.Grid.config.backgroundSaturation+"%,"+window.hg.Grid.config.backgroundLightness+"%,0)";var h=document.createElement("div"),p=document.createElement("div"),m=document.createElement("div"),b=document.createElement("h1"),f=document.createElement("div"),w=document.createElement("a"),v=document.createElement("div"),y=document.createElement("div"),C=document.createElement("div"),x=document.createElement("div"),T=document.createElement("div"),S=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div");t.tile.grid.parent.appendChild(h),h.appendChild(p),p.appendChild(m),m.appendChild(w),m.appendChild(v),m.appendChild(y),m.appendChild(C),m.appendChild(x),m.appendChild(b),m.appendChild(T),m.appendChild(f),m.appendChild(S),h.appendChild(u),h.appendChild(d),t.elements=[],t.elements.outerWrapper=p,t.elements.container=h,t.elements.title=b,t.elements.content=f,t.elements.closeButton=w,t.elements.logo=v,t.elements.date=y,t.elements.urls=T,t.elements.categories=S,h.setAttribute("data-hg-post-container","data-hg-post-container"),h.style.position="absolute",h.style.width=o+a+"px",h.style.height=r+2*l+"px",h.style.margin="0",h.style.padding="0",h.style.overflow="hidden",h.style.zIndex=window.hg.controller.isSafariBrowser?"1500":"500",p.setAttribute("data-hg-post-outer-wrapper","data-hg-post-outer-wrapper"),p.style.width=o+"px",p.style.height=r+2*l+"px",p.style.margin="0",p.style.padding="0 0 0 "+a+"px",p.style.overflow="auto",p.style.webkitOverflowScrolling="touch",m.setAttribute("data-hg-post-inner-wrapper","data-hg-post-inner-wrapper"),h=parseInt(window.getComputedStyle(m,null).getPropertyValue("padding-top")),p=h+l,m.style.padding=p+"px "+h+"px "+p+"px "+h+"px",m.style.minHeight=r-2*h+"px",m.style.overflowX="hidden",t.innerWrapperPaddingFromCss=h,b.setAttribute("data-hg-post-title","data-hg-post-title"),b.innerHTML=t.tile.postData.titleLong,u.style.position="absolute",u.style.top="0",u.style.left=a+"px",u.style.height=l+"px",u.style.width=o+"px",u.style.backgroundColor="#000000",u.style.background="linear-gradient(0,"+c+","+s+" 75%)",u.style.pointerEvents="none",d.style.position="absolute",d.style.bottom="0",d.style.left=a+"px",d.style.height=l+"px",d.style.width=o+"px",d.style.backgroundColor="#000000",d.style.background="linear-gradient(0,"+s+" 25%,"+c+")",d.style.pointerEvents="none",f.setAttribute("data-hg-post-content","data-hg-post-content"),f.innerHTML=e.makeHtml(t.tile.postData.content),w.setAttribute("data-hg-post-close","data-hg-post-close"),w.setAttribute("href","#"),g&&(w.style.top=g+"px");w.addEventListener("click",function(){var e=t.tile.grid;e.isPostOpen&&window.hg.controller.transientJobs.ClosePostJob.create(e,e.expandedTile,!1)},!1);e=document.createElementNS(window.hg.util.svgNamespace,"svg"),g=document.createElementNS(window.hg.util.svgNamespace,"use");w.appendChild(e),e.appendChild(g),e.setAttribute("width","40"),e.setAttribute("height","40"),g.setAttributeNS(window.hg.util.xlinkNamespace,"xlink:href","#close"),v.setAttribute("data-hg-post-logo","data-hg-post-logo"),v.style.backgroundImage="url("+t.tile.postData.logoSrc+")",y.setAttribute("data-hg-post-date","data-hg-post-date"),function(){var e=this.elements.date,t=this.tile.postData.date;e.innerHTML="object"==typeof t?i(t.start)+" &ndash; "+i(t.end):i(t);this.tile.postData.date||(e.style.display="none");function i(e){var t;if("present"===e.toLowerCase())return e;switch((t=e.split("/")).length){case 1:return t[0];case 2:return N.monthLabels[t[0]]+" "+t[1];case 3:return N.monthLabels[t[0]]+" "+t[1]+", "+t[2];default:throw new Error("Invalid date string format: "+e)}}}.call(t),C.setAttribute("data-hg-post-location","data-hg-post-location"),C.innerHTML=t.tile.postData.location,x.setAttribute("data-hg-post-job-title","data-hg-post-job-title"),x.innerHTML=t.tile.postData.jobTitle,T.setAttribute("data-hg-post-urls","data-hg-post-urls"),function(){var t=this,r=t.elements.urls,e=Object.keys(t.tile.postData.urls);e.forEach(function(e){!function(e,t){var i,n,o;n=t.replace(/^.*:\/\//,""),(i=N.urlLabels[e])||(console.warn("Unknown URL type: "+e),i=e);o=document.createElement("p"),e=document.createElement("a"),o.innerHTML=i+": ",o.style.overflow="hidden",o.style.whiteSpace="nowrap",o.style.textOverflow="ellipsis",e.innerHTML=n,e.setAttribute("href",t),o.appendChild(e),r.appendChild(o)}(e,t.tile.postData.urls[e])}),e.length||(r.style.display="none")}.call(t),S.setAttribute("data-hg-post-categories","data-hg-post-categories"),function(){var i=this.elements.categories;this.tile.postData.categories.forEach(function(e){var t=document.createElement("span");i.appendChild(t),t.setAttribute("data-hg-post-category-card","data-hg-post-category-card"),t.style.display="inline-block",t.innerHTML=e}),this.tile.postData.categories.length||(i.style.display="none")}.call(t),t.carousel=new window.hg.Carousel(t.tile.grid,t,m,t.tile.postData.images,t.tile.postData.videos,!0),m.removeChild(t.carousel.elements.container),m.insertBefore(t.carousel.elements.container,T),setTimeout(function(){t.elements.outerWrapper&&t.elements.outerWrapper.scrollTo(0,0)},10),A.call(t)}.call(i),console.log("PagePost created: postId="+e.postData.id+", tileIndex="+e.originalIndex)}function r(){this.carousel.loadMedia()}function A(){var e=this;e.elements.container.style.left=e.center.x-e.halfWidth-e.paddingX+"px",e.elements.container.style.top=e.center.y-e.halfHeight-e.paddingY+"px",e.elements.container.style.opacity=e.opacity,e.carousel.draw()}function a(){this.carousel.destroy(),this.tile.grid.parent.removeChild(this.elements.container),this.elements=null}(N={urlLabels:{homepage:"Homepage",published:"Published at",demo:"Demo",npm:"NPM registry",bower:"Bower registry",codepen:"CodePen",github:"Source code",googleCode:"Source code",githubProfile:"GitHub",linkedin:"LinkedIn",twitter:"Twitter",facebook:"Facebook",googlePlus:"Google+",reverbNation:"Reverb Nation",resume:"Resume",youtube:"YouTube",itchio:"itch.io","ludum-dare":"Ludum Dare","global-game-jam":"Global Game Jam",gmtk:"GMTK game jam",devlog:"Devlog","snoring-cat":"Snoring Cat LLC","chrome-web-store":"Chrome Web Store","play-store":"Google Play Store","app-store":"Apple App Store","godot-asset-library":"Godot Asset Library"},monthLabels:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"},computeDependentValues:function(){}}).computeDependentValues(),e=document.querySelector("body"),t=document.createElementNS(window.hg.util.svgNamespace,"svg"),i=document.createElementNS(window.hg.util.svgNamespace,"symbol"),n=document.createElementNS(window.hg.util.svgNamespace,"path"),e.appendChild(t),t.appendChild(i),i.appendChild(n),t.style.display="none",i.setAttribute("id","close"),i.setAttribute("width","40"),i.setAttribute("height","40"),i.setAttribute("viewBox","0 0 12.9 9.1"),n.setAttribute("d","M1.8-1.9 0-0.1 4.6 4.6 0 9.2l1.8 1.8 4.6-4.6 4.6 4.6 1.8-1.8-4.6-4.6 4.6-4.6-1.8-1.8-4.6 4.6z"),window.hg.util.addClass(n,"close-path"),o.config=N,window.hg=window.hg||{},window.hg.PagePost=o,console.log("PagePost module loaded")}(),function(){var e={};function t(e,t,i,n){var o=this;o.grid=e,o.baseTile=t,o.index=i,o.expandedDisplacementTileCount=n,o.originalAnchor={x:Number.NaN,y:Number.NaN},o.currentAnchor={x:Number.NaN,y:Number.NaN},o.majorNeighborDelta={x:Number.NaN,y:Number.NaN},o.minorNeighborDelta={x:Number.NaN,y:Number.NaN},o.expandedDisplacement={x:Number.NaN,y:Number.NaN},o.tiles=null,o.tilesByIndex=null,o.newTiles=null,o.initializeExpandedStateExternalTileNeighbors=a,o.destroy=l,o.setOriginalPositionForExpansion=c,o.updateCurrentPosition=d,function(){var e,t,i;(e=this).majorNeighborIndex=e.index,e.minorNeighborIndex=(e.index+1)%6,e.majorNeighborDelta.x=e.baseTile.neighborStates[e.majorNeighborIndex].tile.originalAnchor.x-e.baseTile.originalAnchor.x,e.majorNeighborDelta.y=e.baseTile.neighborStates[e.majorNeighborIndex].tile.originalAnchor.y-e.baseTile.originalAnchor.y,e.minorNeighborDelta.x=e.baseTile.neighborStates[e.minorNeighborIndex].tile.originalAnchor.x-e.baseTile.originalAnchor.x,e.minorNeighborDelta.y=e.baseTile.neighborStates[e.minorNeighborIndex].tile.originalAnchor.y-e.baseTile.originalAnchor.y,i=(e.index+5)%6,t=e.baseTile.neighborStates[i].tile.originalAnchor.x-e.baseTile.originalAnchor.x,i=e.baseTile.neighborStates[i].tile.originalAnchor.y-e.baseTile.originalAnchor.y,e.expandedDisplacement.x=e.expandedDisplacementTileCount*t,e.expandedDisplacement.y=e.expandedDisplacementTileCount*i,e.originalAnchor.x=e.baseTile.originalAnchor.x+e.majorNeighborDelta.x,e.originalAnchor.y=e.baseTile.originalAnchor.y+e.majorNeighborDelta.y,e.currentAnchor.x=e.originalAnchor.x,e.currentAnchor.y=e.originalAnchor.y}.call(o),function(){var e;(e=this).tilesByIndex=[],e.newTiles=[],e.tiles=[],function(){var o;o=this,function(){var e,t,i=0,n=o.baseTile.neighborStates[o.majorNeighborIndex].tile;do{for(e=n,t=0,o.tilesByIndex[i]=o.tilesByIndex[i]||[];o.tilesByIndex[i][t]||r.call(o,e,i,t),t++,e.neighborStates[o.minorNeighborIndex]&&(e=e.neighborStates[o.minorNeighborIndex].tile););}while(i++,n.neighborStates[o.majorNeighborIndex]&&(n=n.neighborStates[o.majorNeighborIndex].tile))}(),function(){var e,t,i=0,n=o.baseTile.neighborStates[o.majorNeighborIndex].tile;do{for(e=n,t=0;o.tilesByIndex[t]=o.tilesByIndex[t]||[],o.tilesByIndex[t][i]||r.call(o,e,t,i),t++,e.neighborStates[o.majorNeighborIndex]&&(e=e.neighborStates[o.majorNeighborIndex].tile););}while(i++,n.neighborStates[o.minorNeighborIndex]&&(n=n.neighborStates[o.minorNeighborIndex].tile))}()}.call(e),function(){var l,e;l=this,function(e){var t=l.baseTile.originalAnchor.x+l.majorNeighborDelta.x,i=l.baseTile.originalAnchor.y+l.majorNeighborDelta.y,n=0,o=0,r=t,a=i;do{for(l.tilesByIndex[n]=l.tilesByIndex[n]||[];l.tilesByIndex[n][o]||s.call(l,n,o,r,a),o++,r+=l.minorNeighborDelta.x,a+=l.minorNeighborDelta.y,r>=e.minX&&r<=e.maxX&&a>=e.minY&&a<=e.maxY;);}while(o=0,r=t+ ++n*l.majorNeighborDelta.x,a=i+n*l.majorNeighborDelta.y,r>=e.minX&&r<=e.maxX&&a>=e.minY&&a<=e.maxY)}(e=function(){var e=window.innerWidth/2+window.hg.Grid.config.tileLongLengthWithGap,t=window.innerHeight/2+window.hg.Grid.config.tileLongLengthWithGap,i=l.baseTile.originalAnchor.x-e,n=l.baseTile.originalAnchor.x+e,e=l.baseTile.originalAnchor.y-t,t=l.baseTile.originalAnchor.y+t;return{minX:i-=l.expandedDisplacement.x,maxX:n-=l.expandedDisplacement.x,minY:e-=l.expandedDisplacement.y,maxY:t-=l.expandedDisplacement.y}}()),function(e){var t=l.baseTile.originalAnchor.x+l.majorNeighborDelta.x,i=l.baseTile.originalAnchor.y+l.majorNeighborDelta.y,n=0,o=0,r=t,a=i;do{for(;l.tilesByIndex[n]=l.tilesByIndex[n]||[],l.tilesByIndex[n][o]||s.call(l,n,o,r,a),n++,r+=l.majorNeighborDelta.x,a+=l.majorNeighborDelta.y,r>=e.minX&&r<=e.maxX&&a>=e.minY&&a<=e.maxY;);}while(n=0,r=t+ ++o*l.minorNeighborDelta.x,a=i+o*l.minorNeighborDelta.y,r>=e.minX&&r<=e.maxX&&a>=e.minY&&a<=e.maxY)}(e)}.call(e),function(){var e,t;for(e=0;this.tilesByIndex[e];e+=1)for(t in this.tilesByIndex[e])!function(e,t,i){var n,o,r,a;for(n=e.tilesByIndex[t][i],o=0;o<6;o+=1){switch(o){case e.index:r=t+1,a=i;break;case(e.index+1)%6:r=t,a=i+1;break;case(e.index+2)%6:r=t-1,a=i+1;break;case(e.index+3)%6:r=t-1,a=i;break;case(e.index+4)%6:r=t,a=i-1;break;case(e.index+5)%6:r=t+1,a=i-1;break;default:throw new Error("Invalid neighborRelationIndex: "+o)}e.tilesByIndex[r]&&e.tilesByIndex[r][a]&&window.hg.Tile.setTileNeighborState(n,o,e.tilesByIndex[r][a])}}(this,e,parseInt(t))}.call(e),function(){var e,t,i;for(t in e=0,this.tilesByIndex)for(i in this.tilesByIndex[t])this.tiles[e++]=this.tilesByIndex[t][i]}.call(e)}.call(o)}function r(e,t,i){this.tilesByIndex[t][i]=e,window.hg.Tile.initializeTileExpandedState(e,this,t,i),e.sectorAnchorOffset.x=e.originalAnchor.x-this.originalAnchor.x,e.sectorAnchorOffset.y=e.originalAnchor.y-this.originalAnchor.y}function s(e,t,i,n){var o=this,n=new window.hg.Tile(o.grid.svg,o.grid,i,n,window.hg.Grid.config.tileOuterRadius,o.grid.isVertical,window.hg.Grid.config.tileHue,window.hg.Grid.config.tileSaturation,window.hg.Grid.config.tileLightness,null,Number.NaN,Number.NaN,Number.NaN,!0,!1,!1,!1,window.hg.Grid.config.tileMass);return r.call(o,n,e,t),o.newTiles[o.newTiles.length]=n}function a(e){var t,i=this,n=(i.index+2)%6,o=(i.index+3)%6,r=e[(i.index+1)%6],a=i.tilesByIndex[0],l=r.tilesByIndex,s=i.expandedDisplacementTileCount,c=0;for(a[s]&&window.hg.Tile.setTileNeighborState(a[s],n,r.tilesByIndex[c][0]),s+=1,t=a.length-1;s<t;s+=1)window.hg.Tile.setTileNeighborState(a[s],o,r.tilesByIndex[c][0]),c+=1,window.hg.Tile.setTileNeighborState(a[s],n,r.tilesByIndex[c][0]);for(a[s]&&(window.hg.Tile.setTileNeighborState(a[s],o,r.tilesByIndex[c][0]),r.tilesByIndex[c+=1]&&r.tilesByIndex[c][0]&&window.hg.Tile.setTileNeighborState(a[s],n,r.tilesByIndex[c][0])),t=i.expandedDisplacementTileCount+1,t=a.length<t?a.length:t,s=0;s<t;s+=1)a[s].expandedState.isBorderTile=!0;for(s=(s=a.length-1-i.expandedDisplacementTileCount)<0?0:s,t=l.length;s<t;s+=1)l[s][0]&&(l[s][0].expandedState.isBorderTile=!0);for(s=0,t=i.tilesByIndex.length;s<t;s+=1)i.tilesByIndex[s].length&&(i.tilesByIndex[s][i.tilesByIndex[s].length-1].expandedState.isBorderTile=!0)}function l(e){var t,i,n=this;if(e)for(t=0,i=n.tiles.length;t<i;t+=1)n.tiles[t].expandedState=null;for(t=0,i=n.newTiles.length;t<i;t+=1)n.newTiles[t].neighborStates=null,n.newTiles[t].destroy()}function c(e){var t,i,n,o=this,r=e?(n=o.expandedDisplacement.x,o.expandedDisplacement.y):(n=-o.expandedDisplacement.x,-o.expandedDisplacement.y);for(o.originalAnchor.x+=n,o.originalAnchor.y+=r,t=0,i=o.tiles.length;t<i;t+=1)o.tiles[t].originalAnchor.x+=n,o.tiles[t].originalAnchor.y+=r}function d(e,t){var i,n,o=this;for(o.currentAnchor.x=o.originalAnchor.x+e,o.currentAnchor.y=o.originalAnchor.y+t,i=0,n=o.tiles.length;i<n;i+=1)o.tiles[i].currentAnchor.x+=e,o.tiles[i].currentAnchor.y+=t}e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.Sector=t,console.log("Sector module loaded")}(),function(){var m;function e(e,t,i,n,o,r,a,l,s,c,d,u,g,h,p,m,b,f){var w=this;w.svg=e,w.grid=t,w.element=null,w.polygonElement=null,w.currentAnchor={x:i,y:n},w.originalAnchor={x:i,y:n},w.sectorAnchorOffset={x:Number.NaN,y:Number.NaN},w.outerRadius=o,w.isVertical=r,w.originalColor={h:a,s:l,l:s},w.currentColor={h:a,s:l,l:s},w.postData=c,w.holdsContent=!!c,w.tilePost=null,w.originalIndex=d,w.rowIndex=u,w.columnIndex=g,w.isMarginTile=h,w.isBorderTile=p,w.isCornerTile=m,w.isInLargerRow=b,w.expandedState=null,w.isHighlighted=!1,w.imageScreenOpacity=Number.NaN,w.neighborStates=[],w.vertices=null,w.currentVertexDeltas=null,w.originalVertexDeltas=null,w.expandedVertexDeltas=null,w.particle=null,w.setContent=x,w.setNeighborTiles=T,w.setColor=S,w.setIsHighlighted=N,w.update=A,w.draw=D,w.applyExternalForce=P,w.fixPosition=R,w.getNeighborStates=L,w.getIsBorderTile=E,w.setIsBorderTile=J,w.destroy=O,w.hide=M,w.show=k,function(){var e=this;e.originalVertexDeltas=I(e.outerRadius,e.isVertical),e.currentVertexDeltas=e.originalVertexDeltas.slice(0),e.vertices=[],y.call(e,e.currentAnchor.x,e.currentAnchor.y),v.call(e)}.call(w),function(e){var t;(t=this).particle={},t.particle.px=t.currentAnchor.x,t.particle.py=t.currentAnchor.y,t.particle.vx=0,t.particle.vy=0,t.particle.fx=0,t.particle.fy=0,t.particle.m=e,t.particle.forceAccumulatorX=0,t.particle.forceAccumulatorY=0}.call(w,f),w.holdsContent&&C.call(w)}function v(){var e=this,t=isNaN(e.originalIndex)?parseInt(1e6*Math.random()+1e3):e.originalIndex;e.element&&e.svg.removeChild(e.element),e.element=document.createElementNS(window.hg.util.svgNamespace,"polygon"),e.svg.appendChild(e.element),e.polygonElement=e.element,e.element.id="hg-"+t,e.element.setAttribute("data-hg-tile","data-hg-tile"),e.element.style.cursor="normal",e.element.style.pointerEvents="auto",D.call(e)}function y(e,t){for(var i=0,n=0;i<6;i+=1)this.vertices[n]=e+this.currentVertexDeltas[n++],this.vertices[n]=t+this.currentVertexDeltas[n++]}function C(){var e=this;!function(){var e=this,t=isNaN(e.originalIndex)?parseInt(1e6*Math.random()+1e3):e.originalIndex;e.element&&e.svg.removeChild(e.element),e.element=document.createElementNS(window.hg.util.svgNamespace,"a"),e.svg.appendChild(e.element),e.polygonElement=document.createElementNS(window.hg.util.svgNamespace,"polygon"),e.element.appendChild(e.polygonElement),e.element.id="hg-"+t,e.element.setAttribute("data-hg-tile","data-hg-tile"),e.element.style.cursor="pointer",e.element.style.pointerEvents="auto",e.element.setAttribute("href","#"+e.postData.id),D.call(e)}.call(e),e.element.setAttribute("data-hg-post-tilePost","data-hg-post-tilePost"),e.tilePost=new window.hg.TilePost(e),D.call(e)}function n(){v.call(this),this.element.removeAttribute("data-hg-post-tilePost"),this.tilePost.destroy(),this.tilePost=null}function x(e){var t=this,i=t.holdsContent;t.postData=e,t.holdsContent=!!e,i&&n.call(t),C.call(t)}function T(e){for(var t=0;t<6;t+=1)i(this,t,e[t])}function S(e,t,i){var n=this;n.isHighlighted&&(e+=window.hg.HighlightHoverJob.config.deltaHue,t+=window.hg.HighlightHoverJob.config.deltaSaturation,i+=window.hg.HighlightHoverJob.config.deltaLightness),n.originalColor.h=e,n.originalColor.s=t,n.originalColor.l=i,n.currentColor.h=e,n.currentColor.s=t,n.currentColor.l=i}function N(e){var t,i,n=this,o=e?n.isHighlighted?(t=n.originalColor.h,i=n.originalColor.s,n.originalColor.l):(t=n.originalColor.h+window.hg.HighlightHoverJob.config.deltaHue*window.hg.HighlightHoverJob.config.opacity,i=n.originalColor.s+window.hg.HighlightHoverJob.config.deltaSaturation*window.hg.HighlightHoverJob.config.opacity,n.originalColor.l+window.hg.HighlightHoverJob.config.deltaLightness*window.hg.HighlightHoverJob.config.opacity):n.isHighlighted?(t=n.originalColor.h-window.hg.HighlightHoverJob.config.deltaHue*window.hg.HighlightHoverJob.config.opacity,i=n.originalColor.s-window.hg.HighlightHoverJob.config.deltaSaturation*window.hg.HighlightHoverJob.config.opacity,n.originalColor.l-window.hg.HighlightHoverJob.config.deltaLightness*window.hg.HighlightHoverJob.config.opacity):(t=n.originalColor.h,i=n.originalColor.s,n.originalColor.l);n.originalColor.h=t,n.originalColor.s=i,n.originalColor.l=o,n.currentColor.h=t,n.currentColor.s=i,n.currentColor.l=o,n.isHighlighted=e}function A(e,t){var i,n,o,r,a,l,s,c,d,u,g,h,p=this;if(!p.particle.isFixed){for(o=p.getNeighborStates(),r=p.getIsBorderTile(),p.particle.forceAccumulatorX+=-m.dragCoeff*p.particle.vx,p.particle.forceAccumulatorY+=-m.dragCoeff*p.particle.vy,i=0,n=o.length;i<n;i+=1)(a=o[i])&&(a.springForceX?(p.particle.forceAccumulatorX+=a.springForceX,p.particle.forceAccumulatorY+=a.springForceY,a.springForceX=0,a.springForceY=0):(l=a.tile.particle.px-p.particle.px,s=a.tile.particle.py-p.particle.py,c=l*(a.tile.particle.vx-p.particle.vx)+s*(a.tile.particle.vy-p.particle.vy),d=Math.sqrt(l*l+s*s),h=s*(u=(m.neighborSpringCoeff*(d-a.restLength)+m.neighborDampingCoeff*c/d)/d),p.particle.forceAccumulatorX+=g=l*u,p.particle.forceAccumulatorY+=h,a.neighborsRelationshipObj.springForceX=-g,a.neighborsRelationshipObj.springForceY=-h));l=p.currentAnchor.x-p.particle.px,s=p.currentAnchor.y-p.particle.py,0<(d=Math.sqrt(l*l+s*s))&&(c=l*-p.particle.vx+s*-p.particle.vy,h=s*(u=r?(m.borderAnchorSpringCoeff*d+m.borderAnchorDampingCoeff*c/d)/d:(m.innerAnchorSpringCoeff*d+m.innerAnchorDampingCoeff*c/d)/d),p.particle.forceAccumulatorX+=g=l*u,p.particle.forceAccumulatorY+=h),p.particle.fx=p.particle.forceAccumulatorX/p.particle.m*t,p.particle.fy=p.particle.forceAccumulatorY/p.particle.m*t,p.particle.px+=p.particle.vx*t,p.particle.py+=p.particle.vy*t,p.particle.vx+=p.particle.fx,p.particle.vy+=p.particle.fy,p.particle.fx=p.particle.fx<m.forceSuppressionLowerThreshold&&p.particle.fx>m.forceSuppressionThresholdNegative?0:p.particle.fx,p.particle.fy=p.particle.fy<m.forceSuppressionLowerThreshold&&p.particle.fy>m.forceSuppressionThresholdNegative?0:p.particle.fy,p.particle.vx=p.particle.vx<m.velocitySuppressionLowerThreshold&&p.particle.vx>m.velocitySuppressionThresholdNegative?0:p.particle.vx,p.particle.vy=p.particle.vy<m.velocitySuppressionLowerThreshold&&p.particle.vy>m.velocitySuppressionThresholdNegative?0:p.particle.vy,p.particle.forceAccumulatorX=0,p.particle.forceAccumulatorY=0,y.call(p,p.particle.px,p.particle.py)}}function D(){for(var e,t=this,i=0,n="";i<12;)n+=t.vertices[i++]+","+t.vertices[i++]+" ";t.polygonElement.setAttribute("points",n),t.holdsContent?t.tilePost&&t.tilePost.draw():(e="hsl("+t.currentColor.h+","+t.currentColor.s+"%,"+t.currentColor.l+"%)",t.polygonElement.setAttribute("fill",e))}function P(e,t){this.particle.forceAccumulatorX+=e,this.particle.forceAccumulatorY+=t}function R(e,t){this.particle.isFixed=!0,this.particle.px=e,this.particle.py=t}function L(){return(this.grid.isPostOpen?this.expandedState:this).neighborStates}function E(){return(this.grid.isPostOpen?this.expandedState:this).isBorderTile}function J(e){this.grid.isPostOpen?this.expandedState.isBorderTile=e:this.isBorderTile=e}function I(e,t){for(var i,n=t?(i=m.verticalSines,m.verticalCosines):(i=m.horizontalSines,m.horizontalCosines),o=0,r=0,a=[];o<6;o+=1)a[r++]=e*n[o],a[r++]=e*i[o];return a}function i(e,t,i){var n,o;function r(e,t,i){e[t]=e[t]||{tile:i,restLength:window.hg.Grid.config.tileShortLengthWithGap,neighborsRelationshipObj:null,springForceX:0,springForceY:0}}n=e.getNeighborStates(),i?(r(n,t,i),r(o=i.getNeighborStates(),i=(t+3)%6,e),n[t].neighborsRelationshipObj=o[i],o[i].neighborsRelationshipObj=n[t]):n[t]=null}function O(){this.holdsContent&&n.call(this),this.svg.removeChild(this.element)}function M(){this.element.style.display="none",this.holdsContent&&(this.tilePost.elements.title.style.display="none")}function k(){this.element.style.display="block",this.holdsContent&&(this.tilePost.elements.title.style.display="block")}(m={dragCoeff:.01,neighborSpringCoeff:1e-5,neighborDampingCoeff:.001,innerAnchorSpringCoeff:4e-5,innerAnchorDampingCoeff:.001,borderAnchorSpringCoeff:4e-5,borderAnchorDampingCoeff:.001,forceSuppressionLowerThreshold:5e-4,velocitySuppressionLowerThreshold:5e-4,computeDependentValues:function(){m.forceSuppressionThresholdNegative=-m.forceSuppressionLowerThreshold,m.velocitySuppressionThresholdNegative=-m.velocitySuppressionLowerThreshold}}).computeDependentValues(),e.computeVertexDeltas=I,e.setTileNeighborState=i,e.initializeTileExpandedState=function(e,t,i,n){e.expandedState={sector:t,sectorMajorIndex:i,sectorMinorIndex:n,neighborStates:[],isBorderTile:!1}},e.config=m,window.hg=window.hg||{},window.hg.Tile=e,function(){var e,t,i,n,o;for(i=Math.PI/3,n=-i,o=Math.PI/6-2*i,m.horizontalSines=[],m.horizontalCosines=[],e=0,t=n;e<6;e+=1,t+=i)m.horizontalSines[e]=Math.sin(t),m.horizontalCosines[e]=Math.cos(t);for(m.verticalSines=[],m.verticalCosines=[],e=0,t=o;e<6;e+=1,t+=i)m.verticalSines[e]=Math.sin(t),m.verticalCosines[e]=Math.cos(t)}(),console.log("Tile module loaded")}(),function(){var h;function e(e){var t=this;t.tile=e,t.elements=null,t.draw=p,t.destroy=i,function(){var e,t,i,n,o=this,r="hg-pattern-"+o.tile.postData.id,a="hsl("+window.hg.TilePost.config.inactiveScreenHue+","+window.hg.TilePost.config.inactiveScreenSaturation+"%,"+window.hg.TilePost.config.inactiveScreenLightness+"%)",l=2*window.hg.Grid.config.tileOuterRadius,s=-h.fontSize*(1.5+.53*(o.tile.postData.titleShort.split("\n").length-1)),c=window.hg.Grid.config.tileOuterRadius/window.hg.Grid.config.tileInnerRadius,d=(1-c)/2;n=o.tile.grid.isVertical?(e=c,t=1,i=d,"0"):(e=1,t=c,i="0",d);var u=document.createElementNS(window.hg.util.svgNamespace,"pattern"),g=document.createElementNS(window.hg.util.svgNamespace,"image"),c=document.createElementNS(window.hg.util.svgNamespace,"rect"),d=document.createElement("h2");o.tile.grid.svgDefs.appendChild(u),u.appendChild(g),u.appendChild(c),o.tile.grid.parent.appendChild(d),o.elements=[],o.elements.backgroundPattern=u,o.elements.backgroundImage=g,o.elements.backgroundImageScreen=c,o.elements.title=d,u.setAttribute("id",r),u.setAttribute("patternContentUnits","objectBoundingBox"),u.setAttribute("width","1"),u.setAttribute("height","1"),g.setAttributeNS(window.hg.util.xlinkNamespace,"xlink:href",o.tile.postData.thumbnailSrc),g.setAttribute("preserveAspectRatio","none"),g.setAttribute("x",i),g.setAttribute("y",n),g.setAttribute("width",e),g.setAttribute("height",t),c.setAttribute("width","1"),c.setAttribute("height","1"),c.setAttribute("fill",a),o.tile.element.setAttribute("fill","url(#"+r+")"),d.innerHTML=o.tile.postData.titleShort,d.setAttribute("data-hg-tile-title","data-hg-tile-title"),d.style.position="absolute",d.style.left=-l/2+"px",d.style.top=s+"px",d.style.width=l+"px",d.style.height=l+"px",d.style.fontSize=h.fontSize+"px",d.style.textAlign="center",d.style.whiteSpace="pre-wrap",d.style.pointerEvents="none",d.style.zIndex="1200",o.tile.imageScreenOpacity=h.inactiveScreenOpacity,p.call(o)}.call(t)}function p(){var e=this,t=e.tile.isHighlighted?window.hg.TilePost.config.activeScreenOpacity:e.tile.imageScreenOpacity,i=1<(i=.5+2*(t-.5))?1:i<0?0:i;window.hg.util.setTransform(e.elements.title,"translate("+e.tile.particle.px+"px,"+e.tile.particle.py+"px)"),e.elements.backgroundImageScreen.setAttribute("opacity",t),e.tile.grid.expandedTile!==e.tile&&(e.elements.title.style.opacity=i)}function i(){this.tile.grid.parent.removeChild(this.elements.title),this.tile.grid.svgDefs.removeChild(this.elements.backgroundPattern)}(h={activeScreenOpacity:0,inactiveScreenOpacity:.8,inactiveScreenHue:230,inactiveScreenSaturation:1,inactiveScreenLightness:4}).fontSize=812<document.documentElement.clientWidth?18:14,h.computeDependentValues=function(){},h.computeDependentValues(),e.config=h,window.hg=window.hg||{},window.hg.TilePost=e,console.log("TilePost module loaded")}(),function(){var e={};function i(e){this.startTime=e,this.isComplete=!1}function n(e,t){for(var i=this,n=0,o=i.grid.allTiles.length;n<o;n+=1)i.grid.allTiles[n].currentColor.h=i.grid.allTiles[n].originalColor.h,i.grid.allTiles[n].currentColor.s=i.grid.allTiles[n].originalColor.s,i.grid.allTiles[n].currentColor.l=i.grid.allTiles[n].originalColor.l,i.grid.allTiles[n].imageScreenOpacity=window.hg.TilePost.config.inactiveScreenOpacity}function o(){}function r(){this.isComplete=!0}function a(){l.call(this)}function l(){}function t(e){var t=this;t.grid=e,t.startTime=0,t.isComplete=!0,t.start=i,t.update=n,t.draw=o,t.cancel=r,t.refresh=a,t.init=l,t.init(),console.log("ColorResetJob created")}e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.ColorResetJob=t,console.log("ColorResetJob module loaded")}(),function(){var o={};function r(e,t,i){e>i.timeEnd&&(l(e,n=i),n.hueDeltaStart=n.hueDeltaEnd,n.hueDeltaEnd=Math.random()*(o.hueDeltaMax-o.hueDeltaMin)+o.hueDeltaMin,n.saturationDeltaStart=n.saturationDeltaEnd,n.saturationDeltaEnd=Math.random()*(o.saturationDeltaMax-o.saturationDeltaMin)+o.saturationDeltaMin,n.lightnessDeltaStart=n.lightnessDeltaEnd,n.lightnessDeltaEnd=Math.random()*(o.lightnessDeltaMax-o.lightnessDeltaMin)+o.lightnessDeltaMin);var n=(e-i.timeStart)/(i.timeEnd-i.timeStart);t.currentColor.h+=n*(i.hueDeltaEnd-i.hueDeltaStart)+i.hueDeltaStart,t.currentColor.s+=n*(i.saturationDeltaEnd-i.saturationDeltaStart)+i.saturationDeltaStart,t.currentColor.l+=n*(i.lightnessDeltaEnd-i.lightnessDeltaStart)+i.lightnessDeltaStart,t.currentColor.h+=e/300,t.currentColor.h%=360}function a(e,t,i){var n;e>i.timeEnd&&(l(e,n=i),n.opacityDeltaStart=n.opacityDeltaEnd,n.opacityDeltaEnd=Math.random()*(o.imageBackgroundScreenOpacityDeltaMax-o.imageBackgroundScreenOpacityDeltaMin)+o.imageBackgroundScreenOpacityDeltaMin);e=(e-i.timeStart)/(i.timeEnd-i.timeStart);t.imageScreenOpacity+=e*(i.opacityDeltaEnd-i.opacityDeltaStart)+i.opacityDeltaStart}function l(e,t){for(var i=e-t.timeEnd,n=s();n<=i;)i-=n,n=s();t.timeStart=e-i,t.timeEnd=t.timeStart+n}function s(){return Math.random()*(o.transitionDurationMax-o.transitionDurationMin)+o.transitionDurationMin}function i(e){var t,i,n=this;for(n.startTime=e,n.isComplete=!1,t=0,i=n.shiftStatusesNonContentTiles.length;t<i;t+=1)n.shiftStatusesNonContentTiles[t].timeStart=e,n.shiftStatusesNonContentTiles[t].timeEnd=e;for(t=0,i=n.shiftStatusesContentTiles.length;t<i;t+=1)n.shiftStatusesContentTiles[t].timeStart=e,n.shiftStatusesContentTiles[t].timeEnd=e}function n(e,t){for(var i=this,n=0,o=i.grid.allNonContentTiles.length;n<o;n+=1)r(e,i.grid.allNonContentTiles[n],i.shiftStatusesNonContentTiles[n]);for(n=0,o=i.grid.contentTiles.length;n<o;n+=1)a(e,i.grid.contentTiles[n],i.shiftStatusesContentTiles[n])}function c(){}function d(){this.isComplete=!0}function u(){g.call(this)}function g(){o.computeDependentValues(),function(){var e,t,i=this;for(i.shiftStatusesNonContentTiles=[],i.shiftStatusesContentTiles=[],e=0,t=i.grid.allNonContentTiles.length;e<t;e+=1)i.shiftStatusesNonContentTiles[e]={timeStart:0,timeEnd:0,hueDeltaStart:0,hueDeltaEnd:0,saturationDeltaStart:0,saturationDeltaEnd:0,lightnessDeltaStart:0,lightnessDeltaEnd:0};for(e=0,t=i.grid.contentTiles.length;e<t;e+=1)i.shiftStatusesContentTiles[e]={timeStart:0,timeEnd:0,opacityDeltaStart:0,opacityDeltaEnd:0}}.call(this)}function e(e){var t=this;t.grid=e,t.shiftStatusesNonContentTiles=null,t.shiftStatusesContentTiles=null,t.startTime=0,t.isComplete=!0,t.start=i,t.update=n,t.draw=c,t.cancel=d,t.refresh=u,t.init=g,t.init(),console.log("ColorShiftJob created")}o.hueDeltaMin=-20,o.hueDeltaMax=20,o.saturationDeltaMin=0,o.saturationDeltaMax=0,o.lightnessDeltaMin=0,o.lightnessDeltaMax=0,o.imageBackgroundScreenOpacityDeltaMin=-.05,o.imageBackgroundScreenOpacityDeltaMax=.05,o.transitionDurationMin=200,o.transitionDurationMax=2e3,o.computeDependentValues=function(){},o.computeDependentValues(),e.config=o,window.hg=window.hg||{},window.hg.ColorShiftJob=e,console.log("ColorShiftJob module loaded")}(),function(){var d={};function i(e){this.startTime=e,this.isComplete=!1}function n(e,t){for(var i,n,o,r,a=this,l=(e+d.halfPeriod)/d.period%2-1,s=0,c=a.grid.allNonContentTiles.length;s<c;s+=1)i=a.grid.allNonContentTiles[s],n=a.waveProgressOffsetsNonContentTiles[s],n=Math.sin((((l+1+n)%2+2)%2-1)*Math.PI),i.currentColor.h+=d.deltaHue*n*d.opacity,i.currentColor.s+=d.deltaSaturation*n*d.opacity,i.currentColor.l+=d.deltaLightness*n*d.opacity;for(s=0,c=a.grid.contentTiles.length;s<c;s+=1)o=a.grid.contentTiles[s],r=a.waveProgressOffsetsContentTiles[s],r=.5*Math.sin((((l+1+r)%2+2)%2-1)*Math.PI)+.5,o.imageScreenOpacity+=-r*d.opacity*d.deltaOpacityImageBackgroundScreen}function o(){}function r(){this.isComplete=!0}function a(){l.call(this)}function l(){d.computeDependentValues(),function(){var e,t,i,n,o,r,a=this,l=d.wavelength/2;for(a.waveProgressOffsetsNonContentTiles=[],a.waveProgressOffsetsContentTiles=[],e=0,t=a.grid.allNonContentTiles.length;e<t;e+=1)o=(i=a.grid.allNonContentTiles[e]).originalAnchor.x-d.originX,r=i.originalAnchor.y-d.originY,n=Math.sqrt(o*o+r*r)+d.wavelength,a.waveProgressOffsetsNonContentTiles[e]=-(n%d.wavelength-l)/l;for(e=0,t=a.grid.contentTiles.length;e<t;e+=1)o=(i=a.grid.contentTiles[e]).originalAnchor.x-d.originX,r=i.originalAnchor.y-d.originY,n=Math.sqrt(o*o+r*r)+d.wavelength,a.waveProgressOffsetsContentTiles[e]=-(n%d.wavelength-l)/l}.call(this)}function e(e){var t=this;t.grid=e,t.waveProgressOffsetsNonContentTiles=null,t.waveProgressOffsetsContentTiles=null,t.startTime=0,t.isComplete=!0,t.start=i,t.update=n,t.draw=o,t.cancel=r,t.refresh=a,t.init=l,t.init(),console.log("ColorWaveJob created")}d.period=1e3,d.wavelength=600,d.originX=-100,d.originY=1400,d.deltaHue=0,d.deltaSaturation=0,d.deltaLightness=5,d.deltaOpacityImageBackgroundScreen=.18,d.opacity=.5,d.computeDependentValues=function(){d.halfPeriod=d.period/2},d.computeDependentValues(),e.config=d,window.hg=window.hg||{},window.hg.ColorWaveJob=e,console.log("ColorWaveJob module loaded")}(),function(){var e={};function i(e){this.startTime=e,this.isComplete=!1}function n(e,t){for(var i=this,n=0,o=i.grid.allTiles.length;n<o;n+=1)i.grid.allTiles[n].currentAnchor.x=i.grid.allTiles[n].originalAnchor.x,i.grid.allTiles[n].currentAnchor.y=i.grid.allTiles[n].originalAnchor.y;i.grid.isPostOpen&&(i.grid.pagePost.carousel.currentIndexPositionRatio=i.grid.pagePost.carousel.currentIndex)}function o(){}function r(){this.isComplete=!0}function a(){l.call(this)}function l(){}function t(e){var t=this;t.grid=e,t.startTime=0,t.isComplete=!0,t.start=i,t.update=n,t.draw=o,t.cancel=r,t.refresh=a,t.init=l,t.init(),console.log("DisplacementResetJob created")}e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.DisplacementResetJob=t,console.log("DisplacementResetJob module loaded")}(),function(){var l={};function i(e){this.startTime=e,this.isComplete=!1}function n(e,t){for(var i,n,o=(e+l.halfPeriod)/l.period%2-1,r=0,a=this.grid.allTiles.length;r<a;r+=1)i=this.grid.allTiles[r],n=this.waveProgressOffsets[r],n=Math.sin((((o+1+n)%2+2)%2-1)*Math.PI),i.currentAnchor.x+=l.tileDeltaX*n,i.currentAnchor.y+=l.tileDeltaY*n}function o(){}function r(){this.isComplete=!0}function a(){s.call(this)}function s(){l.computeDependentValues(),function(){var e,t,i,n,o=l.wavelength/2;for(this.waveProgressOffsets=[],e=0,t=this.grid.allTiles.length;e<t;e+=1)i=(n=this.grid.allTiles[e]).originalAnchor.x-l.originX,n=n.originalAnchor.y-l.originY,n=Math.sqrt(i*i+n*n)+l.wavelength,this.waveProgressOffsets[e]=-(n%l.wavelength-o)/o}.call(this)}function e(e){var t=this;t.grid=e,t.waveProgressOffsets=null,t.startTime=0,t.isComplete=!0,t.start=i,t.update=n,t.draw=o,t.cancel=r,t.refresh=a,t.init=s,t.init(),console.log("DisplacementWaveJob created")}l.period=3200,l.wavelength=1800,l.originX=0,l.originY=0,l.tileDeltaX=-15,l.tileDeltaY=-l.tileDeltaX*Math.sqrt(3),l.computeDependentValues=function(){l.halfPeriod=l.period/2,l.displacementAmplitude=Math.sqrt(l.tileDeltaX*l.tileDeltaX+l.tileDeltaY*l.tileDeltaY)},l.computeDependentValues(),e.config=l,window.hg=window.hg||{},window.hg.DisplacementWaveJob=e,console.log("DisplacementWaveJob module loaded")}(),function(){var r={};function n(e){console.log("CarouselImageSlideJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete(),this.carousel.onSlideFinished()}function a(e){var t=this;t.startTime=e,t.isComplete=!1,t.indexInitialDisplacement=t.carousel.previousIndex-t.carousel.currentIndex}function l(e,t){var i=this,e=(e-i.startTime)/i.duration;e=1-window.hg.util.easingFunctions.easeInOutCubic(e),i.carousel.currentIndexPositionRatio+=i.indexInitialDisplacement*(e=e<0?0:e),0===e&&n.call(i,!1)}function s(){}function c(){n.call(this,!0)}function d(){r.computeDependentValues()}function e(e,t,i,n){var o=this;o.grid=e,o.baseTile=e.expandedTile,o.startTime=0,o.isComplete=!0,o.carousel=n,o.indexInitialDisplacement=Number.NaN,o.duration=r.duration,o.start=a,o.update=l,o.draw=s,o.cancel=c,o.onComplete=i,o.init=d,console.log("CarouselImageSlideJob created: currentIndex="+o.carousel.currentIndex+", previousIndex="+o.carousel.previousIndex)}r.duration=300,r.computeDependentValues=function(){},r.computeDependentValues(),e.config=r,window.hg=window.hg||{},window.hg.CarouselImageSlideJob=e,console.log("CarouselImageSlideJob module loaded")}(),function(){var i={};function n(e){var t=this;console.log("ClosePostJob "+(e?"cancelled":"completed")),function(){var e,t,i,n;for(n=(e=this).grid.lastExpansionJob===e,t=0,i=e.sectors.length;t<i;t+=1)e.sectors[t].destroy(n);e.sectors=[]}.call(t),t.grid.lastExpansionJob===t&&(t.baseTile.expandedState=null,t.grid.sectors=[],t.grid.updateAllTilesCollection(t.grid.originalTiles),t.grid.isTransitioning=!1,t.grid.expandedTile=null,window.hg.controller.resetPersistentJobs(t.grid)),t.isComplete=!0,t.onComplete()}function r(e){var t=this;t.startTime=e,t.isComplete=!1,t.grid.isPostOpen=!1,t.grid.isTransitioning=!0,e={x:(t.grid.lastExpansionJob=t).grid.originalCenter.x-t.grid.panCenter.x,y:t.grid.originalCenter.y-t.grid.panCenter.y},window.hg.controller.transientJobs.SpreadJob.create(t.grid,t.baseTile).duration=i.duration+window.hg.OpenPostJob.config.spreadDurationOffset,window.hg.controller.transientJobs.PanJob.create(t.grid,t.baseTile,{x:t.grid.panCenter.x,y:t.grid.panCenter.y}).duration=i.duration+window.hg.OpenPostJob.config.panDurationOffset,window.hg.controller.transientJobs.DilateSectorsJob.create(t.grid,t.baseTile,e).duration=i.duration+window.hg.OpenPostJob.config.dilateSectorsDurationOffset,window.hg.controller.transientJobs.FadePostJob.create(t.grid,t.baseTile).duration=i.duration+window.hg.OpenPostJob.config.fadePostDurationOffset,t.grid.annotations.setExpandedAnnotations(!1),t.grid.parent.style.overflowY="auto"}function a(e,t){e-this.startTime>=i.duration&&n.call(this,!1)}function l(){}function s(){n.call(this,!0)}function c(){i.computeDependentValues()}function e(e,t,i,n){var o=this;o.grid=e,o.baseTile=e.expandedTile,o.startTime=0,o.isComplete=!0,o.sectors=e.sectors,o.start=r,o.update=a,o.draw=l,o.cancel=s,o.onComplete=i,o.init=c,n||history.pushState({},document.title,"/"),console.log("ClosePostJob created: tileIndex="+o.baseTile.originalIndex)}i.duration=500,i.computeDependentValues=function(){},i.computeDependentValues(),e.config=i,window.hg=window.hg||{},window.hg.ClosePostJob=e,console.log("ClosePostJob module loaded")}(),function(){var r={};function l(e){console.log("DilateSectorsJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}function a(e){this.startTime=e,this.isComplete=!1,function(){for(var e=this,t=0;t<6;t+=1)e.sectors[t].originalAnchor.x+=e.panDisplacement.x,e.sectors[t].originalAnchor.y+=e.panDisplacement.y,e.sectors[t].setOriginalPositionForExpansion(e.isExpanding)}.call(this)}function s(e,t){var i,n,o,r=this,a=(e-r.startTime)/r.duration;for(a=(a=1-window.hg.util.easingFunctions.easeOutQuint(a))<0?0:r.isExpanding?a:-a,i=0;i<6;i+=1)n=r.sectors[i].expandedDisplacement.x*a,o=r.sectors[i].expandedDisplacement.y*a,r.sectors[i].updateCurrentPosition(n,o);0===a&&l.call(r,!1)}function c(){}function d(){l.call(this,!0)}function u(){r.computeDependentValues()}function e(e,t,i,n){var o=this;o.grid=e,o.baseTile=e.expandedTile,o.startTime=0,o.isComplete=!0,o.panDisplacement=n,o.sectors=e.sectors,o.parentExpansionJob=o.grid.lastExpansionJob,o.isExpanding=e.isPostOpen,o.duration=r.duration,o.start=a,o.update=s,o.draw=c,o.cancel=d,o.onComplete=i,o.init=u,console.log("DilateSectorsJob created: tileIndex="+o.baseTile.originalIndex)}r.duration=500,r.computeDependentValues=function(){},r.computeDependentValues(),e.config=r,window.hg=window.hg||{},window.hg.DilateSectorsJob=e,console.log("DilateSectorsJob module loaded")}(),function(){var e={};function o(e){this.startTime=e,this.isComplete=!1}function r(e,t){}function a(){}function l(){!function(e){console.log("DisplacementRadiateJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}.call(this,!0)}function s(){e.computeDependentValues()}function t(e,t,i){var n=this;n.grid=e,n.tile=t,n.startTime=0,n.isComplete=!0,n.displacements=null,n.start=o,n.update=r,n.draw=a,n.cancel=l,n.onComplete=i,n.init=s,function(){}.call(n),console.log("DisplacementRadiateJob created: tileIndex="+n.tile.originalIndex)}e.duration=500,e.waveSpeed=3,e.waveWidth=500,e.displacementDistance=50,e.isRecurring=!1,e.avgDelay=4e3,e.delayDeviationRange=3800,e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.DisplacementRadiateJob=t,console.log("DisplacementRadiateJob module loaded")}(),function(){var a={};function l(e){var t=this;console.log("FadePostJob "+(e?"cancelled":"completed")),t.isComplete=!0,t.onComplete(),t.isFadingIn?t.parentExpansionJob===t.grid.lastExpansionJob&&t.baseTile.hide():(t.parentExpansionJob===t.grid.lastExpansionJob?t.grid.destroyPagePost():(t.pagePost.destroy(),t.baseTile.currentVertexDeltas=t.baseTile.originalVertexDeltas.slice(0)),t.baseTile.show()),t.baseTile.element.style.pointerEvents="auto"}function s(e,t,i,n){for(var o=0,r=e.length;o<r;o+=1)e[o]=t[o]+(i[o]-t[o])*n}function o(e){var t=this;t.startTime=e,t.isComplete=!1,t.pagePostStartPosition={},t.pagePostDisplacement={},t.baseTile.show(),t.isFadingIn?(t.pagePostStartPosition.x=t.baseTile.particle.px,t.pagePostStartPosition.y=t.baseTile.particle.py,t.pagePostDisplacement.x=t.grid.originalCenter.x-t.pagePostStartPosition.x,t.pagePostDisplacement.y=t.grid.originalCenter.y-t.pagePostStartPosition.y+t.grid.scrollTop,t.pagePost=t.grid.createPagePost(t.baseTile,t.pagePostStartPosition),e=window.hg.OpenPostJob.config.expandedDisplacementTileCount*window.hg.Grid.config.tileShortLengthWithGap,t.baseTile.expandedVertexDeltas=window.hg.Tile.computeVertexDeltas(e,t.grid.isVertical)):(t.pagePostStartPosition.x=t.grid.originalCenter.x,t.pagePostStartPosition.y=t.grid.originalCenter.y+t.grid.scrollTop,t.pagePostDisplacement.x=t.pagePostStartPosition.x-t.grid.currentCenter.x,t.pagePostDisplacement.y=t.pagePostStartPosition.y-t.grid.currentCenter.y-t.grid.scrollTop),t.baseTile.element.style.pointerEvents="none"}function r(e,t){var i=this,n=(e-i.startTime)/i.duration,o=n,r=(n=1<(n=window.hg.util.easingFunctions.easeOutCubic(n))?1:n)/a.quick1FadeDurationRatio,e=1<(e=n/a.quick2FadeDurationRatio)?1:e;i.baseTile.element.style.opacity=1-(r=1<r?1:r),i.baseTile.tilePost.elements.title.style.opacity=1-e,i.pagePost.opacity=o,i.pagePost.center.x=i.pagePostStartPosition.x+i.pagePostDisplacement.x*n,i.pagePost.center.y=i.pagePostStartPosition.y+i.pagePostDisplacement.y*n,s(i.baseTile.currentVertexDeltas,i.baseTile.originalVertexDeltas,i.baseTile.expandedVertexDeltas,r),1===n&&l.call(i,!1)}function c(e,t){var i=this,n=(e-i.startTime)/i.duration,e=1<(e=(n=1<(n=window.hg.util.easingFunctions.easeOutQuint(n))?1:n)/a.quick1FadeDurationRatio)?1:e;i.baseTile.element.style.opacity=n,i.baseTile.tilePost.elements.title.style.opacity=n,i.pagePost.opacity=1-e,i.pagePost.center.x=i.pagePostStartPosition.x+i.pagePostDisplacement.x*n,i.pagePost.center.y=i.pagePostStartPosition.y+i.pagePostDisplacement.y*n,s(i.baseTile.currentVertexDeltas,i.baseTile.expandedVertexDeltas,i.baseTile.originalVertexDeltas,e),1===n&&l.call(i,!1)}function d(){this.pagePost.draw()}function u(){l.call(this,!0)}function g(){a.computeDependentValues()}function e(e,t,i){var n=this;n.grid=e,n.baseTile=e.expandedTile,n.startTime=0,n.isComplete=!0,n.pagePost=e.pagePost,n.parentExpansionJob=n.grid.lastExpansionJob,n.isFadingIn=e.isPostOpen,n.pagePostStartPosition=null,n.pagePostDisplacement=null,n.duration=a.duration,n.start=o,n.update=n.isFadingIn?r:c,n.draw=d,n.cancel=u,n.onComplete=i,n.init=g,console.log("FadePostJob created: tileIndex="+n.baseTile.originalIndex+", isFadingIn="+n.isFadingIn)}a.duration=500,a.quick1FadeDurationRatio=.7,a.quick2FadeDurationRatio=.3,a.computeDependentValues=function(){},a.computeDependentValues(),e.config=a,window.hg=window.hg||{},window.hg.FadePostJob=e,console.log("FadePostJob module loaded")}(),function(){var n={};function o(e){this.isComplete=!0,this.onComplete()}function r(e,t){t=window.hg.TilePost.config.activeScreenOpacity+t*(window.hg.TilePost.config.inactiveScreenOpacity-window.hg.TilePost.config.activeScreenOpacity);e.imageScreenOpacity=t}function a(e,t){t=n.opacity*(1-t);e.currentColor.h+=n.deltaHue*t,e.currentColor.s+=n.deltaSaturation*t,e.currentColor.l+=n.deltaLightness*t}function l(e){this.startTime=e,this.isComplete=!1}function s(e,t){var i=this;i.tile.isHighlighted?i.cancel():e>i.startTime+n.duration?(i.updateTile(i.tile,1),o.call(i,!1)):(e=(e-i.startTime)/n.duration,i.updateTile(i.tile,e))}function c(){}function d(){o.call(this,!0)}function u(){}function e(e,t,i){var n=this;n.grid=e,n.tile=t,n.startTime=0,n.isComplete=!0,n.updateTile=t.holdsContent?r:a,n.start=l,n.update=s,n.draw=c,n.cancel=d,n.onComplete=i,n.init=u}n.duration=200,n.deltaHue=0,n.deltaSaturation=0,n.deltaLightness=50,n.opacity=.5,n.isRecurring=!1,n.avgDelay=30,n.delayDeviationRange=20,n.computeDependentValues=function(){},n.computeDependentValues(),e.config=n,window.hg=window.hg||{},window.hg.HighlightHoverJob=e,console.log("HighlightHoverJob module loaded")}(),function(){var m={};function b(e){console.log("HighlightRadiateJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}function o(e){this.startTime=e,this.isComplete=!1}function r(e,t){var i,n,o,r,a,l,s,c,d,u,g,h,p=this;if(e>p.startTime+m.duration)b.call(p,!1);else{for(s=1-(e-p.startTime)/m.duration,n=(i=m.shimmerSpeed*(e-p.startTime))-m.shimmerWaveWidth,c=!1,o=0,r=p.grid.allNonContentTiles.length;o<r;o+=1)n<(a=p.distancesNonContentTiles[o])&&a<i&&(l=(a-n)/m.shimmerWaveWidth,g=p.grid.allNonContentTiles[o],h=s,h=l*m.opacity*h,g.currentColor.h+=m.deltaHue*h,g.currentColor.s+=m.deltaSaturation*h,g.currentColor.l+=m.deltaLightness*h,c=!0);for(o=0,r=p.grid.contentTiles.length;o<r;o+=1)n<(a=p.distancesContentTiles[o])&&a<i&&(l=(a-n)/m.shimmerWaveWidth,d=p.grid.contentTiles[o],u=l,d.imageScreenOpacity+=-u*m.opacity*s*(window.hg.TilePost.config.inactiveScreenOpacity-window.hg.TilePost.config.activeScreenOpacity),c=!0);c||b.call(p,!1)}}function a(){}function l(){b.call(this,!0)}function s(){}function e(e,t,i){var n=this;n.grid=e,n.startPoint={x:t.originalAnchor.x,y:t.originalAnchor.y},n.distancesNonContentTiles=[],n.distancesContentTiles=[],n.startTime=0,n.isComplete=!0,n.onComplete=i||function(){},n.start=o,n.update=r,n.draw=a,n.cancel=l,n.init=s,function(){for(var e,t,i=this,n=-window.hg.Grid.config.tileShortLengthWithGap,o=0,r=i.grid.allNonContentTiles.length;o<r;o+=1)e=i.grid.allNonContentTiles[o].originalAnchor.x-i.startPoint.x,t=i.grid.allNonContentTiles[o].originalAnchor.y-i.startPoint.y,i.distancesNonContentTiles[o]=Math.sqrt(e*e+t*t)+n;for(o=0,r=i.grid.contentTiles.length;o<r;o+=1)e=i.grid.contentTiles[o].originalAnchor.x-i.startPoint.x,t=i.grid.contentTiles[o].originalAnchor.y-i.startPoint.y,i.distancesContentTiles[o]=Math.sqrt(e*e+t*t)+n}.call(n),console.log("HighlightRadiateJob created: tileIndex="+(t&&t.originalIndex))}m.shimmerSpeed=3,m.shimmerWaveWidth=500,m.duration=500,m.deltaHue=0,m.deltaSaturation=0,m.deltaLightness=50,m.opacity=.5,m.isRecurring=!1,m.avgDelay=4e3,m.delayDeviationRange=3800,m.computeDependentValues=function(){},m.computeDependentValues(),e.config=m,window.hg=window.hg||{},window.hg.HighlightRadiateJob=e,console.log("HighlightRadiateJob module loaded")}(),function(){var e={};function o(e){this.startTime=e,this.isComplete=!1}function r(e,t){}function a(){}function l(){!function(e){console.log("IntraTileRadiateJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}.call(this,!0)}function s(){e.computeDependentValues()}function t(e,t,i){var n=this;n.grid=e,n.tile=t,n.startTime=0,n.isComplete=!0,n.start=o,n.update=r,n.draw=a,n.cancel=l,n.onComplete=i,n.init=s,console.log("IntraTileRadiateJob created: tileIndex="+n.tile.originalIndex)}e.duration=500,e.isRecurring=!1,e.avgDelay=4e3,e.delayDeviationRange=3800,e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.IntraTileRadiateJob=t,console.log("IntraTileRadiateJob module loaded")}(),function(){var d={};function n(){var e=this,t=e.ellapsedTime/e.duration,i=1-t;e.currentColor.h=i*e.startHue+t*e.endHue,e.currentColor.s=i*e.startSaturation+t*e.endSaturation,e.currentColor.l=i*e.startLightness+t*e.endLightness,e.currentOpacity=i*e.startOpacity+t*e.endOpacity}function r(){var e=this;console.log("LineJob completed"),e.polyline&&(e.grid.svg.removeChild(e.polyline),e.polyline=null),e.tiles=[],e.corners=[],e.direction=Number.NaN,e.currentCornerIndex=Number.NaN,e.hasReachedEdge=!0,e.isComplete=!0,e.onComplete(e)}function u(){var e,t=this,i=t.corners[t.currentCornerIndex],n=t.grid.isVertical?(e=(i+5)%6,i):((e=i)+1)%6;t.lowerNeighbors[t.currentCornerIndex]=t.tiles[t.currentCornerIndex].neighborStates[e],t.upperNeighbors[t.currentCornerIndex]=t.tiles[t.currentCornerIndex].neighborStates[n],t.lowerNeighborCorners[t.currentCornerIndex]=(i+2)%6,t.upperNeighborCorners[t.currentCornerIndex]=(i+4)%6}function a(){var e,t,i,n,o,r,a,l,s=this,c=s.corners[s.currentCornerIndex];if(0===s.currentCornerIndex)o=s.forcedInitialRelativeDirection,s.latestDirection=g(o,c);else{switch(e=(c-s.direction+6)%6){case 0:t=s.sameDirectionProb,i=d.distantSidewaysDirectionProb,d.distantSidewaysDirectionProb;break;case 1:t=d.closeSidewaysDirectionProb,i=d.closeSidewaysDirectionProb,d.oppositeDirectionProb;break;case 2:t=d.distantSidewaysDirectionProb,i=s.sameDirectionProb,d.distantSidewaysDirectionProb;break;case 3:t=d.oppositeDirectionProb,i=d.closeSidewaysDirectionProb,d.closeSidewaysDirectionProb;break;case 4:t=d.distantSidewaysDirectionProb,i=d.distantSidewaysDirectionProb,s.sameDirectionProb;break;case 5:t=d.closeSidewaysDirectionProb,i=d.oppositeDirectionProb,d.closeSidewaysDirectionProb;break;default:throw new Error("Invalid state: cornerConfig="+e)}for(;(r=g(o=(n=Math.random())<t?d.NEIGHBOR:n<t+i?d.LOWER_SELF:d.UPPER_SELF,c))===(s.latestDirection+3)%6;);s.latestDirection=r}switch(o){case d.NEIGHBOR:l=s.grid.isVertical?(a=(c+1)%6,s.tiles[s.currentCornerIndex].neighborStates[(c+5)%6].tile):(a=(c+1)%6,s.tiles[s.currentCornerIndex].neighborStates[c].tile);break;case d.LOWER_SELF:a=(c+5)%6,l=s.tiles[s.currentCornerIndex];break;case d.UPPER_SELF:a=(c+1)%6,l=s.tiles[s.currentCornerIndex];break;default:throw new Error("Invalid state: relativeDirection="+o)}s.currentCornerIndex=s.corners.length,s.corners[s.currentCornerIndex]=a,s.tiles[s.currentCornerIndex]=l,u.call(s),function(){var e=this;e.direction===(e.corners[e.currentCornerIndex]+3)%6?e.hasAlmostReachedEdge=!1:e.hasAlmostReachedEdge=!e.lowerNeighbors[e.currentCornerIndex]||!e.upperNeighbors[e.currentCornerIndex]}.call(s)}function g(e,t){switch(e){case d.NEIGHBOR:return t;case d.LOWER_SELF:return(t+4)%6;case d.UPPER_SELF:return(t+2)%6;default:throw new Error("Invalid state: relativeDirection="+e)}}function o(){for(var e,t,i=this,n=i.ellapsedTime/i.lineSidePeriod*window.hg.Grid.config.tileOuterRadius,o=parseInt(i.ellapsedTime/i.lineSidePeriod)+1;o>=i.corners.length&&!i.hasAlmostReachedEdge;)a.call(i);t=n%window.hg.Grid.config.tileOuterRadius,e=(i.lineLength-t+window.hg.Grid.config.tileOuterRadius)%window.hg.Grid.config.tileOuterRadius,i.frontSegmentEndRatio=t/window.hg.Grid.config.tileOuterRadius,i.backSegmentStartRatio=1-e/window.hg.Grid.config.tileOuterRadius,i.isShort=i.lineLength<window.hg.Grid.config.tileOuterRadius,i.isStarting=n<i.lineLength,i.hasAlmostReachedEdge&&o>=i.corners.length&&(i.hasReachedEdge=!0),i.segmentsIncludedCount=parseInt((i.lineLength-t-e-d.epsilon)/window.hg.Grid.config.tileOuterRadius)+2,i.isShort?i.isStarting||i.hasReachedEdge||0<=t-i.lineLength?i.segmentsIncludedCount=1:i.segmentsIncludedCount=2:(i.isStarting&&(i.segmentsIncludedCount=o),i.hasReachedEdge&&(t=o-i.corners.length+1,n-(i.corners.length-1)*window.hg.Grid.config.tileOuterRadius>i.lineLength&&r.call(i),i.segmentsIncludedCount-=t))}function l(){var e,t,i=this;for(i.gapPoints=[],e=0,t=i.corners.length;e<t;e+=1)i.gapPoints[e]=function(e,t,i,n,o,r){var a,l;t=i?n?(a=3,l=e.particle.px+i.tile.particle.px+n.tile.particle.px,e.particle.py+i.tile.particle.py+n.tile.particle.py):(a=2,l=e.vertices[2*t]+i.tile.vertices[2*o],e.vertices[2*t+1]+i.tile.vertices[2*o+1]):n?(a=2,l=e.vertices[2*t]+n.tile.vertices[2*r],e.vertices[2*t+1]+n.tile.vertices[2*r+1]):(a=1,l=e.vertices[2*t],e.vertices[2*t+1]);return{x:l/a,y:t/a}}(i.tiles[e],i.corners[e],i.lowerNeighbors[e],i.upperNeighbors[e],i.lowerNeighborCorners[e],i.upperNeighborCorners[e])}function s(){var e,t,i,n=this;for(n.polylinePoints=[],e=n.currentCornerIndex,i=n.extraStartPoint&&n.isStarting?(n.polylinePoints[0]=n.extraStartPoint,t=n.segmentsIncludedCount+1,1):(t=n.segmentsIncludedCount,0),n.hasReachedEdge?n.polylinePoints[t]={x:n.gapPoints[e].x,y:n.gapPoints[e].y}:n.polylinePoints[t]={x:n.gapPoints[e].x*n.frontSegmentEndRatio+n.gapPoints[e-1].x*(1-n.frontSegmentEndRatio),y:n.gapPoints[e].y*n.frontSegmentEndRatio+n.gapPoints[e-1].y*(1-n.frontSegmentEndRatio)},--t,--e;i<t;--t,--e)n.polylinePoints[t]=n.gapPoints[e];n.isStarting?n.polylinePoints[t]={x:n.gapPoints[e].x,y:n.gapPoints[e].y}:n.polylinePoints[t]={x:n.gapPoints[e+1].x*n.backSegmentStartRatio+n.gapPoints[e].x*(1-n.backSegmentStartRatio),y:n.gapPoints[e+1].y*n.backSegmentStartRatio+n.gapPoints[e].y*(1-n.backSegmentStartRatio)}}function c(e){this.startTime=e,this.isComplete=!1}function h(e,t){var i=this;i.ellapsedTime=e-i.startTime,i.ellapsedTime>=i.duration?r.call(i):(n.call(i),o.call(i),d.feGaussianBlur.setAttribute("stdDeviation",i.blurStdDeviation),i.isComplete||(l.call(i),s.call(i)))}function p(e,t){var i=this;i.ellapsedTime=e-i.startTime,i.ellapsedTime>=i.duration?r.call(i):(n.call(i),o.call(i),i.isComplete||(l.call(i),s.call(i)))}function m(){!function(){for(var e=this,t="",i=0,n=e.polylinePoints.length;i<n;i+=1)t+=e.polylinePoints[i].x+","+e.polylinePoints[i].y+" ";e.polyline.setAttribute("points",t),e.polyline.setAttribute("stroke","hsl("+e.currentColor.h+","+e.currentColor.s+"%,"+e.currentColor.l+"%)"),e.polyline.setAttribute("stroke-opacity",e.currentOpacity),e.polyline.setAttribute("stroke-width",e.lineWidth)}.call(this)}function b(){r.call(this)}function f(){d.computeDependentValues()}function w(e,t,i,n,o,r,a){var l=this;if(l.grid=e,l.tiles=[t],l.corners=[i],l.lowerNeighbors=[],l.upperNeighbors=[],l.lowerNeighborCorners=[],l.upperNeighborCorners=[],l.direction=n,l.forcedInitialRelativeDirection=o,l.extraStartPoint=a,l.currentCornerIndex=0,l.frontSegmentEndRatio=Number.NaN,l.backSegmentStartRatio=Number.NaN,l.latestDirection=n,l.polyline=null,l.gapPoints=[],l.polylinePoints=null,l.hasReachedEdge=!1,l.startTime=0,l.ellapsedTime=0,l.isComplete=!0,l.startHue=Number.NaN,l.endHue=Number.NaN,l.currentColor={h:Number.NaN,s:d.startSaturation,l:d.startLightness},l.currentOpacity=d.startOpacity,l.duration=d.duration,l.lineWidth=d.lineWidth,l.lineLength=d.lineLength,l.lineSidePeriod=d.lineSidePeriod,l.startSaturation=d.startSaturation,l.startLightness=d.startLightness,l.startOpacity=d.startOpacity,l.endSaturation=d.endSaturation,l.endLightness=d.endLightness,l.endOpacity=d.endOpacity,l.sameDirectionProb=d.sameDirectionProb,l.blurStdDeviation=d.blurStdDeviation,l.isBlurOn=d.isBlurOn,l.onComplete=r||function(){},l.start=c,l.update=l.isBlurOn?h:p,l.draw=m,l.cancel=b,l.init=f,d.haveDefinedLineBlur||(d.haveDefinedLineBlur=!0,function(){var e,t=document.createElementNS(window.hg.util.svgNamespace,"filter");this.grid.svgDefs.appendChild(t),e=document.createElementNS(window.hg.util.svgNamespace,"feGaussianBlur"),t.appendChild(e),t.setAttribute("id",d.filterId),t.setAttribute("x","-10%"),t.setAttribute("y","-10%"),t.setAttribute("width","120%"),t.setAttribute("height","120%"),e.setAttribute("in","SourceGraphic"),e.setAttribute("result","blurOut"),d.filter=t,d.feGaussianBlur=e}.call(l)),!function(e){var t,i,n,o,r;if(t=e.tiles[0],i=e.corners[0],n=e.direction,o=e.forcedInitialRelativeDirection,t.isCornerTile)return!1;if(t.isBorderTile)if(e.grid.isVertical)if(t.neighborStates[4])if(t.neighborStates[1])if(t.neighborStates[0])switch(r=0===n,i){case 0:case 1:return!0;case 2:return o===d.LOWER_SELF&&r;case 3:return!1;case 4:return o===d.UPPER_SELF&&r;case 5:return!0}else switch(r=3===n,i){case 0:return!1;case 1:return o===d.UPPER_SELF&&r;case 2:case 3:case 4:return!0;case 5:return o===d.LOWER_SELF&&r}else if(r=4===n||5===n,t.isInLargerRow)switch(i){case 0:return o===d.LOWER_SELF&&r;case 1:case 2:return!1;case 3:return o===d.UPPER_SELF&&r;case 4:case 5:return!0}else switch(i){case 0:return!0;case 1:return o===d.LOWER_SELF&&r;case 2:return o===d.UPPER_SELF&&r;case 3:case 4:case 5:return!0}else if(r=1===n||2===n,t.isInLargerRow)switch(i){case 0:return o===d.UPPER_SELF&&r;case 1:case 2:return!0;case 3:return o===d.LOWER_SELF&&r;case 4:case 5:return!1}else switch(i){case 0:case 1:case 2:case 3:return!0;case 4:return o===d.LOWER_SELF&&r;case 5:return o===d.UPPER_SELF&&r}else if(t.neighborStates[0])if(t.neighborStates[3])if(t.neighborStates[4])switch(r=4===n,i){case 0:return o===d.LOWER_SELF&&r;case 1:return!1;case 2:return o===d.UPPER_SELF&&r;case 3:case 4:case 5:return!0}else switch(r=1===n,i){case 0:case 1:case 2:return!0;case 3:return o===d.LOWER_SELF&&r;case 4:return!1;case 5:return o===d.UPPER_SELF&&r}else if(r=0===n||5===n,t.rowIndex===e.grid.rowCount-1)switch(i){case 0:return!0;case 1:return o===d.LOWER_SELF&&r;case 2:case 3:return!1;case 4:return o===d.UPPER_SELF&&r;case 5:return!0}else switch(i){case 0:case 1:return!0;case 2:return o===d.LOWER_SELF&&r;case 3:return o===d.UPPER_SELF&&r;case 4:case 5:return!0}else if(r=2===n||3===n,0===t.rowIndex)switch(i){case 0:return!1;case 1:return o===d.UPPER_SELF&&r;case 2:case 3:return!0;case 4:return o===d.LOWER_SELF&&r;case 5:return!1}else switch(i){case 0:return o===d.UPPER_SELF&&r;case 1:case 2:case 3:case 4:return!0;case 5:return o===d.LOWER_SELF&&r}return!0}(l))throw new Error("LineJob created with invalid initial corner configuration: tileIndex="+t.originalIndex+", corner="+i+", direction="+n);u.call(l),function(){this.startHue=360*Math.random(),this.endHue=360*Math.random()}.call(l),function(){var e=this;e.polyline=document.createElementNS(window.hg.util.svgNamespace,"polyline"),e.grid.svg.insertBefore(e.polyline,e.grid.svg.firstChild),e.polyline.setAttribute("fill-opacity","0"),d.isBlurOn&&e.polyline.setAttribute("filter","url(#"+d.filterId+")")}.call(l),console.log("LineJob created: tileIndex="+t.originalIndex+", corner="+i+", direction="+n)}d.duration=2e3,d.lineWidth=28,d.lineLength=6e4,d.lineSidePeriod=5,d.startSaturation=100,d.startLightness=100,d.startOpacity=.6,d.endSaturation=30,d.endLightness=80,d.endOpacity=0,d.sameDirectionProb=.8,d.blurStdDeviation=2,d.isBlurOn=!1,d.isRecurring=!0,d.avgDelay=2200,d.delayDeviationRange=2100,d.NEIGHBOR=0,d.LOWER_SELF=1,d.UPPER_SELF=2,d.oppositeDirectionProb=0,d.epsilon=1e-5,d.haveDefinedLineBlur=!1,d.filterId="random-line-filter",d.computeDependentValues=function(){d.distantSidewaysDirectionProb=(1-d.sameDirectionProb)/2,d.closeSidewaysDirectionProb=(1-d.oppositeDirectionProb)/2},d.computeDependentValues(),w.config=d,w.createRandomLineJob=function(e,t){for(var i,n,o,r;(i=e.originalBorderTiles[parseInt(Math.random()*e.originalBorderTiles.length)]).isCornerTile;);return o=e.isVertical?i.neighborStates[4]?i.neighborStates[1]?i.neighborStates[0]?(r=Math.random()<.5?(n=2,d.LOWER_SELF):(n=4,d.UPPER_SELF),0):(r=Math.random()<.5?(n=1,d.UPPER_SELF):(n=5,d.LOWER_SELF),3):(r=i.isInLargerRow?Math.random()<.5?(n=0,d.LOWER_SELF):(n=3,d.UPPER_SELF):Math.random()<.5?(n=1,d.LOWER_SELF):(n=2,d.UPPER_SELF),i.originalAnchor.y<e.originalCenter.y?4:5):(r=i.isInLargerRow?Math.random()<.5?(n=0,d.UPPER_SELF):(n=3,d.LOWER_SELF):Math.random()<.5?(n=4,d.LOWER_SELF):(n=5,d.UPPER_SELF),i.originalAnchor.y<e.originalCenter.y?2:1):i.neighborStates[0]?i.neighborStates[3]?i.neighborStates[4]?(r=Math.random()<.5?(n=0,d.LOWER_SELF):(n=2,d.UPPER_SELF),4):(r=Math.random()<.5?(n=3,d.LOWER_SELF):(n=5,d.UPPER_SELF),1):(r=i.rowIndex===e.rowCount-1?Math.random()<.5?(n=1,d.LOWER_SELF):(n=4,d.UPPER_SELF):Math.random()<.5?(n=2,d.LOWER_SELF):(n=3,d.UPPER_SELF),i.originalAnchor.x<e.originalCenter.x?0:5):(r=0===i.rowIndex?Math.random()<.5?(n=1,d.UPPER_SELF):(n=4,d.LOWER_SELF):Math.random()<.5?(n=0,d.UPPER_SELF):(n=5,d.LOWER_SELF),i.originalAnchor.x<e.originalCenter.x?2:3),new w(e,i,n,o,r,t,null)},window.hg=window.hg||{},window.hg.LineJob=w,console.log("LineJob module loaded")}(),function(){var r={};function o(e){var t,i;for(this.startTime=e,this.isComplete=!1,t=0,i=this.lineJobs.length;t<i;t+=1)this.lineJobs[t].start(e)}function a(e,t){var i,n,o=this;for(o.extraStartPoint.x=o.tile.particle.px,o.extraStartPoint.y=o.tile.particle.py,i=0,n=o.lineJobs.length;i<n;i+=1)o.lineJobs[i].update(e,t),o.lineJobs[i].isComplete&&(o.lineJobs.splice(i,1),i--,n--);o.feGaussianBlur.setAttribute("stdDeviation",r.blurStdDeviation),function(){for(var e=0;e<this.lineJobs.length;e+=1){if(!this.lineJobs[e].isComplete)return;this.lineJobs.splice(e--,1)}console.log("LinesRadiateJob completed"),this.isComplete=!0}.call(o)}function l(){for(var e=0,t=this.lineJobs.length;e<t;e+=1)this.lineJobs[e].draw()}function s(){for(var e=0,t=this.lineJobs.length;e<t;e+=1)this.lineJobs[e].cancel();this.lineJobs=[],this.isComplete=!0}function c(){}function e(e,t,i){var n=this;n.grid=e,n.tile=t,n.extraStartPoint={x:t.particle.px,y:t.particle.py},n.startTime=0,n.isComplete=!0,n.lineJobs=null,n.onComplete=i||function(){},n.start=o,n.update=a,n.draw=l,n.cancel=s,n.init=c,r.haveDefinedLineBlur||function(){var e,t=document.createElementNS(window.hg.util.svgNamespace,"filter");this.grid.svgDefs.appendChild(t),e=document.createElementNS(window.hg.util.svgNamespace,"feGaussianBlur"),t.appendChild(e),t.setAttribute("id",r.filterId),t.setAttribute("x","-10%"),t.setAttribute("y","-10%"),t.setAttribute("width","120%"),t.setAttribute("height","120%"),e.setAttribute("in","SourceGraphic"),e.setAttribute("result","blurOut"),this.feGaussianBlur=e}.call(n),function(){var e,t,i=this;for(i.lineJobs=[],e=0;e<6;e+=1){try{t=new window.hg.LineJob(i.grid,i.tile,e,e,window.hg.LineJob.config.NEIGHBOR,i.onComplete,i.extraStartPoint)}catch(e){console.debug(e.message);continue}i.lineJobs.push(t),t.duration=r.duration,t.lineWidth=r.lineWidth,t.lineLength=r.lineLength,t.lineSidePeriod=r.lineSidePeriod,t.startSaturation=r.startSaturation,t.startLightness=r.startLightness,t.startOpacity=r.startOpacity,t.endSaturation=r.endSaturation,t.endLightness=r.endLightness,t.endOpacity=r.endOpacity,t.sameDirectionProb=r.sameDirectionProb,t.filterId=r.filterId,t.blurStdDeviation=r.blurStdDeviation,t.isBlurOn=r.isBlurOn,r.isBlurOn?t.polyline.setAttribute("filter","url(#"+r.filterId+")"):t.polyline.setAttribute("filter","none")}}.call(n),console.log("LinesRadiateJob created: tileIndex="+t.originalIndex)}r.duration=700,r.lineWidth=24,r.lineLength=1300,r.lineSidePeriod=30,r.startSaturation=100,r.startLightness=100,r.startOpacity=.8,r.endSaturation=100,r.endLightness=70,r.endOpacity=0,r.sameDirectionProb=.85,r.blurStdDeviation=2,r.isBlurOn=!1,r.isRecurring=!1,r.avgDelay=2e3,r.delayDeviationRange=1800,r.haveDefinedLineBlur=!1,r.filterId="random-line-filter",r.computeDependentValues=function(){},r.computeDependentValues(),e.config=r,window.hg=window.hg||{},window.hg.LinesRadiateJob=e,console.log("LinesRadiateJob module loaded")}(),function(){var l={};function i(e){var t=this;console.log("OpenPostJob "+(e?"cancelled":"completed")),t.grid.isTransitioning=!1,t.grid.lastExpansionJob===t&&t.grid.pagePost.loadCarouselMedia(),t.isComplete=!0,t.onComplete()}function o(e){var t=this;t.startTime=e,t.isComplete=!1,t.grid.isTransitioning&&t.previousJob.cancel(),t.grid.isPostOpen=!0,t.grid.isTransitioning=!0,t.grid.expandedTile=t.baseTile,(t.grid.lastExpansionJob=t).grid.parent.style.overflow="hidden",function(){for(var e,t,i,n,o,r=this,a=0;a<6;a+=1)r.sectors[a]=new window.hg.Sector(r.grid,r.baseTile,a,l.expandedDisplacementTileCount);for(a=0;a<6;a+=1)r.sectors[a].initializeExpandedStateExternalTileNeighbors(r.sectors);for(a=0;a<6;a+=1)r.sectors[a].tilesByIndex=null;for(window.hg.Tile.initializeTileExpandedState(r.baseTile,null,Number.NaN,Number.NaN),r.grid.sectors=r.sectors,o=[],a=i=0;a<6;a+=1)for(e=0,t=(n=r.sectors[a].tiles).length;e<t;e+=1,i+=1)o[i]=n[e];o[i]=r.baseTile,r.grid.updateAllTilesCollection(o)}.call(t),t.grid.annotations.setExpandedAnnotations(!0),window.hg.controller.transientJobs.SpreadJob.create(t.grid,t.baseTile).duration=l.duration+l.spreadDurationOffset,window.hg.controller.transientJobs.PanJob.create(t.grid,t.baseTile).duration=l.duration+l.panDurationOffset,e={x:t.grid.panCenter.x-t.grid.originalCenter.x,y:t.grid.panCenter.y-t.grid.originalCenter.y},window.hg.controller.transientJobs.DilateSectorsJob.create(t.grid,t.baseTile,e).duration=l.duration+l.dilateSectorsDurationOffset,window.hg.controller.transientJobs.FadePostJob.create(t.grid,t.baseTile).duration=l.duration+l.fadePostDurationOffset,window.hg.controller.resetPersistentJobs(t.grid)}function r(e,t){e-this.startTime>=l.duration&&i.call(this,!1)}function a(){}function s(){i.call(this,!0)}function c(){l.computeDependentValues()}function e(e,t,i){var n=this;n.grid=e,n.baseTile=t,n.startTime=0,n.isComplete=!0,n.sectors=[],n.previousJob=e.lastExpansionJob,n.start=o,n.update=r,n.draw=a,n.cancel=s,n.onComplete=i,n.init=c;i=n.baseTile.postData?"#"+n.baseTile.postData.id:"";history.pushState({},document.title,i),console.log("OpenPostJob created: tileIndex="+n.baseTile.originalIndex)}l.duration=500,l.expandedDisplacementTileCount=3,l.spreadDurationOffset=-200,l.panDurationOffset=-100,l.fadePostDurationOffset=1100,l.dilateSectorsDurationOffset=0,l.computeDependentValues=function(){},l.computeDependentValues(),e.config=l,window.hg=window.hg||{},window.hg.OpenPostJob=e,console.log("OpenPostJob module loaded")}(),function(){var r={};function l(e){console.log("PanJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}function a(e){var t=this;t.reverseDisplacement={x:t.endPoint.x-t.startPoint.x,y:t.endPoint.y-t.startPoint.y},t.displacement={x:-t.reverseDisplacement.x,y:-t.reverseDisplacement.y},t.startTime=e,t.isComplete=!1,function(){for(var e=this,t=0,i=e.grid.allTiles.length;t<i;t+=1)e.grid.allTiles[t].originalAnchor.x+=e.displacement.x,e.grid.allTiles[t].originalAnchor.y+=e.displacement.y;e.grid.panCenter.x+=e.displacement.x,e.grid.panCenter.y+=e.displacement.y}.call(t)}function s(e,t){var i,n,o,r,a=this,e=(e-a.startTime)/a.duration;for(e=1-window.hg.util.easingFunctions.easeOutQuint(e),o=a.reverseDisplacement.x*(e=e<0?0:e),r=a.reverseDisplacement.y*e,i=0,n=a.grid.allTiles.length;i<n;i+=1)a.grid.allTiles[i].currentAnchor.x+=o,a.grid.allTiles[i].currentAnchor.y+=r;a.grid.currentCenter.x=a.grid.panCenter.x+o,a.grid.currentCenter.y=a.grid.panCenter.y+r,0===e&&l.call(a,!1)}function c(){}function d(){l.call(this,!0)}function u(){}function e(e,t,i,n){var o=this;o.grid=e,o.baseTile=t,o.reverseDisplacement=null,o.displacement=null,o.startTime=0,o.isComplete=!0,e.scrollTop=e.parent.scrollTop,o.endPoint=n||{x:t.originalAnchor.x,y:t.originalAnchor.y-e.scrollTop},o.startPoint={x:e.originalCenter.x,y:e.originalCenter.y},o.duration=r.duration,o.start=a,o.update=s,o.draw=c,o.cancel=d,o.onComplete=i,o.init=u,console.log("PanJob created: tileIndex="+o.baseTile.originalIndex)}r.duration=400,r.displacementRatio=.28,r.isRecurring=!1,r.avgDelay=300,r.delayDeviationRange=0,r.computeDependentValues=function(){},r.computeDependentValues(),e.config=r,window.hg=window.hg||{},window.hg.PanJob=e,console.log("PanJob module loaded")}(),function(){var o={};function a(e){console.log("SpreadJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}function r(e){this.startTime=e,this.isComplete=!1}function l(e,t){var i,n,o,r=this;if(e>r.startTime+r.duration)a.call(r,!1);else for(i=2*(.5<(i=(e-r.startTime)/r.duration)?1-i:i),i=window.hg.util.easingFunctions.easeOutQuint(i),n=0,o=r.displacements.length;n<o;n+=1)r.displacements[n].tile.currentAnchor.x+=r.displacements[n].dx*i,r.displacements[n].tile.currentAnchor.y+=r.displacements[n].dy*i}function s(){}function c(){a.call(this,!0)}function d(){}function e(e,t,i){var n=this;n.grid=e,n.baseTile=t,n.startTime=0,n.isComplete=!0,n.displacements=null,n.duration=o.duration,n.start=r,n.update=l,n.draw=s,n.cancel=c,n.onComplete=i,n.init=d,function(){var e,t,i=this;for(i.displacements=[],e=0,t=i.grid.allTiles.length;e<t;e+=1)i.displacements[e]={tile:i.grid.allTiles[e],dx:o.displacementRatio*(i.grid.allTiles[e].originalAnchor.x-i.baseTile.originalAnchor.x),dy:o.displacementRatio*(i.grid.allTiles[e].originalAnchor.y-i.baseTile.originalAnchor.y)}}.call(n),console.log("SpreadJob created: tileIndex="+n.baseTile.originalIndex)}o.duration=300,o.displacementRatio=.2,o.isRecurring=!1,o.avgDelay=4e3,o.delayDeviationRange=3800,o.computeDependentValues=function(){},o.computeDependentValues(),e.config=o,window.hg=window.hg||{},window.hg.SpreadJob=e,console.log("SpreadJob module loaded")}(),function(){var e={};function o(e){this.startTime=e,this.isComplete=!1}function r(e,t){}function a(){}function l(){!function(e){console.log("TileBorderJob "+(e?"cancelled":"completed")),this.isComplete=!0,this.onComplete()}.call(this,!0)}function s(){e.computeDependentValues()}function t(e,t,i){var n=this;n.grid=e,n.tile=t,n.startTime=0,n.isComplete=!0,n.start=o,n.update=r,n.draw=a,n.cancel=l,n.onComplete=i,n.init=s,console.log("TileBorderJob created: tileIndex="+n.baseTile.originalIndex)}e.duration=500,e.isRecurring=!1,e.avgDelay=4e3,e.delayDeviationRange=3800,e.computeDependentValues=function(){},e.computeDependentValues(),t.config=e,window.hg=window.hg||{},window.hg.TileBorderJob=t,console.log("TileBorderJob module loaded")}();